 
 
 
分类号
     V211                                 
学校代码
       10699     
密
   
级
     
非
  
密
                                
学
     
号
    2010100212   
  
 
(
学
  
位
  
研
  
究
  
生
)
 
 
：
作者
       
邱亚松
       
 
 
指导教师
          
白俊强
        
专业技术职务
      
教授
      
 
学科
(
专业
)
                
飞行器设计
                                    
答辩日期
                   
学位授予日期
                       
 
 
西北工业大学航空学院
 
2014 
年 
10 
月
 
   
 
By 
Qiu Yasong 
 
Under the Supervision of Professor 
Bai Junqiang
 
 
Dissertation Submitted to the Faculty of 
Northwestern Polytechnical University in Partial 
Fulfillment of the Requirement for the Degree of 
DOCTOR OF PHILOSOPHY 
in 
College of Aeronautics  
 
 
Northwestern Polytechnical University 
October 2014 
Xi
’
an , 710072, P. R. Chinan  摘
   
要
 
 
I 
 
摘
   
要
 
设计能力、设计效率、鲁棒性及对经验的依赖性是决定气动外形设计方法是
否实用的四个主要因素。传统的反设计方法经验依赖性强，鲁棒性与设计能力也
较差，但设计效率很高。优化设计方法鲁棒性好、经验依赖性低，但也存在一些
影响实用性的问题：基于现代启发式算法的优化设计方法在设计效率方面不尽如
人意，而基于梯度信息的优化设计方法则不具备全局寻优能力。从数据分析的角
度来说，气动外形设计中涉及到的数据基本都是多维的。如设计变量是多维的，
CFD 
求解出的离散流场也是多维的。数据的维度越高，气动设计问题往往也越
复杂。数据降维方法能在保留数据集主要特征的基础上有效降低数据的维度，使
相关气动设计问题得到简化。
 
针对气动设计方法中存在的主要问题，结合数据降维的思想与具体方法，本
文开展了以下几个方面的工作：
 
1
、构建了三套用途不同的气动外形优化设计系统。基于改进的微分进化算
法与气动力快速评估程序构建了气动力直接求解的全局型优化系统，此系统适用
于面向全局最优的初步设计；基于改进的微分进化算法与 
Kriging 
代理模型构建
了气动力预测的全局型优化系统，此系统适用于设计变量较少时面向全局最优的
高精度设计；基于改进的最速下降法、离散伴随求解器及 
RANS 
方程求解器构
建了基于梯度信息的优化系统，此系统适用于设计变量较多时面向局部最优的高
精度设计；
 
2
、对典型数据降维方法进行了研究与发展。在线性方法方面，研究了 
POD
、
SVD 
两种典型方法的性质，从理论证明了两种方法的等价性，阐述了两者在
实际使用中的差异；在非线性方法方面，研究了 
ISOMAP 
算法及其改型
L-ISOMAP 
算法的性质，基于最小子集覆盖与 
SVD 
开发了一种新型邻域参数与
流形本征维度估算方法，此估算方法在保证估算精度的同时最大限度地减少了计
算量；
 
3
、改进了 
Gappy POD 
气动外形反设计方法。提出了最优快照替换采样法代
替原始方法中的随机采样法，以增强样本拟合设计目标的能力；根据原始方法每
个迭代步产生的误差，开发了一种实时修正目标压力分布的方法，以提高每个迭
代步的设计精度。在计算效率相当的情况下，改进后的反设计方法设计精度明显
高于原始方法；
 
4
、提出了将反设计方法与优化设计方法组合使用的气动外形设计策略，实
现了反设计方法与优化设计方法的优势互补。组合设计策略的基本思路为：先用
改进的 
Gappy  POD 
反设计方法对初始构型进行粗略设计，然后再用优化方法进西北工业大学博士学位论文
 
II 
 
行精细设计。算例表明，这种设计策略具有设计能力强、效率高、鲁棒性好且经
验依赖性低的特点；
 
5
、提出了基于预测初始流场的流场求解加速方法，以缓解优化过程中流场
求解过于费时的问题。具体提出了两种初始流场预测方法：基于几何相似准则的
预测方法及基于代理模型与 
POD 
的预测方法。两种方法均能有效减少流场求解
所需的时间，且第二种方法的效果更好。根据各自的特点，进一步提出了一种在
优化设计中将两种方法搭配使用的策略，以最大限度地减少优化设计过程中流场
求解所需的时间；
 
6
、提出了先对设计空间进行过滤，然后重新构建一个无约束设计空间的思
想。将流形学习算法与流形结构重构技术相结合，建立了一种处理气动外形设计
中几何约束条件的新方法。测试表明：此方法对基于气动力直接求解的全局型优
化系统及基于梯度信息的优化系统是适用的，能明显提升系统的计算效率，增强
系统处理几何约束的能力。但这种新方法不适用于使用了代理模型的优化设计系
统；
 
7
、采用基于代理模型的全局型优化系统对 
L1T2 
多段翼型进行了优化。优
化过程中使用了基于初始流场预测的流场求解加速技术，节省了约 
75%
的流场求
解时间。较之初始构型，优化构型的升力系数提升了 
8.63%
；
 
8
、分别采用基于气动力直接求解的全局型优化系统与改进的 
Gappy POD 
反
设计方法对某远程宽体客机的机翼进行了减小巡航阻力的粗略设计。结果表明，
反设计结果比优化设计结果更具进一步精细设计的潜力。据此，采用基于梯度信
息的优化系统对反设计结果进行了精细优化，优化过程中使用了设计空间过滤与
重构技术。最终优化构型的阻力较之初始构型减小了 
6.2%
，且很好地满足了各
项几何约束条件。
 
 
关键词：气动外形设计；数据降维方法；优化设计方法；
Gappy  POD 
反设计方
法；流场求解加速方法；设计空间过滤与重构
 
 Abstract
 
 
III 
Abstract 
Regards  to  aerodynamic  shape  design,  design  ability,  efficiency,  robustness  and 
dependence  on  experience  are  four  main  determinant  factors.  Traditional  inverse 
design  method  has  shortage  of  strong  experience  dependence,  poor  robustness  and 
design  ability,  but  has  advantage  of  high  efficiency.  Optimization  method  performs 
well  in  robustness  and  experience,  but  there  are  some  problems  influencing 
practicality:  efficiency  of  method  based  on  modern  heuristic  algorithm  is 
unsatisfactory,  and  method  based  on  gradient  information  algorithm  has  no  global 
searching  ability.  Data  involved  in  aerodynamic  shape  design  is  mainly 
multidimensional,  such  as  design  variables  and  discrete  flow  field  solution.  Higher 
dimension data always relates to complex problem. Data dimension reduction method 
can realize to reduce data dimension efficiently, and certainly, the retention data can 
hold the main feature, at last, the problem is simplified. 
Against  the  main  problems  existing  in  aerodynamic  shape  design,  this  paper, 
considering thought of data dimension reduction and concrete methods, has developed 
the following researches. 
1.  Three  basic  aerodynamic  shape  optimization  design  systems  have  been 
established  for  different  use.  The  first  system,  which  evaluates  aerodynamic 
performance directly, is based on improved differential evolution algorithm and quick 
evaluation  programs  for  aerodynamic  performance  and  has  global  optima  searching 
ability. This system is suit for initial design for global optimal problem. The second 
system,  which  evaluates  aerodynamic  performance  by  prediction  approach,  is  based 
on  improved  differential  evolution  algorithm  and  Kriging  surrogate  model.  This 
system is suit for high accuracy design with less variables in global optima problem. 
At  last,  the  third  system  is  based  on  improved  gradient  descent  searching  method, 
discrete  adjoint  solver  and  RANS  solver.  The  third  system  is  propitious  to  high 
accuracy design with more variables for local optimal.     
2. The typical data dimension reduction methods have been studied. In the study of 
linear  aspect,  two  methods,  POD  and  SVD,  are  introdeuced  respectively,  and 
equivalence  of  the  two  methods  has  been  proved  theoretically,  meanwhile,  the 
difference  between  POD  and  SVD  also  is  elaborated.  In  nonlinear  data  dimension 
reduction  aspect,  properties  of  ISOMAP  algorithm  and  L-ISOMAP  algorithm  which 
is developed from ISOMAP have been researched. Based on minimum subset cover 
and  SVD,  a  novel  neighborhood  parameter  and  manifold  intrinsic  dimension 西北工业大学博士学位论文
 
IV 
 
estimation  method  has  been  developed.  This  method  reduces  calculation  time  at 
maximum degree when estimation accuracy is held.  
3.  Gappy  POD  aerodynamic  shape  inverse  design  method  has  been  improved.  In 
detail,  two  improvements  have  been  development.  Firstly,  the  optimum  snapshot 
substitution  sample  method  is  used  to  replace  original  random  sample  method,  and 
this strengths the ability of samples fitting design target. Secondly, according original 
error of each iteration, a real-time modification on target pressure distribution method 
has  been  developed  for  enhancing  design  accuracy  estimation.  The  tests  indicate: 
above  modifications  can  obviously  improve  the  precision  of  Gappy  POD  inverse 
design method in case of equal calculation efficiency. 
4. Inverse design method and optimization design method have been combined in 
aerodynamic  design  process  to  realize  their  complementary  advantages.  The  basic 
train of the idea: the first step is to use improved Gappy POD inverse design method 
to design roughly, the second step is using optimization method to design accurately. 
Test  cases  indicate  that  the  combination  strategy  has  advantages  of  strong  design 
ability, high efficiency, good robustness and low experience dependency.  
5.  A  novel  flow  field  solving  accelerating  idea,  based  on  initial  flow  field 
prediction, has been developed for shortening flow field solving time. This paper has 
come up with two methods for initial flow filed prediction: the first method is based 
on geometric similarity criterion, while the second method is based on combination of 
surrogate  model  and  POD  together.  The  test  examples  indicate  that  both  of  the 
prediction  methods  can  effectively  accelerate  flow  field  solution  and  the  second 
method  performs  better.  In  order  to  minimum  time  needed  for  optimization  process, 
one  strategy,  which  appropriately  matches  those  two  methods  according  to  their 
characteristics, has been proposed. 
6. An idea of filtering and reconstruction design space has been proposed. A new 
method of handling geometric constraints in aerodynamic shape design optimization 
has  been  established  by  combining  manifold  Learning  algorithm  and  manifold 
structure reconstruction technology. Test examples indicate: the unconstrained design 
space construction method can effectively improve efficiency of optimization system 
based  on  modern  heuristic  algorithm  which  evaluates  aerodynamic  performance 
directly,  and  also  the  system  based  on  gradient  information.  While  the  method 
proposed above does not work to the optimization system using surrogate model. 
7.  L1T2  muti-element  airfoil  has  been  optimized  by  using  global  optimization Abstract
 
 
V 
system  based  on  surrogate  model.  Flow  field  solving  accelerating  technology  based 
on initial flow field prediction is used in the process of optimization, so 75% time cost 
for  flow  field  solving  has  been  saved.  Compared  with  original  configuration,  the 
optimization result has a promotion of 8.63% in Cl.    
8. The wing of some long-range wide passenger plane has been designed roughly 
by  using  global  optimization  system  based  on  evaluating  aerodynamic  performance 
directly and improved Gappy POD inverse design method respectively, and the design 
target is minimum cruise drag. The results indicate that inverse design result has more 
potential in follow-up fine design than optimization result. Based on this conclusion, 
the inverse design result has been used for fine design by using optimization sysytem 
based  on  gradient  information.  The  design  space  filtering  and  reconstruction 
technology  has  been  used  in  the  process  of  optimization.  Comparing  the  optimized 
configuration  with  the  original  configuration,  reduction  of  the  drag  is  up  to  6.2%, 
meanwhile, all the geometric constraints are satisfied. 
Keywords:  
Aerodynamic  shape  design;  Data  dimension  reduction;  Optimization 
design  method;  Gappy  POD  inverse  design  method;   Flow  field 
solving accelerating method; Design space filtration and reconstruction 
 目
   
录
 
 
VII 
 
目
   
录
 
摘
   
要
 ........................................................................................................................... I
 
Abstract ...................................................................................................................... III
 
第一章
  
绪
  
论
 ............................................................................................................... 1
 
1.1  
论文研究背景
................................................................................................. 1
 
1.1.1  
气动外形反设计方法
.......................................................................... 1
 
1.1.2  
气动外形优化设计系统
...................................................................... 3
 
1.1.3  
气动外形设计方法的总结与思考
...................................................... 5
 
1.2  
数据降维方法及其在飞行器设计中的应用
................................................. 6
 
1.2.1  
数据降维的概念
.................................................................................. 7
 
1.2.2  
数据降维方法概述
.............................................................................. 7
 
1.2.3  
数据降维方法在飞行器设计中的应用
.............................................. 9
 
1.3 
本文目的及主要工作
.................................................................................... 10
 
第二章
  
气动外形优化设计系统构建
 ....................................................................... 13
 
2.1  
优化算法
....................................................................................................... 13
 
2.1.1  
自适应局部增强微分进化算法
........................................................ 13
 
2.1.2  
基于黄金分割线性搜索的最速下降法
............................................ 15
 
2.2  
几何外形参数化方法
................................................................................... 16
 
2.2.1 Hicks-Henne 
翼型参数化方法
 .......................................................... 16
 
2.2.2 CST 
翼型参数化方法
 ........................................................................ 16
 
2.2.3 FFD 
参数化方法
 ................................................................................ 18
 
2.3  
气动特性数值评估方法
............................................................................... 19
 
2.3.1  
翼型亚音速气动特性快速评估程序 
Xfoil ...................................... 19
 
2.3.2  
翼型跨音速气动特性快速评估方法
................................................ 20
 
2.3.3  
三维构型气动特性快速评估方法
.................................................... 21
 
2.3.4 RANS 
方程求解器
 ............................................................................. 24
 
2.4  
代理模型方法及代理模型管理框架
........................................................... 25
 
2.4.1 Kriging 
代理模型
 ............................................................................... 26
 
2.4.2  
代理模型管理框架
............................................................................ 28
 
2.5 
离散伴随方程求解器
.................................................................................... 29
 
2.6  
不同用途的气动外形优化设计系统构建
................................................... 30
 
2.6.1  
基于气动力直接求解的全局型优化系统
........................................ 30
 西北工业大学博士学位论文
 
VIII 
 
2.6.2 
基于代理模型的全局型优化系统
..................................................... 31
 
2.6.3 
基于梯度信息的优化系统
................................................................. 32
 
第三章
  
数据降维方法研究及发展
 ........................................................................... 33
 
3.1 
本征维度的概念及定义
................................................................................ 33
 
3.1.1  
流形的概念及定义
............................................................................ 33
 
3.1.2  
本征维度的概念及定义
.................................................................... 34
 
3.2 
典型线性数据降维方法
................................................................................ 34
 
3.2.1 POD 
方法及其基本性质
.................................................................... 35
 
3.2.2 SVD 
方法及其基本性质
.................................................................... 40
 
3.3 POD 
与 
SVD 
的等价性证明及实际使用中的差异
..................................... 41
 
3.3.1  
两种方法的等价性证明
.................................................................... 41
 
3.3.2  
两种方法在实际使用的差异性
........................................................ 42
 
3.4 
非线性数据降维方法 
ISOMAP ................................................................... 42
 
3.4.1 ISOMAP 
方法及其基本性质
 ............................................................ 43
 
3.4.2 
基于最小子集覆盖的 
L-ISOMAP 
算法
 ............................................ 48
 
3.5 
新型邻域参数与本征维度估算方法
............................................................ 51
 
3.5.1 
方法的构建
......................................................................................... 51
 
3.5.2 
算例验证
............................................................................................. 52
 
第四章
  Gappy POD 
反设计方法改进及应用
 ......................................................... 55
 
4.1 Gappy POD 
反设计方法
 ............................................................................... 55
 
4.1.1 Gappy POD 
方法
 ................................................................................ 56
 
4.1.2 Gappy POD 
反设计方法
 .................................................................... 57
 
4.2 Gappy POD 
反设计方法的改进
 ................................................................... 61
 
4.2.1 
最优快照替换采样法
......................................................................... 61
 
4.2.2 
迭代过程中目标压力分布的修正
..................................................... 62
 
4.2.3 
改进方法设计精度检验
..................................................................... 63
 
4.3  
反设计与优化相结合的跨音速翼型设计
................................................... 64
 
4.3.1 
旨在削弱激波的反设计
..................................................................... 65
 
4.3.2 
基于优化系统的精细设计
................................................................. 66
 
第五章
  
缩短流场求解时间的新思路及方法
 ........................................................... 71
 
5.1  
优化过程中缩短单次流场求解时间的思路
............................................... 71
 
5.1.1  
基于几何相似的初始流场预测思路
................................................ 72
 
5.1.2  
基于代理模型的初始流场预测思路
................................................ 72
 目
   
录
 
 
IX 
 
5.2 
基于几何相似的初始流场预测
.................................................................... 73
 
5.2.1 
流场预测方法
..................................................................................... 73
 
5.2.2 
预测初始流场加速流场求解的效果
................................................. 75
 
5.3  
基于代理模型与 
POD 
的初始流场预测
..................................................... 83
 
5.3.1 
流场预测方法
..................................................................................... 83
 
5.3.2 
预测初始流场加速流场求解的效果
................................................. 85
 
5.4 
两种流场预测方法的对比及搭配使用
........................................................ 93
 
5.4.1 
两种流场预测方法加速流场求解的能力对比
................................. 93
 
5.4.2 
两种流场预测方法的搭配使用
......................................................... 94
 
第六章
  
基于 
ISOMAP 
的设计空间过滤与重构
 ..................................................... 97
 
6.1  
存在等式约束时设计空间的特征及提取
................................................... 97
 
6.1.1  
存在等式约束时设计空间的主要特征
............................................ 97
 
6.1.2  
满足所有约束条件的子空间提取方法
............................................ 99
 
6.2  
流形结构重建的必要性及方法
................................................................... 99
 
6.2.1  
流形空间重构的必要性
.................................................................... 99
 
6.2.2  
流形空间返回高维空间映射的必要性
.......................................... 101
 
6.2.3  
基于 
ISOMAP 
的流形结构重建
 .................................................... 101
 
6.3  
满足几何约束的设计空间提取与重构
..................................................... 104
 
6.3.1  
几何约束处理方法
.......................................................................... 105
 
6.3.2  
梯度信息从高维空间到流形空间的转换
...................................... 106
 
6.4  
方法适用性检验
......................................................................................... 109
 
6.4.1  
在气动力直接求解的全局型优化系统中的适用性
...................... 109
 
6.4.2  
在使用代理模型的全局型优化系统中的适用性
.......................... 112
 
6.4.3  
在基于梯度信息的优化系统中的适用性
...................................... 113
 
第七章
  
设计算例及分析
 ......................................................................................... 117
 
7.1  
二维多段翼型优化设计
............................................................................. 117
 
7.1.1  
优化对象及优化模型的建立
.......................................................... 117
 
7.1.2  
优化设计结果及分析
...................................................................... 119
 
7.2  
远程宽体客机机翼优化设计
..................................................................... 120
 
7.2.1  
基于全局型优化系统的粗略优化设计
.......................................... 121
 
7.2.2  
基于改进型 
Gappy POD 
反设计方法的反设计
 ............................ 125
 
7.2.3  
基于 
RANS 
方程求解器与梯度信息的精细优化设计
 ................. 128
 
7.3  
设计算例总结
............................................................................................. 132
 西北工业大学博士学位论文
 
X 
 
第八章
  
总结与展望
 ................................................................................................. 133
 
8.1  
研究总结
..................................................................................................... 133
 
8.1.1  
论文创新点
...................................................................................... 133
 
8.1.2  
主要研究结论
.................................................................................. 134
 
8.2  
研究展望
..................................................................................................... 135
 
参考文献
 ................................................................................................................... 137
 
攻读博士学位期间发表的论文及参与的科研项目
 ............................................... 147
 
致
  
谢
 ......................................................................................................................... 149
 
  第一章
  
绪论
 
 
1 
 
第一章
  
绪
  
论
 
气动外形设计是飞行器设计中极为重要的组成部分，但气动外形与气动性能
之间的复杂关系及各种约束的存在使得这项工作往往成为整个飞行器设计流程
中最为困难的环节之一。随着人类对飞行器性能要求的不断提高，气动设计方法
面临的问题越来越复杂，暴露出的不足之处也越来越多。从数据分析角度来说，
气动设计中涉及到的数据都是多维、甚至超高维的。如，计算流体力学
(Computational Fluid Dynamics, CFD)
方法求解出的离散流场维度可达数千万。数
据的维度越高，与之相关的问题往往也越复杂。数据降维方法能在保留数据集主
要特征的基础上有效降低数据的维度，从而使相关问题得到简化。因此，借助数
据降维的思想和具体方法去解决气动设计方法中存在问题是一个值得研究方向。
 
1.1  
论文研究背景
 
早期，受设计方法及分析工具的限制，飞行器设计师只能凭借自身经验进行
气动外形设计，设计结果性能的评定完全依赖风洞实验。这种设计模式效率低、
周期长、花费高，但设计结果却并不一定好。随着计算机的出现及发展，数字化
设计逐渐出现在各个工程领域。气动外形的数字化设计最早出现在上世纪 
60 
年
代，当时一些简单的气动性能数值评估方法及早期 
CFD 
方法的出现使得一些简
单气动外形的性能评估工作可以在计算机上完成。此后，随着计算机水平及 
CFD
的进一步发展，基于气动力计算与分析的气动外形数字化设计也得到了爆发式的
发展，大量新型气动外形数字化设计方法不断涌现。概括起来，这些方法可以分
为两类：反设计方法和优化设计方法。
 
1.1.1  
气动外形反设计方法
 
反设计方法的基本原理是：通过改变构型的气动外形使得其表面压力分布与
给定的目标压力分布尽可能吻合，从而获得尽可能满足期望的气动外形。根据反
设计方法的基本原理不同，本文将已有的反设计方法分为两大类：经典反设计方
法与现代反设计方法。经典反设计方法均根据气动外形与流场之间的复杂函数关
系或流场控制方程推导而来，与物理机理密切相关；而现代反设计方法的总框架
主要由纯数学方法决定，与物理机理之间的联系不太紧密。
 
最早的经典反设计方法由 
Lighthill 
于 
1945 
年提出
[1]
，但此后受计算机及 
CFD
发展水平的限制，经典反设计方法并没有太大的进展。上世纪 
7
、
80 
年代是经典
反设计方法发展的黄金时期，涌现出的方法多达数十种，且很多方法在工程设计
中得到了实际应用。华俊
[2]
、杨青真
[3]
等人对当时应用较为广泛的几种方法进行西北工业大学博士学位论文
 
2 
 
了深入地研究，着重分析了这些方法的基本原理及优、缺点。他们研究过的方法
包括：
Carlson 
跨音速翼型反设计方法
[4]
、虚拟气体法
[5]
、
Henne 
三维跨音速机翼
反设计方法
[6]
、
Mcfadden 
跨音速翼型反设计方法
[7]
及 
Takanashi 
余量修正法
[8]
。
通过对上述方法优、缺点的深入分析，华俊提出了实用的跨音速翼型
/
机翼反设
计方法应该具备的十个条件，同时他认为 
Takanashi 
余量修正法是最有潜力达到
所有条件的方法，故对其进行了以下三个方面的深度改进
[2]
：
 
1
、用解析形式的积分表达式代替了原始方法中使用的数值积分，提高了计
算精度；
 
2
、在设计中考虑了粘性的影响，提高了设计精度；
 
3
、在设计中引入了加权光顺技术，使得设计结果表面更光滑，对含激波目
标压力分布的适应性也更强，且设计收敛速度也有所加快。
 
杨青真在上述改进的基础上进一步进行了考虑机身及机翼三维附面层影响
的改进。经过上述改进之后，
Takanashi 
余量修正法的实用性及设计效率均明显
提高。以华俊、杨青真等人的研究成果为标志，经典气动外形反设计方法基本达
到了发展的顶峰，此后再无重大发展。其主要原因在于经典反设计方法存在以下
几点难以克服的缺点：
 
1
、需要事先给定气动性能优秀的目标压力分布，这要求设计者具有非常丰
富的气动外形设计经验；
 
2
、如果给定的目标压力分布不太合理，那么反设计过程很可能无法收敛；
 
3
、不能任意选取或使用比表面压力分布或速度分布更适当的设计目标表达
式；
 
4
、处理几何、气动约束比较困难。
 
人们也曾努力尝试去克服经典反设计方法中的上述缺陷，但收效甚微。例如
对于目标压力分布难给定的问题，
Van Egmond
[9]
  
、
Van den Dam
[10,11]
等人采用优
化方法首先优化目标压力分布，当得到一个性能优异的目标压力分布后再采用经
典反设计方法设计出其对应的气动外形。这种方法的问题在于：在优化目标压力
分布的过程中，评估任意一个压力分布的好坏需要知道此压力分布对应的气动外
形，但此时压力分布又是未知的。为此，只能采用各种估算方法估计一个压力分
布对应的气动性能，这无疑会降低设计方法的精度。此外，即便优化出的目标压
力分布性能非常优秀，但如果它本身是不合理的，那么经典反设计方法也很可能
无法收敛。
 
当经典反设计方法止步不前的时候，人们很快将研究兴趣转移到更具发展潜
力的气动外形优化设计方法，以至于随后出现的现代反设计方法并没有引起人们
的广泛注意。因此现代反设计方法的种类远不如经典反设计方法丰富。基于优化
算法的反设计方法
[12,13]
是现代反设计方法中的典型代表，其基本原理为：采用优第一章
  
绪论
 
 
3 
 
化方法对气动外形进行优化，优化的目标为气动外形的压力分布与目标压力分布
之间的差异最小。相对于经典反设计方法，此方法的优势在于：当目标压力分布
不合理时，仍然能够设计出压力分布与目标压力分布差异最小的气动外形，并且
设计过程中能够很方便地处理各种几何及气动约束。但仔细分析会发现，这种方
法表面属于反设计方法，本质却是优化设计方法，只不过其优化的对象并不是通
常的各种气动力系数，而是表面压力分布。
 
2004 
年，麻省理工的 
Bui-Thanh
[14]
等人发明了一种全新的现代气动外形反设
计方法
—
Gappy  POD 
反设计方法。此方法以数学中的本征正交分解方法
(Proper 
Orthogonal Decomposition, POD)
及最小二乘法为基础，采用迭代的方法逐渐拟合
出目标压力分布对应的气动外形。相对于经典反设计方法，
Gappy  POD 
反设计
方法计算过程极其简单，且对目标压力分布的合理性没有要求；相对于基于优化
算法的反设计方法，这种方法调用压力分布求解器的次数更少，计算效率更高。
但是，
Gappy  POD 
反设计方法并不能像基于优化的反设计方法那样很方便地处
理各种几何及气动约束。
 
1.1.2  
气动外形优化设计系统
 
完整的气动外形优化设计系统由优化算法、几何外形参数化方法、气动特性
评估方法组成。其中优化算法决定了整个气动外形优化系统的顶层架构，其效率
与寻优能力对整个优化系统的效率与设计能力也具有决定性的影响。根据所需目
标数值特征的不同，本文将气动外形优化系统中所使用的优化算法分为两大类：
基于目标函数梯度信息的优化算法与基于目标函数值的优化算法。
 
基于目标函数梯度信息的优化算法依据目标函数的局部变化特征进行优化
搜索。在气动外形设计中，目标函数的局部变化特征即为气动性能参数相对于设
计参数的梯度信息。典型梯度型优化算法包括：最速下降法
[15]
，拟牛顿法
[16]
、
共轭梯度法
[17]
以及序列二次规划
[18]
等。这些算法具有局部搜索能力强、收敛速
度快、计算效率高的特点，适用于构建大规模高精度气动外形优化系统。但是，
当设计目标与设计参数之间的函数关系较为复杂时，基于目标函数梯度信息的优
化算法不具备全局寻优能力，所以只能得到局部最优解。同时，在气动外形优化
过程中获取气动特性相对于设计参数的梯度信息也比较麻烦。
 
基于目标函数值的优化算法只需要目标函数值而不需要目标函数的梯度，所
以相对基于梯度信息的优化算法来说其适应能力更强。在气动外形设计中，目标
函数值即为气动性能参数。这类算法中的典型方法包括：模式搜索算法
[19]
、可
变容差多面体法
[20]
以及现代启发式算法。其中现代启发式算法又是一类算法的
统称，其通过模拟某些自然现象或物理过程构建算法框架以实现寻优，典型算法西北工业大学博士学位论文
 
4 
 
包括：遗传算法
[21]
、模拟退火算法
[22]
、微分进化算法
[23]
等。现代启发式算法一
般以群体进行搜索，具有较强的全局寻优能力；同时这类算法可以通过对比群体
中不同个体的目标函数值，方便的处理多目标优化问题。但是现代启发式算法的
收敛速度慢，优化过程中需要计算大量的目标函数值，在计算效率方面远不如基
于梯度信息的优化算法。
 
在气动外形优化系统中，几何外形参数化方法的功能是：通过一定数量的参
数建立起描述飞行器几何外形的数学模型。文献
[24]
根据参数化方法的机理和特
点，将其分为两大类：直接几何外形参数化方法与调整基准几何外形的参数化方
法。直接几何外形参数化方法可根据给定的几何参数直接生成对应的几何外形，
典型方法包括：
PARSEC 
翼型参数化方法
[25,26]
、
CST 
翼型参数化方法
[27-29]
，
B 
样
条曲面建模方法
[30]
、以及非均匀有理 
B 
样条曲面建模方法
[31,32]
。调整基准几何
外形的参数化方法通过建立控制参数与基准几何外形的变形关系间接实现对几
何外形的建模，典型方法包括：
Hicks-Henne 
翼型参数化方法
[33,34]
、
Wagner 
翼型
参数化方法
[35]
以及自由变形（
Free Form Deformation, FFD
）参数化方法
[36-39]
。
 
气动性能评估是气动外形优化系统中最底层的环节，但也是最重要的环节之
一。一方面气动性能的评估精度直接决定了优化系统的设计精度；另一方面气动
性能评估的效率对优化系统的效率具有决定性的影响。根据精度的不同，现有的
气动性能评估方法可以分为以下几类：代数公式估算法
[40-42]
、面元法、面元法与
求解附面层方程耦合法
[43]
、求解小扰动
/
全速度势方程法、耦合求解小扰动
/
全速
度势方程与附面层方程法
[2]
、求解欧拉方程法、耦合求解欧拉方程与附面层方程
法
[44]
、求解雷诺平均 
NS(Reynolds Averaged Navier-Stokes, RANS )
方程法以及脱
体涡数值模拟
(Detached Eddy Simulation, DES)
方法
[45]
。理论上，上述气动性能评
估方法的精度是依次升高的，但计算效率却是依次降低的。因此，实际使用中人
们并不盲目地追求使用高精度气动性能评估方法，而是根据实际情况进行合理地
选择。例如在气动布局优化中，往往使用面元法甚至经验公式估算法即可满足设
计精度要求，所以通常不需要使用精度更高的评估方法。但是，某些情况下使用
高精度的评估方法却是不可避免的。比如，在精细的气动外形优化中，往往需要
使用求解 
RANS 
方程的方法进行气动性能评估；而在飞行器的过失速气动特性
优化中则需要使用 
DES 
方法进行气动性能评估
[46]
。此时，这些计算代价高昂的
评估方法往往会严重拖累整个优化系统的效率，为此代理模型被引入气动外形优
化系统以缓解这种现象。
 
代理模型方法的思路是：基于一定数量的样本构建一个几何外形参数与气动
性能之间的近似函数关系以代替计算代价高昂的气动特性评估方法，从而大幅减
少气动外形优化中的计算量。相对于原始气动性能评估方法，高精度的代理模型第一章
  
绪论
 
 
5 
 
在整个设计域内对气动性能的预测精度并不会显著降低，所以代理模型方法在全
局型的高精度气动外形优化系统中获得了广泛地应用。构建代理模型的常用方法
包括：多项式响应面
[47]
、神经网络
[48]
、
Kriging 
模型
[49]
、高斯过程
[50]
以及支持向
量机
[51]
等。当然，精度再高的代理模型也存在一定的预测误差，因此在优化设
计中如果完全用代理模型取代原始气动性能评估方法，可能会导致设计结果偏离
优化设计要求
[52]
。为此，往往需要在优化系统中引入代理模型管理框架，以便
在优化过程中对代理模型进行更新，保证代理模型的精度能够适应优化过程的发
展。根据代理模型与优化算法耦合程度的不同，代理模型管理框架又分为松散式
代理模型管理框架
[53,54]
与紧密式代理模型管理框架
[55,56]
。
 
当气动外形优化系统选用基于目标函数梯度信息的优化算法时，需要对气动
性能相对设计参数的梯度进行评估。可采用的方法包括有限差分方法
[57]
与求解
伴随方程的方法
[58,59]
，其中有限差分方法因计算量大而在实际中很少被采用。求
解伴随方程的方法只需进行一次伴随方程的求解即可获得气动性能相对几何外
形参数的梯度，计算效率非常高，是当前基于梯度信息的优化系统获取梯度信息
的主流方法。
 
针对具体的气动外形优化任务，选定合适的优化算法、参数化方法及气动特
性评估方法后即可构建出完整的气动外形优化系统。令k
 为优化系统迭代的代数
，初始时k
 
=
1，则优化系统运行的基本流程如下：
 
1)  若 
k 
=
1，则人为或由优化算法给出初始设计参数；若 
k 
>
1，则由优化算
法根据当前设计参数及其对应的气动性能或气动性能相对设计参数的梯
度更新设计参数；
 
2)  根据上一步产生的设计参数由参数化方法生成相应的气动外形；
 
3)  对上一步生成的气动外形进行气动性能评估或气动性能相对于设计参数
的梯度评估；
 
4)  优化算法根据一定的准则判断优化过程是否收敛或者优化迭代代数是否
已经达到设定的上限。若是，则执行下一步；若否，则 k
 
=
k 
+
1，并将
优化算法所需的一些当前信息传给优化算法，转到第 
1 
步；
 
5)  输出优化过程中的最优结果。
 
1.1.3  
气动外形设计方法的总结与思考
 
从前面的论述可知，反设计方法的种种缺陷使得其已基本无法满足现代气动
外形设计的各种要求。因此，优化设计方法取代反设计方法成为气动设计领域中
的主流是必然趋势。相对于反设计方法，优化设计方法的优势具体体现在以下 
5
个方面：
 西北工业大学博士学位论文
 
6 
 
1
、直接以气动性能为设计目标，设计目的直接、明了；
 
2
、设计目标通常不需要指定具体量化的指标，对设计者的设计经验无太高
要求，有利于新型气动外形的探索性设计；
  
3
、能够面向多个目标进行综合性能最优的设计；
 
4
、能够处理各种几何、气动约束；
 
5
、设计方法本身是与流动控制方程无关的优化算法，理论上能够与任何气
动性能评估方法相结合。
 
虽然优化设计方法相对于反设计方法优势明显，但也并非完美无缺。在大量
的实际使用中，人们发现了优化方法中存在的一些不足，其中比较突出的有以下
几个方面：
 
1
、基于现代启发式算法的优化设计系统需要对大量气动外形进行气动性能
评估，所以计算效率很低。虽然代理模型能够缓解这一问题，但当设计参数较多
时构建代理模型所需的样本数量也非常多，计算效率低的问题同样突出；
 
2
、基于梯度信息的优化设计系统严重依赖初始构型在设计空间中的位置。
若初始构型附近存在气动性能优秀的构型，则优化结果往往比较好，反之则优化
结果往往比较差。此外，初始构型的好坏对基于现代启发式算法的优化系统的设
计结果也有一定影响；
 
3
、虽然基于现代启发式算法的优化设计系统处理各种约束比较方便，但约
束的存在会降低优化算法寻优的效率，且约束越多，优化算法效率降低越明显。
对于基于梯度信息的优化设计系统来说，其处理约束的能力本身就比较弱，对于
一些复杂的约束条件可能无法处理。
 
需要特别指出的是，反设计方法具备的一些优点刚好可以弥补优化设计方法
的一些不足。比如，大多数反设计方法的计算效率非常高，往往调用数十次求解
器即可完成一次设计；再比如，对于经验丰富的设计人员来说，可以给出兼顾同
一状态甚至不同状态下多个气动性能指标的优秀目标压力分布。在这种情况下，
完成一次反设计即相当于完成一次多目标优化设计。
 
综上所述，为了让优化设计方法在实际使用中更加高效、便捷，还需在三个
方面开展进一步的研究。同时，如果能在当前的气动设计体系中对反设计方法的
各种优点加以利用同时又尽可能避免其固有缺点也是一个值得研究的方向。
 
   
1.2  
数据降维方法及其在飞行器设计中的应用
 
对于涉及到大量高维数据的复杂问题，数据降维方法能够有效降低数据维度
，从而将相关问题化繁为简。因此，数据降维方法及其应用一直是包括飞行器设
计在内的很多学科领域中的热门研究方向。
 第一章
  
绪论
 
 
7 
 
1.2.1  
数据降维的概念
 
现代科学技术体系的建立极大地加深了人类对自然事物与客观规律的认识、
促进了人类社会飞跃式地发展，而客观事物的量化则是开展现代科学技术研究的
基础。例如，为了对天气进行预报，人们需要采集不同地点在不同时刻的温度、
湿度、压力等数据。广义上，本文将量化一个事物所需数据的个数称为维度。当
对一个事物进行粗略研究时，往往需要的数据比较少，即数据的维度比较低；当
对一个事物进行深入研究时，往往需要的数据会比较多，即数据的维度会比较高
。这是因为维度更高的数据提供了更丰富、更细致的信息。但凡事都具有双面性
，维度更高的数据会增加数据处理和分析的难度，甚至带来所谓的
“
维度灾难
”
[60]
。
 
数据降维概念即为：在不明显减少高维数据集所蕴含信息的情况下尽可能地
降低数据的维度，以便于数据的处理和分析。这里的信息并不是指高维数据中蕴
含的所有信息，而是进行特定研究时所关心的信息。此外，数据降维的对象通常
也不是单个高维的数据向量，而是一定数量的高维数据向量集合。
 
1.2.2  
数据降维方法概述
 
通常，现有的数据降维方法可分为线性方法与非线性方法两大类。线性降维
方法计算简单，对于具有近似线性结构的高维数据集非常适用。所有线性降维方
法的实质是在不同优化准则之下寻求最佳线性模型
[61]
，这里“不同优化准则
”
是
构建线性降维方法的基本出发点。以下通过对几种典型线性降维方法的简介给出
所谓的“优化准则
”
的实例。
 
POD
[62-64]
是各技术领域中应用最为广泛的线性降维方法之一，这种方法的基
本原理是：构建一个低维线性空间，使得高维数据集在此空间中的投影尽可能地
大；或者是构建一个线性变换将高维的数据集变换为低维的数据集，但变换之后
的数据集应尽可能地保留高维数据集的方差信息。奇异值分解
(Single  Value 
Decomposition, SVD) 
[65,66]
是另一种被广泛应用的线性降维方法。表面上 
SVD 
只
是一种矩阵分解方法，并不是根据某种优化准则建立起来的降维模型。实际上，
这种方法在理论上与 
POD 
方法是等价的，只是运算过程不同，有关于此的具体
论述见本文第三章。
POD 
方法与 
SVD 
方法被广泛应用的领域包括：图像压缩与
识别
[67-70]
、文本分类
[71-74]
、信号处理
[75]
、气象资料分析
[76]
、机械故障诊断
[77]
及
控制系统简化等
[78]
。
 
多维尺度变换
(Multidimensional  Scaling,  MDS)
[79,80]
是另一种具有直观意义
的线性降维方法，其构建的出发点为：建立一个线性变换，将一组高维数据集变西北工业大学博士学位论文
 
8 
 
换到低维空间，使得高维数据集中任意两点之间的距离尽可能地在低维空间中得
到保持。
MDS 
非常适合于高维数据的可视化，即：将高维空间中无法直观显示
的数据集变换到三维空间甚至二维空间，以直观的观察数据点之间的位置关系。
除此之外，
MDS 
还被应用于无线网络分析
  [81,82]
等领域。
 
线性降维方法虽然计算简单、意义直观，但正如本文 
3.2.1 
小节所举实例一
样，如果高维数据集中本身并不存在线性的或近似线性的结构特征，那么线性降
维方法是无法实现有效降维的。而现实世界中大量的高维数据集呈现的往往是非
线性的结构特征。为此，各种非线性数据降维方法应运而生。
 
很多传统的非线性数据降维方法由线性降维方法推广而来，比如核主成分分
析
(Kernel Principle Component Analysis, KPCA)
[83,84]
以及主曲线
(Principal Curves, 
PC)
就脱胎于 
POD 
方法
[85]
。其中 
KPCA 
方法是 
POD 
方法与核映射方法的结合，
而 
PC 
方法则是 
POD 
方法向曲线坐标系的推广。此外，基于人工智能领域中的
重要方法
—
人工神经网络
[48]
人们发展了自组织映射算法
(Self-orgonizing  Feature 
Map, SFM)
[86]
。这种方法的核心思想为：将高维的数据由神经网络映射至低维空
间，使得高维数据集中结构相近的数据点映射到低维空间后依然具有相近的邻近
关系。上述三种方法算是传统非线性数据降维方法中较为成功的，但它们因各自
的缺陷而没有获得广泛的应用
[87]
。
 
以 
2000 
年《
Science
》上发表的两种基于流形理念的数据降维方法
[88,89]
为标
志，流形学习—这一全新的非线性数据降维研究方向正式诞生。流形学习的基本
出发点为：自然界中以高维数据形式存在的信息实际上很可能位于一个低维流形
上。比如，用一个相机对一个固定的茶壶沿水平方向从不同的角度进行拍照得到
了一系列照片，每张照片均由 
10 
万个像素点组成。那么表面上这一系列照片看
起来是一组互不相同的 
10 
万维向量，实际上它们只是以拍摄角度为参数的、嵌
入在 
10 
万空间中的一维流形。面对这些照片，人的大脑会自动根据拍摄的角度
去分辨它们之间的差异，而不会机械的对任意两张照片上的 
10 
万个像素点进行
逐一对比。这说明人的认知过程很多时候是基于非线性流形的，而无数的实践也
表明这是非常准确且高效的。流形学习算法正是通过呈现蕴含在高维数据集中的
非线性流形结构进行降维的。
 
从其诞生至今短短十多年的时间里，流形学习得到了极大的发展，涌现出的
流形学习方法多达数十种。学界通常将流形学习方法分为全局型方法和局部型方
法，全局型方法能捕捉数据集所在低维流形的整体结构，而局部型方法则只能捕
捉数据集所在低维流形的局部结构。典型的全局型流形学习方法包括等距特征映
射算法
(Isometric Mapping, ISOMAP)
[88]
以及发散映射算法
(Diffusion Maps)
 [90]
；典
型的局部型流形学习方法包括局部线性嵌入算法
(Local Linear Embedding
，
LLE)
 第一章
  
绪论
 
 
9 
 
[89] 
， 拉 普 拉 斯 特征 映射 
(Laplacian  Eigenmap,  LE)
  [91] 
， 海塞 特征特征 映射
(Hessian-based Locally Linear Embedding, HLLE) 
[92]
，
Logmap 
方法
[93]
等。此外还
有一些方法兼具全局型方法与局部型方法的特征，其中较为典型的包括局部切空
间排列
(Local  Tangent  Space  Alignment,  LTSA)
[94]
及最大差异展开
(Maximum 
Variance Unfolding, MVU)
 [95]
。
 
上述流形学习算法不仅仅只是停留在理论上，在实际应用中也取得了极大的
成功。其中图像识别是各种流形学习算法应用最为广泛的领域，其被用于人脸识
别
[96]
、人体姿势识别
[97]
、红外目标检测
[98]
、光谱影像分类
[99]
等方向。此外，雷
迎科
[100]
采用改进的 
ISOMAP 
算法进行了蛋白质相互作用数据可信度的评估，取
得了较好的效果。
 
1.2.3  
数据降维方法在飞行器设计中的应用
 
飞行器设计作为一项极为复杂的系统工程，必然涉及到大量与高维数据甚至
是超高维数据相关的操作与运算。比如，采用 
CFD 
方法求解一架飞机的绕流流
场，实际上是求解包围飞机的离散网格点上的基本流场变量值，此时，一架飞机
的绕流流场实际上是一个维度高达数百万、甚至上千万的向量。而飞行器设计中
需要对大量构型进行流场计算与分析，甚至是对同一个构型计算大量不同状态下
的流场。显然，这其中的计算量以及流场分析的工作量都是非常巨大的。因此，
数据降维的思想与方法很早就被引入到与飞行器设计相关的各个领域，以提升涉
及到高维数据时的计算效率，或简化对高维数据的处理过程。其中，基于数据降
维思想与方法发展起来的各种降阶模型
(Reduced Order Model, ROM)
方法在飞行
器设计中应用最为广泛，相关技术也最成熟，成果也最丰富。例如 
POD 
就是构
建 
ROM 
的一种常用数据降维方法，基于 
POD 
的 
ROM 
构建原理为：首先采用
POD 
方法对一定数目的样本流场（通常称为快照）进行主要模态的提取，然后
采用伽辽金投影将流场控制方程投影到提取的主要基模态上得到低阶的流场控
制方程。通常，求解低阶流场控制方程所需时间仅为求解原始流场控制方程所需
时间的几百分之一
~
几千分之一
[101]
。
Romanowski
[102]
等人采用这种方法进行了基
于欧拉方程的二维翼型气弹降阶研究，
Thomas
[103]
等人在此基础上进一步进行了
三维机翼的气弹降阶研究，
Lieu
[104]
等人用 
POD 
构造的降阶模型实现了对 
F-16
全机动气弹的计算，
Willcox 
等人
[105]
则基于 
POD 
构造了涡轮叶片的气弹降阶模
型。
 
除了用于对流场控制方程进行降阶，数据降维方法还被用于气动外形设计。
T. Bui-Thanh
[14]
等人巧妙的将 
Sirovich
[106]
提出的 
Gappy POD 
方法改造成一种鲁棒
性极强的反设计方法。白俊强
[107]
等人对这种方法进行了进一步的发展，取得了西北工业大学博士学位论文
 
10 
 
较好的效果。
Toal 
等人
[108]
采用 
POD 
方法对二维翼型优化过程中产生的优良个体
进行主要几何特征的提取，然后利用提取的主要几何特征进行翼型的参数化，最
后再进行精细的优化设计。他们的研究表明这种做法能获得更为优异的优化结果
。与之类似，
Robinson
 [109]
等人在进行超临界翼型优化设计前首先采用 
POD 
方法
从已有的 
200 
个几何外形各异的超临界翼型中提取主要几何特征，然后利用提取
的几何特征进行翼型的参数化，以使得优化过程中尽可能少地产生不具备超临界
翼型特征的个体、提升优化效率。
 
从上述论述中可以看出，数据降维方法在飞行器设计领域中的应用面还比较
窄，主要集中在气动弹性计算及气动外形设计方面。其中，在气动外形设计方面
的应用还很初步，相关研究还不够深入。然而，从气动设计本身的复杂性及数据
降维方法化繁为简的能力来看，数据降维方法在气动外形设计中应该还能有更大
的作为，是一个值得继续研究的方向。
 
   
1.3 
本文目的及主要工作
 
本文目的在于：拓宽数据降维方法在气动外形设计中的应用面，进一步挖掘
数据降维方法在气动外形设计中的应用潜力。从数据降维的角度出发，提出新思
路、开发新方法，以缓解当前气动外形设计方法中存在的主要问题，提升设计效
率、增强设计能力。同时，对数据降维方法在气动外形设计中的应用前景进行分
析与展望，以期引起气动设计领域对数据降维方法的进一步重视。
 
为实现上述目的，本文后续章节完成了以下几个方面的工作：
 
1
、第二章中，基于成熟的优化算法、参数化方法、气动特性评估方法、代
理模型方法、代理模型管理框架及离散伴随方程求解方法构建了三套用途不同的
基本气动外形优化设计系统。具体构建过程如下：基于改进的微分进化算法与气
动力快速评估程序构建了气动力直接求解的全局型优化系统，此系统适用于面向
全局最优的初步设计；基于改进的微分进化算法与 
Kriging 
代理模型构建了气动
力预测的全局型优化系统，此系统适用于设计变量较少时面向全局最优的高精度
设计；基于改进的最速下降法、离散伴随求解器及 
RANS 
方程求解器构建了基
于梯度信息的优化系统，此系统适用于设计变量较多时面向局部最优的高精度设
计；
 
2
、第三章对典型数据降维方法的性质进行了研究，并对有关方法进行了进
一步的发展。具体研究了线性的 
POD 
方法及 
SVD 
方法的性质，证明了两种方法
在理论上的等价性，阐述了两种方法在实际使用中的差异。同时，对非线性的流
形学习算法 
ISOMAP 
及其改型 
L-ISOMAP 
的性质开展了研究，并基于最小子集
覆盖与 
SVD 
开发了一种新型流形邻域参数与本征维度估计方法。针对三维第一章
  
绪论
 
 
11 
 
Swiss-roll 
数据集的测试结果表明，这种新型估算方法能准确地估算出流形学习
算法最佳的邻域参数范围及流形的本征维度；
 
3
、第四章对新型气动外形反设计方法
—
Gappy POD 
方法进行了研究，验证
了方法的计算效率、设计精度及鲁棒性。在此基础上对方法的采样过程进行了改
进，用采样过程中的当前最优构型替换基础扰动构型使得所采集的样本尽可能地
逼近目标压力分布对应的构型；同时基于原始方法迭代过程中的误差开发了一种
方法对目标压力分布进行修正以提高最终设计结果的精度。测试算例表明，本文
对 
Gappy POD 
方法所做的改进能有效提升设计精度。基于改进的 
Gappy POD 
反
设计方法，进一步提出了用反设计方法先对初始构型进行粗略设计然后再用优化
方法进行精细设计的组合设计策略。针对跨音速翼型的设计算例表明，相对于纯
粹使用优化设计的方法，本文提出的这种组合策略不仅效率高，而且设计结果也
更好；
 
4
、第五章提出了两种加速气动外形优化过程中流场求解速度的方法。第一
种方法的基本原理为：根据待求解流场构型与已求解流场构型在几何外形方面的
相似度从已求解出的流场中挑选一个作为待求解流场的初始流场，然后进行流场
求解；第二种方法基本原理为：基于一定数量的样本流场采用 
POD 
方法提取出
这些流场的主要基模态，然后用提取的主要基模态拟合所有样本流场并建立联系
样本流场的基模态拟合系数与其对应气动外形几何参数之间的代理模型。最后对
于需要求解流场的新构型，先采用代理模型预测出其流场的基模态拟合系数得到
一个预测的初始流场，然后再进行流场求解。针对二维翼型亚
/
跨音速绕流流场
的测试表明：这两种方法均能有效加快流场求解的速度，且基于代理模型与 
POD
的初始流场预测方法比基于几何相似度预测初始流场的方法效果更好。根据两种
方法各自的特点，还提出了一种在优化设计中将两种方法搭配使用的策略，以最
大限度地减少优化设计中流场求解所需的时间；
 
5
、第六章研究了存在等式约束时设计空间的几何特征，得出了此时满足所
有约束条件的子设计空间是嵌入在给定设计空间中的超曲面的结论。在此基础上
提出了用流形学习方法提取该超曲面、建立一个满足所有约束条件的设计空间的
思想。为实现这一思想，完成了基于 
ISOMAP 
的流形空间重构方法研究。最后
基于建立的方法进行了气动外形优化中满足几何约束的设计空间提取与重构研
究，以及设计目标相对于设计变量的梯度由高维空间转换到流形空间的方法研究
。测试算例表明：本文提出的设计空间过滤与重构方法能有效提升基于现代启发
式算法与直接气动力求解的优化系统的效率，也能提升基于梯度信息的优化系统
的效率，但不适用于使用了代理模型的优化系统；
 
6
、第七章基于上述各项研究成果对二维多段翼型及远程宽体客机机翼进行西北工业大学博士学位论文
 
12 
 
了气动外形优化设计，均取得了令人满意的优化设计结果，验证了本文基于数据
降维思想与方法开发的各种新技术、新方法在飞行器气动外形设计中的实用性；
 
7
、第八章对本文完成的工作及创新点进行了总结，并对本文后续可继续开
展的工作进行了展望。
 
  第二章
  
气动外形优化设计系统构建
 
 
13
 
 
第二章
  
气动外形优化设计系统构建
 
本文的主要创新工作需要气动外形优化设计系统作为基础。优化算法、参数
化方法及气动特性评估方法是构成一套完整气动外形优化设计系统必不可少的
三个组成部分。此外，在基于梯度信息的优化设计系统中，往往还需使用伴随方
程求解方法。本章首先介绍了上述四类方法中的一些典型方法，然后基于介绍的
各种方法构建了三套不同用途的气动外形优化设计系统。
 
2.1  
优化算法
 
当前气动外形优化设计系统中主要应用的优化算法有两类—现代启发式算
法及基于目标函数梯度信息的优化算法。对于这两类算法，本节将各自介绍其中
的一种成熟算法。
 
2.1.1  
自适应局部增强微分进化算法
 
微分进化算法
(Differential Evolution algorithm, DE)
是 
Rainer Storn 
与 
Kenneth 
Price
[23]
于 
1995 
年发表的一种现代启发式算法。与其它常见的现代启发式算法类
似，
DE 
算法也需要设置一定规模的种群，通过变异、交叉操作对种群中的个体
进行更新进而实现全局寻优。假设优化问题是在 
n 
实数空间中寻找函数 f
(
x
) 
的
最小值，
DE 
算法的种群规模为 
NP 
，第G
 代种群交叉之后产生的第
i 
个候选个体
为
G,i
C 
，第 G
 代种群最终产生的第 
i 
个个体为
G,i
x 
，则基本 
DE 
算法的流程如图
2.1 
所示。流程图中的变异操作计算公式为：
 
( )
G,i G1,r1 G1,r2 G1,r3
MF
- - -
M
= 
x
+ 
x
- 
x 
              (2-1) 
其中，
G,i
M 
为第 G
 代种群产生的第 
i 
个变异个体，
MF 
为变异因子，
r1
、
r2 
、r
3
为区间
[1, NP]
中均匀分布的随机整数，且满足 r
1
¹
r2 
¹
r3。令
1 2
( , , , )
T
n
s
=
s s 
L
s 
为
一个 
n 
维实数数组，其每个元素均为
[0,1] 
区间均匀分布的随机数，则 
DE 
算法流
程图中的交叉操作计算公式为：
 
( )
( )
, ,
, ,
1, ,
G i j j
G i j
G i j j
M s CF
C
x s CF
-
ì £
ï
= 
í
ï
>
î
                   (2-2) 
其中，
G,i, j
C 
为第 G
 代中第 
i 
个交叉个体的第 
j 
个元素，
G,i, j
M 
为第 G
 代中第 
i 
个变
异个体的第 
j 
个元素，
G1,i, j
x
-
为第G
 
-
1代中第
i 
个个体的第 
j 
个元素，
CF 
Î
[0,1]
为交叉因子。从整个基本 
DE 
算法的流程可以看出，在基本 
DE 
算法中需要设置
的参数只有三个，即：种群规模 
NP 
，变异因子 
MF 
以及交叉因子C
F 。
 西北工业大学博士学位论文
 
14 
 
 
图 
2.1  
基本 
DE 
算法流程
 
赵光权
[110]
在基本 
DE 
算法的基础上引入局部增强搜索形成了局部增强微分
进化算法（
MPDE
），即：在每一代的变异、交叉操作全部结束之后，以一定的
概率 
LF ( 0 
<
LF 
<
1)在当代最优个体附近再产生少数个体进行局部搜索以加快
算法逼近全局最优解的速度。在当代最优个体附近产生新个体的计算公式为：
 
( )
, , , 1 , 2
/
G i G best G r G r
L
= 
x
+ 
x
- 
xG 
               (2-3) 
其中，
G,i
L 
为局部增强搜索产生的个体，用于取代
G,i
x 
；
G,best
x 
为第 G
 代中完成所
有变异、交叉操作之后的最优个体； 
r1
、 
r2 
为区间
[1, NP]
中均匀分布的随机整
数，且满足 r
1
¹
r2 
¹
i 。从局部增强搜索公式可以看出：随着优化代数的不断增
加，局部增强搜索在当代最优个体附近搜索得越精细。
 
为了使 
DE 
算法能够在保持种群多样性与快速收敛之间自动进行调节，黄仁
全
[111]
等人在局部增强搜索的基础上根据自适应遗传算法
[112]
提出了自适应局部
增强微分进化算法
(ADMPDE)
。这种算法可根据种群适应度动态地调整变异因子
MF 
以及交叉因子 C
F ，具体调整公式如下：
 
max max min max
min
( )( ) / ( ), ( )
, ( )
avg avg avg
avg
MF MF MF v v v v v v
MF
MF v v
ì- -¢
 - -¢ >
ï
= 
í
¢ £
ï
î
     (2-4) 
产生初始种群，
G=0
计算初始种群适应值
满足终止条件？
寻优结束，
输出最优解
Yse
G=G+1
，
i=0
No
变异，交叉产生
C
G,i
i=i+1
If(f(C
G,i
)<f(x 
G-1,i
))then
         x
G,i=
C
G,i
Else
         x
G,i=
x
G-1,i
i=NP
？
Yes
No第二章
  
气动外形优化设计系统构建
 
 
15
 
 
max max min max max
min
( )( ) / ( ), ( )
, ( )
avg avg
avg
CF CF CF v v v v v v
CF
CF v v
ì- - - - >
ï
= 
í
£
ï
î
       (2-5) 
其中，
max
MF 为变异因子上限，
min
MF 为变异因子下限；
max
CF 为交叉因子上限，
 
min
CF 为变异因子下限；
max
v 为当代种群中适应度的最大值，
avg
v 
为当代种群所
有个体适应度的均值，v
¢
为式
(2-1)
中
G
-
1,r2
x 
、
G
-
1,r3
x 
的适应度较大的那一个，
v 
为
式
(2-1)
中
G
-
1,r1
x 
的适应度。
 
文献
[111]
已经证明：
ADMPDE 
算法相对粒子群算法、
MPDE 
算法、基本 
DE
算法在收敛速度、全局寻优能力方面具有明显优势。
 
2.1.2  
基于黄金分割线性搜索的最速下降法
 
最速下降法
[15]
是最简单的基于梯度信息的优化搜索算法，对于极小值问题
( )
n
Min f x 
，
x
Î
R ，此方法每次让自变量 
x 
沿着 
-Ñ
f( x) 
的方向变化以搜索 
f( x)
的极小值。即：
 
1
( ) / ( )
k k k k
l
f f
+
x
= 
x
- Ñ
x 
Ñ
x 
                  (2-6) 
式中，
k
x 、
k 
+
1
x 分别为优化算法在第 k
 步与 
k 
+
1步的自变量向量， 
( )
k
Ñ
f x 为梯
度向量的模长，
l 
为自变量变化步长。
 
在最速下降法中，当自变量向量在
k
x 处的梯度确定之后，优化算法的寻优
效果完全由自变量的变化步长
l 
决定，此时目标函数的自变量实际上已经变成了
l 
，即 ( ) ( )
k
f 
=
f 
l
x
x 
。确定合适步长的方法有很多，本文采用的是黄金分割线性
搜索方法
[15]
。令
l 
的取值区间为
[ ]
1 1
a,b ， 
e >
0 为收敛标准，黄金分割法的计算
步骤如下：
 
1)  令 
i 
=
1 ，
1 1 1
0.382( )
i
s =
a 
+
b 
-
a ，
1 1 1
0.618( )
i
m =
a 
+
b 
-
a 。计算 ( )
k
i
f 
s
x
与
( )
k
i
f 
m
x
；
 
2)  若 
( ) ( )
k k
i i
f 
s >
f 
m
x x
则转到第 
3 
步；反之，若 ( ) ( )
k k
i i
f 
s £
f 
m
x x
则转到第 
4
步；
 
3)  若
i i
b 
-s £e 
则停止计算，输入
i
m 
。否则，令
i1 i
a 
s
+
= 
，
i1 i
b b
+
= 
，
i1 i
s m
+
=
，
1
( ) ( )
k k
i i
f 
s
f 
m
+
=
x x
，
1 1 1 1
0.618( )
i i i i
m
a b a
+ + + +
= + - 
，计算
1
( )
k
i
f 
m
x
+
，转到
第 
5 
步；
 
4)  若
i i
m -
a 
£e 
则停止计算，输出
i
a 。否则，令
i1 i
a a
+
= 
，
i1 i
b 
m
+
= 
，
i1 i
m s
+
=
，
1
( ) ( )
k k
i i
f 
m
f 
s
+
=
x x
，
1 1 1 1
0.382( )
i i i i
s
a b a
+ + + +
= + - 
，计算
1
( )
k
i
f 
s
x
+
，转到
第 
5 
步；
 
5)  i 
=
i 
+
1，转到第 
2 
步。
 
文献
[113]
采用基于黄金分割线性搜索的最速下降法进行了机翼及二维多段
翼型的优化，取得了较为满意的效果，证明此方法在气动外形优化设计中是较为西北工业大学博士学位论文
 
16 
 
实用的。
 
2.2  
几何外形参数化方法
 
目前气动外形设计中常用的参数化方法多达数十几种，其中有些方法仅适用
于对二维翼型进行参数化，有些方法则同时适用于对二维翼型、三维机翼乃至三
维整流包等部件进行参数化。本节将对常用的 
Hicks-Henne 
翼型参数化方法、
CST
翼型参数化方法及普适性很强的 
FFD 
参数化方法进行简单介绍。
 
2.2.1 Hicks-Henne 
翼型参数化方法
 
Hicks-Henne 
方法
[33]
是一种长期以来被广泛使用的基于解析函数叠加的翼型
参数化方法，
Hicks-Henne 
函数的解析表达式为：
 
( )
ln
(
0.5
)
/ln
( )
sin
i
tx
i
y x 
=p
x 
                    (2-7) 
该函数在二维平面中的图像为一个突出的鼓包，式中的
i
x 即为鼓包的最高点站位
，
t
控制鼓包的胖廋程度，图 
2.2 
展示了不同控制参数下 
Hicks-Henne 
鼓包的形状
。采用 
Hicks-Henne 
鼓包对翼型进行参数化的公式为：
 
( ) ( ) ( )
0
1
k
i i
i
y x y x a y x
=
= + 
å 
                     (2-8) 
其中， 
( )
0
y x 为基础翼型函数，
i
a 为第 
i 
个 
Hicks-Henne 
鼓包的叠加系数。
 
 
图
  2.2  
不同控制参数下 
Hicks-Henne 
鼓包形状对比
 
2.2.2 CST 
翼型参数化方法
 
CST 
参数化方法
[27]
是最近几年才兴起的一种翼型参数化方法，这种方法将
翼型的函数表示成如下式所示的一个类函数C
(
x
) 
与一个形函数 S
(
x
) 
的乘积。
 
( ) ( ) ( )
2
1
N
N
y x 
=
C x S x 
                     (2-9) 第二章
  
气动外形优化设计系统构建
 
 
17
 
 
其中类函数C
(
x
) 
的通用形式为：
 
( ) ( ) ( )
2
2 1
1
1 , 0 1
N N
N
N
C x 
=
x 
-
x 
£
x               (2-10) 
在实际应用中通常取
1
N 
=
0.5 ，
2
N 
=
1.0 。型函数 S
( 
x
) 
为
Bernstein 
多项式：
 
( )
( )
( )
!
1
! !
i
k i
i
k
S x x x
i k i
-
= -
-
               (2-11) 
其中 k
 为 
Bernstein 
多项式的阶数，通常也将其称为 
CST 
参数化方法的阶数。完
整的 
CST 
翼型参数化公式为：
 
( ) ( )
( )
0.5
( )
0
!
1 1
! !
k
i
k i
i
i
k
y x x x a x x x t
i k i
-
=
= - - + D
-
å 
          (2-12) 
式中，
D
t 为翼型后缘厚度，
i
a 为第 
i 
个 
CST 
函数的权重系数，当 k
 值确定之后通
过改变
i
a 的值即可得到不同的翼型。图 
2.3 
为 k
 
=
7 ， 
1
i
a 
= 
时
CST 
参数化方法中
的各个函数曲线，从图中可以看出 
CST 
函数的图像与 
Hicks-Henne 
函数的图像
类似，都是鼓包形的曲线。因此，在实际应用中也可以将 
CST 
参数化方法当作
解析函数叠加类的参数化方法使用，此时采用 
CST 
方法对翼型进行参数化的公
式为：
 
( ) ( ) ( )
( )
0.5
( )
0
0
!
1 1
! !
k
i
k i
i
i
k
y x y x a x x x x
i k i
-
=
= + - -
-
å 
          (2-13) 
   
(a)  
类函数曲线
                             (b)  
形函数曲线
 
 
(c) CST 
函数曲线
 
图 
2.3 CST 
参数方法中的各个函数曲线
 西北工业大学博士学位论文
 
18 
 
2.2.3 FFD 
参数化方法
 
自由变形参数化方法
(Free-Form  Deformation,  FFD)
最早由 
Sederberg 
和
Parry
[36]
于 
1986 
年提出。
FFD 
方法变形能力强，不仅可用于翼型、机翼的几何外
形参数化，也适用于对机身、翼身结合部等部位进行几何参数化，是一种全局性
与局部性兼备的气动外形参数化方法。采用 
FFD 
方法对气动外形进行参数化首
先需要建立一个由数个 
FFD 
控制点构成的、包围待变形物体或部位的控制框，
然后在控制框中构造一个局部坐标系
o
¢
- s,t,u ，并求出待变形物体中每个点在局
部坐标系中的坐标，具体计算公式为：
 
, ,
0 0 0
( , , ) ( ) ( ) ( )
l m n
i j k
l m n i j k
i j k
x s t u B s B t B u P
= = =
=é ù ×
ë û
ååå 
              (2-14) 
其中，
i, j,k
P 
为第 
( )
i, j,k 个 
FFD 
控制点在原始 
o- x, y, z 
坐标系中的坐标， 
l, m, n 分
别为
i, j,k 
三个方向上的 
FFD 
控制点数减 
1
， (
 )
i
l
B s 
为第 
i 
个 l
 阶 
Bernstein 
多项式
，其表达式为：
 
( )!
( ) (1 )
( )!( )!
i i l i
l
l
B s s s
i l i
-
= -
-
                  (2-15) 
( )
j
m
B t 
与 (
 )
k
n
B u 
的表示式与之形式上一致。当 
FFD 
控制点的位置发生变化之后，
待变形物体上任意一点的位置计算公式为：
 
, , , ,
0 0 0
( , , ) ( , , ) ( ) ( ) ( )
l m n
i j k
l m n i j k i j k
i j k
x s t u x s t u B s B t B u P P
= = =
+ D =é ù ×é + Dù
ë ûë û
ååå 
     (2-16) 
其中 
D
x(s,t,u) 
为待变形物体上点 
x(s,t,u) 
的位移，
i, j,k
D
P 
为第 
( )
i, j,k 个 
FFD 
控制
点的位移。从上述 
FFD 
参数化方法的原理可以看出，通过改变 
FFD 
控制点的位
置即可改变待变形物体的形状，即 
FFD 
控制点的坐标即为待变形物体的几何外
形控制参数。图 
2.5 
为将图 
2.4 
中的 
FFD 
控制点竖直方向的位移改变之后 
FFD
控制框内的翼型几何外形。
 
 
图 
2.4  
包围二维翼型的 
FFD 
控制框及框上的变形控制点
 
 
图 
2.5 FFD 
控制点位置变化之后 
FFD 
框所包围翼型的几何外形
 第二章
  
气动外形优化设计系统构建
 
 
19
 
 
2.3  
气动特性数值评估方法
 
不同的气动外形优化设计任务需要采用不同精度的气动特性数值评估方法
以达到设计精度与设计效率之间的良好平衡。本节将对本文中将要用到的几种精
度及计算效率各异的气动特性评估方法进行简要介绍。
 
2.3.1  
翼型亚音速气动特性快速评估程序 
X
foil 
Xfoil
[114]
是麻省理工学院的 
Mark Drela 
开发的亚音速翼型分析与设计开源程
序，其最早版本于 
1986 
年发布，目前最新的版本号为 
6.99
，源程序下载地址为
http://web.mit.edu/drela/Public/web/xfoil/
。
Xfoil 
通过面元法实现对翼型各项气动
特性数据的快速求解，在计算过程中 
Xfoil 
可以考虑粘性的作用，并通过
e
N 
转捩
判据
[115]
对层流的转捩进行预测。该程序甚至允许机翼后缘存在小范围的物面分
离，故其可以被用来评估翼型失速前的大迎角气动特性。通过引入卡门
-
钱压缩
性修正公式，
Xfoil 
可以较为准确的实现高亚音速工况下翼型的气动特性评估。
由于其快速、准确评估翼型亚音速气动特性的能力，外加其丰富的翼型设计功能
以及代码的开源性，使得 
Xfoil 
成为世界范围内最受欢迎的翼型评估与设计工具
之一。
 
以 
NACA-0012 
翼型低速工况下的表面压力分布求解为例实际检验 
Xfoil 
求
解翼型亚音速气动特性的能力。实验工况
[116]
为：马赫数 M
a 
=
0.15，雷诺数
6
Re 
=
2.88 
´
10 
。图 
2.6(a)
、
(b)
分别为迎角 
0
°、
10
°时计算所得的翼型表面压力
分布与实验结果的对比，其中实验只测量了翼型上表面的压力分布。从图中可以
看出，在两个迎角下 
Xfoil 
计算的表面压力分布均与实验结果吻合得相当好，证
明 
Xfoil 
对翼型亚音速气动特性的求解精度是比较高的。在此算例中，运行 
Xfoil
程序的为一台个人计算机，
CPU 
主频为 
3.40GHz
。在该计算机上，
Xfoil 
单线程
完成算例中一个点的计算只需不到 
0.1 
秒的时间，可见 
Xfoil 
的计算效率是非常
高的。
 西北工业大学博士学位论文
 
20 
 
   
(a)  
迎角 
0
°
                             (b)  
迎角 
10
°
 
图 
2.6 NACA-0012 
翼型表面压力分布计算结果与实验结果对比
 
2.3.2  
翼型跨音速气动特性快速评估方法
 
Xfoil 
只能用于对翼型的亚音速气动特性进行评估，故当涉及到对翼型的跨
音速气动特性进行快速评估时需要采用其它的方法。欧拉方程是对无粘流动最精
确的描述，故能被用于各种工况下的气动性能评估。然而，因为忽略了流体的粘
性，所以单纯求解欧拉方程得到的气动性能数据往往与实际结果存在较大偏差。
为此，本文采用耦合求解欧拉方程与可压缩附面层方程的方法
[117]
对翼型的跨音
速气动特性进行快速评估。所求解的欧拉方程具体形式为积分形式的二维欧拉方
程，可压缩附面层方程为著名的卡门动量积分关系式及边界层动能积分关系式。
文献
[117]
详细介绍了欧拉方程及附面层方程的具体求解方法，本文在此不再复
述。 
以
RAE-2822
翼型跨音速工况下的表面压力分布求解为例实际检验方法求解
翼型跨音速气动特性的可信度。实验工况
[118]
为：马赫数 M
a 
=
0.75，雷诺数
6
Re 
=
6.2 
´
10 
，迎角
a =
2.71
°
。图 
2.7 
为计算所得翼型表面压力分布与实验结果
的对比。从图中可以看出：计算结果的激波略强于实验结果的激波强度，导致计
算结果中激波前后的压差比实验结果大；计算结果的激波位置与实验结果较为吻
合。总体来看，计算结果与实验结果比较吻合。需要特别指出的是：在完成上一
小节算例相同的计算机上单线程完成本算例只需不到 
3 
秒的时间，所以其计算效
率非常高。
 第二章
  
气动外形优化设计系统构建
 
 
21
 
 
   
图 
2.7 RAE-2822 
翼型表面压力分布计算结果与实验结果对比
 
2.3.3  
三维构型气动特性快速评估方法
 
本文通过耦合求解全速势方程与附面层方程的方法来实现对三维构型气动
特性的快速评估。所求解的全速势方程为曲线坐标系
(
x 
，
h
，
V
)
下的定常连续方
程：
 
0
u v w
J J J
r r r
x h V
¶ æ ö¶ æ ö¶ æ ö
+ + =
ç ÷ ç ÷ ç ÷
¶ è
 ø¶
 è
 ø¶
 è
 ø
                (2-17) 
式中，
r
为相对密度， 
J 
为雅克比变换，
u 
、
v 
、 
w 
为相对速度矢量的三个分量
，它们与速度势
F 
之间的关系为：
 
x y z 
x x x
u
v
x y z y y y
w
x y z z z z
x x x 
x h V
x
h h h x h V
h
V V V x h V
V
¶ ¶ ¶ 
¶ ¶ ¶
æ ¶Fö
ç ÷
¶ ¶ ¶ 
¶ ¶ ¶
¶
æ ö
ç ÷
ç ÷
¶ ¶ ¶ ¶ ¶ ¶ç ¶F÷
=
ç ÷
ç ÷
¶ ¶ ¶ ¶ ¶ ¶ ¶
ç ÷ 
ç ÷
è ø
¶ ¶ ¶ ¶ ¶ ¶ ç¶F ÷
ç ÷
¶ ¶ ¶ ¶ ¶ ¶ 
è
¶ 
ø
              (2-18) 
雅克比变换 
J 
的计算公式为：
 
1 / det
x y z
x y z
J
x y z
x x x
h h h
V V V
¶ ¶ ¶
¶ ¶ ¶
¶ ¶ ¶
=
¶ ¶ ¶
¶ ¶ ¶
¶ ¶ ¶
                       (2-19) 
为了求解出速度势，首先采用有限差分法对方程
(2-17)
进行离散，并依据西北工业大学博士学位论文
 
22 
 
Osher 
方法
[119]
引进人工粘性，最后通过牛顿线性迭代
[120]
对离散后的方程进行求
解。
 
所求解的附面层方程有三个，分别为微分形式的连续方程：
 
2 1 1 2
( uhsin ) ( whsin ) ( vh hsin ) 0
x z y
r q r q r q
¶ ¶ ¶
+ + =
¶ ¶ ¶
           (2-20) 
以及两个微分形式的动量方程：
 
___
2 2
1 2 12
1 2
_____
2
12
/ tan / sin
1 1
( ' ')
sinsin tan
u u w u u
v k u k w k uw
h x h z y
p p u
u v
hx h z y y
r r r r q r q r
m r
qq q
¶ ¶ ¶
+ + - + +
¶ ¶ ¶
¶ ¶ ¶ ¶
= - + + -
¶ ¶ ¶ ¶
       (2-21) 
___
2 2
2 1 21
1 2
_____
2
1 2
/ tan / sin
1 1
( ' ')
sin tan sin
u w w w w
v k w k u k uw
h x h z y
p p w
w v
h x hz y y
r r r r q r q r
m r
q q q
¶ ¶ ¶
+ + - + +
¶ ¶ ¶
¶ ¶ ¶ ¶
= - + + -
¶ ¶ ¶ ¶
      (2-22) 
其中
___ ____
r
v 
=r
v 
+r
' v'
。
 
上述三个方程建立在如下的坐标系上： 
y 
坐标垂直物面， 
x
与 
z 
坐标在物面
上且互相不正交。方程中的
q 
即为当地 
x
坐标与 
z 
坐标之间的夹角，
u
、
v 
、
w 
分
别为沿 
x
、 
y 
、 
z 
三个方向的速度分量，
r
为密度， 
p 
为压力，
m
为动力粘性系
数。
1 1
h 
= ¶
s/ 
¶
x ，
2 2
h 
= ¶
s/ 
¶
z 为度量系数，
1
s 、
2
s 分别为沿 
x 
轴、
z 
轴的弧长。
1
k
，
2
k ，
12
k ，
21
k 为坐标线 
x 
=
const 
、 
z 
=
const 
的特征曲率，计算公式分别为：
 
( ) 
1
1 2
1 2
1
cos
sin
h
k h
h h x z
q
q
é¶ ¶ ù
= -
ê ú
ë¶
 ¶ û
                (2-23) 
( ) 
2
2 1
1 2
1
cos
sin
h
k h
h h z x
q
q
é¶ ¶ ù
= -
ê ú
ë¶
 ¶ û
                (2-24) 
12 2 1
2 1
1 1 1
cos
sin
k k k
h z h x
q q
q
q
é æ ¶
ö æ ¶öù
= 
ê ç
+ 
÷
- 
ç
+ 
÷ú
¶ ¶
ëè ø è øû
            (2-25) 
21 1 2
1 2
1 1 1
cos
sin
k k k
h x h z
q q
q
q
é æ ¶
ö æ ¶öù
= 
ê ç
+ 
÷
- 
ç
+ 
÷ú
¶ ¶
ëè ø è øû
            (2-26) 
为封闭由方程
(2-21)
、
(2-22)  
、
(2-23)
组成的方程组，引入涡粘性
m
e 
，并将
其与雷诺剪切应力、平均速度型通过下面两个关系式联系起来
 第二章
  
气动外形优化设计系统构建
 
 
23
 
 
_____
' '
m
u
u v
y
r re
¶
- =
¶
                        (2-27) 
_____
m
w
ρ
w'v' 
ρε
y
¶
- =
¶
                        (2-28) 
附面层方程的求解方法为追赶法
[121,122]
，而速度势方程与边界方程的耦合求
解方法为三维混合流动准同步方法
[123]
。
 
以 
DPW 5
[124]
翼身组合体风洞实验标模的流场数值模拟对上述计算方法的可
信度进行检验。图 
2.8 
为 
DPW  5 
翼身组合体几何外形示意图，风洞实验状状态
为：马赫数 M
a 
=
0.85，雷诺数 
6
Re 
=
5.0 
´
10 
，升力系数 C
l 
=
0.5 。
DPW 
组委会
并未给出C
l 
=
0.5时的表面压力分布，而是给出了
Cl 
=
0.485与
Cl 
=
0.519 时的表
面压力分布。推测其中可能的原因是机翼的展弦比较大，后掠角也较大，风洞实
验中机翼翼尖的扭转变形较为明显。图 
2.9(a)
、
(b)
、
(c)
、
(d)
为机翼展向四个不同
位置截面表面压力分布的计算结果与实验结果的对比。从图中可以看出：内翼段
两截面在不同升力系数下的实验压力分布变化不大，计算结果与实验结果较为吻
合；而中外翼段两截面在不同升力系数下的实验压力分布变化较大，计算结果与
实验结果的吻合度也不如内翼段的两个截面。从 
DPW 
组委会发布的全球 
22 
机
构
/
组织给出的 
55 
组计算结果来看，本文程序计算所得的四个截面压力分布形态
与各种 
RANS 
方程求解器计算的结果是非常相似的。该算例说明，本文所采用
的基于求解全速势方程与附面层方程的三维构型气动特性快速评估方法是能够
捕捉到飞行器绕流流场主要特征的。
 
 
图 
2.8 DPW 5 
翼身组合体风洞实验标模
 
  
(a) 13.06%
展向截面压力分布
               (b) 28.28%
展向截面压力分布
 西北工业大学博士学位论文
 
24 
 
  
(c) 50.24%
展向截面压力分布
               (d) 72.68%
展向截面压力分布
 
图 
2.9 
全速势方程
+
边界层方程求解器计算的 
DPW 5 
机翼表面压力分布与实验结果对比
 
2.3.4 RANS 
方程求解器
 
本文作者所在团队开发的基于求解 
RANS 
方程的高精度气动特性评估程序
[113]
求解的主控方程为笛卡尔坐标系下积分形式的 
RANS 
方程
 
( ) ( ) 0
S S
d V nd S nd S
t
W
¶
+ · - · =
¶
òòò 
Q
òò 
F Q
òò 
G Q
r r
            (2-29) 
其中，
W 
为控制体，S
 为为控制体的边界，
n
r
为控制边界的当地外法线向量，
Q
为守恒变量，
F(Q) 
为无粘通量，
G(Q) 
为粘性通量，这三个向量的具体内容可参
考文献
[125]
。为封闭方程需要引入理想气体状态方程以及湍流模型，程序中采
用的湍流模型为一方程的 
S-A 
模型
[126]
。该模型计算相对简单，对于航空航天领
域中附着的乃至包含小范围分离的低速流动、跨音速流动均具有较高的模拟精度
[126,127]
，故获得了广泛的应用。控制方程的离散格式为 
Roe 
格式
[128]
，时间推进
方式为线性化的向后欧拉时间差分格式
[129]
。
 
仍然以 
DPW 5 
翼身组合体风洞实验标模的流场数值模拟对上述 
RANS 
方程
求解方法的可信度进行检验。图 
2.10 
为计算构型的表面网格示意图，构型的全
流场网格单元数为 
800 
万。图 
2.11(a)
、
(b)
、
(c)
、
(d)
分别为机翼展向四个不同位
置截面表面压力分布计算结果与实验结果的对比，图中除了给出 
RANS 
方程求
解器的计算结果与实验结果之外，还给出了全速势方程
+
附面层方程求解器的计
算结果，以对比两种求解器的计算精度。从图中可以看出：在内侧的三个截面上
，相对于全速势方程
+
附面层方程求解器的计算结果，
RANS 
方程求解器计算所
得压力分布与实验结果吻合得更好，尤其是对激波位置与形态的捕捉较为准确；
而在最外面一个截面上，
RANS 
方程求解器计算所得压力分布仍然与实验结果偏
差较大，导致这种现象的原因同样很可能是实验中模型的翼尖扭转变形。综合来
看，此算例证明本文所采用的 
RANS 
方程求解器是比较可靠的，同时也证明本
文所采用的 
RANS 
方程求解器的精度要高于本文所采用的全速势方程
+
附面层方
程求解器的精度。
 第二章
  
气动外形优化设计系统构建
 
 
25
 
 
 
图 
2.10 DPW 5 
翼身组合体表面网格示意图
 
 
(a) 13.06%
展向截面压力分布
               (b) 28.28%
展向截面压力分布
 
  
(c) 50.24%
展向截面压力分布
               (d) 72.68%
展向截面压力分布
 
图 
2.11  
两种求解器计算的 
DPW 5 
机翼表面压力分布与实验结果的对比
 
2.4  
代理模型方法及代理模型管理框架
 
在基于现代启发式算法与高精度气动特性评估方法的气动外形优化系统中
往往需要使用代理模型方法代替气动特性评估方法来完成绝大部分的气动特性
评估工作，否则整个优化系统的计算效率将变得难以接受。作为很多工程领域中
常用的一种代理模型，
Kriging 
代理模型除了能给出预测结果外还能给出预测结
果的方差用以评估预测结果的可信度。在气动优化系统中使用代理模型的同时最
好使用代理模型管理框架对代理模型进行管理，以保证代理模型的精度能够适应
优化过程的发展。
 西北工业大学博士学位论文
 
26 
 
2.4.1 Kriging 
代理模型
 
Kiring 
代理模型
[49]
最早由南非地质学家 
Danie Krige 
于上世纪 
50 
年代提出，
其构造原理如下：假设
( )
{ ,1 }
i n
x
Î
R 
£
i 
£
N 是 
N 
个样本的输入参数向量集合，向
量
1 2
[ ]
N
y y y
T
Y
= , ,× × ×, 
中的第 
i 
个元素为与 
(i)
x 
对应的样本输出参数。
Kriging 
代理
模型假设样本的输入参数向量 
x 
与输出参数 
y 
之间存在如下形式的函数关系：
 
y( x) 
=
f( x) 
+
Z( x)                       (2-30) 
其中， 
f( x) 
为一个确定的回归模型，
Z( x) 
为高斯过程，其期望为 
0
，方差为
2
z
s
，协方差为：
 
( ) ( ) 2 ( ) ( )
Cov( ( ), ( )) ( , )
i j i j
z
Z xZ x
=s
R x x                (2-31) 
R 
为任意两个样本的输入参数之间的相关函数，其定义为：
 
( ) ( ) ( ) ( )
2
( ) ( ) ( ) ( )
1
( , ) exp ( , )
( , )
i j i j
n
i j i j
k k k
k
R d
d 
q
x x
=
ì 
= -
ï
í
ï=
 -
î
å
x x x x
x x
                 (2-32) 
(i)
k
x 与
( j)
k
x 分别为 
x
(i) 
与 
x
( j) 
的第 k
 个元素，
( ) ( )
( , )
i j
d x x 
为点 
x
(i) 
与
( j)
x
之间带权
重的距离函数，
k
q 
为第k
 个输入参数变量的距离权重。所有 
n 
个输入参数变量的
距离权重组成权值向量 
[ ]
1 2
, , ,
T
n
θ 
=
q q × × ×q 
，则构建 
Kriging 
代理模型的关键就在
于求解出
θ
。通过最大似然估计可将求解
θ
的问题转化为求解如下一个带约束的
最小值问题：
 
[ ]
1/ 
2
1 2
1
: ( ) ( ) ( )
, , , , . . ( 0)
n
Tn
n k
k
Min
s t
j s
q q q q
=
ì
=
ï
í
ï× × × ³
î
θ 
R 
θ θ
θ 
=
            (2-33) 
式中， 
R(
θ
) 
为 
N 
´
N 
的方阵，其第
i 
行、 
j 
列上的元素为 
( ) ( )
( , )
i j
R x x 
，
2
s
(
θ
) 
为
方差估计值，其估算公式为：
 
2 1
1
1
1
ˆ ˆ
( ) ( ) ( ) ( )
( )
ˆ
( )
N
s b b
b
T -
T -
T -
ì
= - -
ï
ï
í
ï
=
ï
î
θ 
Y I R 
θ 
Y I
I R 
θ 
Y
I R 
θ 
I
          (2-34) 
当求得
θ
向量之后，对于任意一个新的输入参数向量 
x 
，其对应输出 
y 
的预
测公式为：
 第二章
  
气动外形优化设计系统构建
 
 
27
 
 
1
(1) (2) ( )
ˆ ˆ
( ) ( ) ( )
( ) ( , ), ( , ), , ( , )
T
T
N
y
R R R
b b
-
ì 
= + -
ï
í
ï
=é
 ×
× ×ù
îë û
r x R 
θ 
Y I
r x x x x x x x
        (2-35) 
由上式所预测的 
y 
的方差估算公式为
 
2 1
1 ( ) ( ) ( )
T
z
s s
-
= - 
r x R 
θ 
r x                  (2-36) 
求解式
(2-33)
的方法有很多，本文采用 
2.1.1 
小节中介绍的 
ADMPDE 
算法进行求
解。
 
以下通过对二维翼型在跨音速工况下的阻力系数预测实际检验基于
ADMPDE 
算法的 
Kriging 
代理模型构建策略所构建的代理模型在飞行器优化系
统中的预测精度。将 
RAE-2822 
作为基准翼型，采用图 
2.4 
中的 
FFD 
控制点对翼
型进行参数化。参数化过程中只改变除两端四个 
FFD 
控制点之外的另外 
12 
个
FFD 
控制点竖直方向的坐标，水平方向的坐标保持不变，即控制翼型几何外形的
参数只有 
12 
个。让选定的 
12 
个几何外形参数在给定的区间内随机变化，生成
250 
个外形各异的翼型。然后通过 
RANS 
方程求解器计算出所有翼型在指定状态
下的阻力系数。这里，指定的计算状态为：马赫数 M
a 
=
0.729 ，雷诺数
6
Re 
=
6.5 
´
10 
，升力系数 C
l 
=
0.65。将前 
200 
个翼型的几何外形参数及阻力系数
作为构建代理模型的样本，而将剩下的 
50 
个翼型的几何外形参数与阻力系数作
为测试代理模型的测试样本。图 
2.12 
为构建代理模型的 
200 
个样本的阻力系数
分布，从图中可以看出，构建代理模型的样本阻力系数分布区间长度达到了将近
60counts(1count=0.0001)
。这间接说明跨音速工况下翼型的气动特性与几何外形
之间的潜在关系是比较复杂的。在求解 
Kriging 
代理模型中的
θ 
向量时，
ADMPDE
算法的各个参数设置如下：种群规模为 
60
，优化代数为 
100
，交叉因子上限为
0.1
、下限为 
0.9
，变异因子上限为 
0.1
、下限为 
0.9
。图 
2.13 
为所构建的 
Kriging
代理模型对 
50 
个测试样本阻力系数的预测值与 
RANS 
方程求解器计算结果的对
比。从图中可以看出：代理模型的预测结果总体上与计算结果吻合得比较好，尤
其是对测试点阻力系数之间的大小关系捕捉得较为准确，这对优化算法来说是至
关重要的。虽然在预测的 
50 
个阻力系数中误差最大的达到了 
8.63counts
（图中
黑色圆圈所示测试点），但这也并没有改变该点阻力系数与其附近测试点阻力系
数之间的大小关系。此算例说明，本文采用的基于 
ADMPDE 
算法的 
Kriging 
代
理模型构建策略可以在潜在的输入输出函数关系较为复杂的情况下构建出适用
于优化的代理模型。
 西北工业大学博士学位论文
 
28 
 
 
图 
2.12 
构建代理模型的 
200 
个样本阻力系数分布
 
 
图 
2.13 
代理模型预测结果与 
RANS 
求解器计算结果对比
 
2.4.2  
代理模型管理框架
 
代理模型管理框架分为松散式管理框架与紧密式管理框架两种
[52]
。松散式
代理模型管理框架管理代理模型的基本过程为：利用一定数量的初始样本构建初
始的代理模型，然后将其用于优化过程中对目标特性的评估。当优化过程收敛之
后会得到一个最优解，但这个最优解对应的目标值是代理模型预测的，与真实值
之间存在一定误差。为此采用高精度求解器对其进行校核，将校核之后的最优解
加入到样本集中并更新代理模型，然后采用新的代理模型再进行一轮优化。重复
上述过程，直到满足一定的收敛条件。紧密式代理模型管理框架的基本过程为：
利用一定数量的初始样本构建初始的代理模型，然后将其用于优化过程中对目标
特性的评估。在优化过程中，根据一定的准则从优化算法每一代的个体中挑选少
量个体采用高精度求解器计算其真值，然后加入到样本集中并更新代理模型。这
样在预测优化算法的下一代个体适应值之前代理模型就已经得到了更新，而无须
等到整个优化过程收敛。
 
本文在基于 
Kriging 
代理模型的优化系统中采用紧密式代理模型管理框架对
代理模型进行更新。挑选校核个体的准则为：优化算法每代适应值最大及预测方
差最大的个体。在上一小节验证算例中所构建代理模型的基础上对本文采用的代
理模型管理框架进行检验。具体检验方法为：采用 
ADMPDE 
算法对 
RAE-2822第二章
  
气动外形优化设计系统构建
 
 
29
 
 
进行计算状态的阻力最小外形优化，优化过程中的目标特性评估方法采用上一小
节验证算例中构建的 
Kriging 
代理模型，而代理模型管理框架则采用紧密式代理
模型管理框架。优化算法中的各个参数设置如下：种群规模为 
50
，优化代数为
50
，交叉因子上限为 
0.1
、下限为 
0.9
，变异因子上限为 
0.1
、下限为 
0.9
。图 
2.14
为优化 
50 
代后更新的 
Kriging 
代理模型对上一小节验证算例中 
50 
个测试样本阻
力系数的预测结果与 
RANS 
方程求解器计算结果及原始 
Kriging 
代理模型预测结
果的对比。从图中可以看出：经过代理模型管理框架有选择性地增加样本数量后
，
Kriging 
代理模型的预测精度显著提高，对 
50 
个测试样本阻力系数预测的最大
误差由初始的 
8.63counts 
减小到 
3.39counts
，并且测试点阻力系数之间的大小关
系也捕捉得更为准确。此算例说明，本文采用的紧密式代理模型管理框架能够在
优化过程中有效的提升代理模型的预测精度。
 
 
图 
2.14 
采用紧密式代理模型管理框架更新后的 
Kriging 
代理模型对测试点阻力系数的预测结
果与 
RANS 
方程求解器计算结果及原始 
Kriging 
代理模型预测结果的对比
 
2.5 
离散伴随方程求解器
 
在基于梯度信息的气动外形优化系统中，通常通过求解伴随方程的方法获得
梯度信息。伴随方程具体又分为连续伴随方程与离散伴随方程两种，本文作者所
在团队开发的离散伴随方程求解器
[113]
所求解的主控方程为：
 
0
T
¶
f 
é ¶ù
+ =
ê ú
¶ ¶
ë û
R
Q Q
L 
                  (2-37) 
其中， 
f 
为目标函数，
Q 
为 
RANS 
方程中的守恒变量， 
R
为离散 
RANS 
方程收
敛之后的残差， 
L 
为拉格朗日因子。
¶
f/ 
¶
Q 
可通过流场变量与目标函数的积分
关系式得到，
¶
R/ 
¶
Q 
可从 
RANS 
方程最终的求解结果得到。因此，伴随方程
(2-37)
实际需要求解的只有拉格朗日因子 
L 
，方程的具体求解方法可参考文献
[113]
。
当 
L 
求出之后将其代入下式即可求得目标函数对设计变量的梯度。
 西北工业大学博士学位论文
 
30 
 
T T
T T
L f f
ì ü ì ü
¶ ï¶ é¶ ù¶ ï ï¶ é¶ ù é¶ ùï
= 
í
+ 
ý
+ 
í
+ 
ý
ê ú ê ú ê ú
¶ ¶ ë
¶ û
¶ ¶ ë
¶ û
 ë¶
 û
ï
î
ï
þ
ï
î
ï
þ
X R X R
Λ
D D D X D D X
         (2-38) 
其中， 
D
设计变量， 
L 
为增加了拉格朗日因子后的目标函数， 
X 
为空间网格坐
标。
¶
f/ 
¶
D 
、
¶
X/ 
¶
D 、
¶
R/ 
¶
D、
¶
f/ 
¶
X 
、
¶
X/ 
¶
D 、
¶
R/ 
¶
X 的求解方法可参
考文献
[130]
。
 
下面通过一个简单算例检验本文所使用的离散伴随方程求解器求解梯度的
准确性。计算对象为 
RAE-2822 
翼型，计算状态为：马赫数 M
a 
=
0.72 ，雷诺数
6
Re 
=
5.4 
´
10 
，迎角
a =
2.8 
°
。采用图 
2.4 
中的 
FFD 
控制点对翼型进行参数化，
参数化过程中只改变除两端四个 
FFD 
控制点之外 
12 
个 
FFD 
控制点竖直方向的
坐标，水平方向的坐标保持不变，即控制翼型几何外形的参数只有 
12 
个。分别
采用离散伴随方程求解器及差分方法求解阻力系数对所有 
12 
个 
FFD 
控制点的偏
导数。在差分方法中，对每个设计变量的扰动步长设定为 
5
1 10
-
´ 
c 
， 
c 
为翼型的
参考弦长。两种方法计算结果的对比如图 
2.15 
所示，从图中可以看出，两种方
法得到的气动力系数对每个设计变量的偏导数基本相当，故两种方法得到的梯度
方向也基本一致。实际上，根据向量内积公式计算得到的两梯度向量之间的夹角
为 
2.4315
°，进一步证明了两种方法求得的梯度向量方向基本是一致的。此算例
说明本文所采用的伴随方程求解器是可靠的。
 
 
图 
2.15 
不同求解方法得到的 
RAE-2822 
翼型阻力系数对几何外形参数的偏导数对比
 
2.6  
不同用途的气动外形优化设计系统构建
 
基于本章前 
5 
节介绍的各种方法，本节将构建三套不同用途的气动外形优化
设计系统。
 
2.6.1  
基于气动力直接求解的全局型优化系统
 
在气动优化设计中，人们总是希望尽可能地获得全局最优解。为此，气动优
化设计系统必须基于全局型优化算法构建。本小节基于 
ADMPDE 
算法构建了一第二章
  
气动外形优化设计系统构建
 
 
31
 
 
套全局型气动外形优化设计系统，此系统在优化过程中的气动力通过求解器直接
获取。根据实际情况，具体可采用的气动力求解器包括：
XFoil
、翼型跨音速气
动特性快速评估程序或者三维构型气动特性快速评估程序。系统中的参数化方法
可采用 
2.2 
节中所介绍的三种参数化方法中的任何一种。图 
2.16 
为此优化系统的
流程图。
 
此系统适用于对二维翼型以及三维气动外形进行面向全局最优的初步设计，
以确定全局最优气动外形的大致范围，后续即可采用基于高精度气动求解器的优
化系统在其基础上进行更精细的优化设计。本文后续章节有关算例对此系统的性
能进行了检验。
 
 
图
  2.16  
基于气动力直接求解的全局型优化系统流程
 
2.6.2 
基于代理模型的全局型优化系统
 
在上一小节构建的基于气动力直接求解的全局型优化系统中，气动力求解程
序的精度不高，故不适用于面向全局最优的高精度气动外形设计。如果在系统中
直接使用高精度气动力求解器，则计算效率难以承受。为此，本小节构建了一套
基于代理模型的全局型气动外形优化系统。此系统中的优化算法仍然为
ADMPDE 
算法，参数化方法同样可采用 
2.2 
节中所介绍的三种参数化方法中的
任何一种。但在优化过程中，目标气动特性并不由求解器直接求解，而是采用
Kriging 
代理模型进行预测。构建 
Kriging 
代理模型所需样本的气动特性采用
RANS 
方程求解器进行求解，以保证系统的设计精度。当然，在计算资源特别有
限的情况下也可以采用 
2.3 
节中介绍的各种气动特性快速评估方法。优化过程中
Kriging 
代理模型由紧密式代理模型管理框架进行管理。图 
2.17 
为此优化系统的
流程图。
 
因构建代理模型所需的样本数量会随着设计参数的增加而急剧增加，所以此
系统适用于设计参数不太多时面向全局最优的高精度气动外形优化。当然，在计
算资源特别有限时也可用于面向全局最优的气动外形初步设计。此系统的性能在
本文后续章节有关算例中得到了检验。
 
产生初
始种群
求解初始种
群对应的气
动特性
输出当代种群中气动性能最优个体
Yse
更新种群
参数化方法生
成初始种群对
应的气动外形
产生变异、
交叉个体
求解变异、交
叉个体对应的
气动特性
参数化方法生成
变异、交叉个体
对应的气动外形
优化是否收敛，或已达到最大寻优代数
?
No西北工业大学博士学位论文
 
32 
 
 
图
  2.17  
基于代理模型的全局型优化系统流程
 
2.6.3 
基于梯度信息的优化系统
 
当设计参数较多且需要进行高精度气动外形设计时，基于代理模型的全局型
优化设计系统也将变得不实用。为此，本小节构建了一套基于梯度信息的高精度
气动外形优化设计系统。此系统的优化算法为基于黄金分割线性搜索的最速下降
法，参数化方法为 
FFD 
几何外形参数化方法，优化过程中的气动力由 
RANS 
方
程求解器求解，梯度信息由离散伴随方程求解器求解。图 
2.18 
为此优化系统的
流程图。
 
因为最速下降法属于局部最优性质的优化算法，故此系统适用于面向局部最
优的精细气动外形优化设计。因梯度信息的获取只需进行一次与流场求解计算量
相当的伴随场求解，故此系统对计算资源的要求与设计变量的个数无关，适合于
设计变量较多时使用。本文后续章节有关算例对此系统的性能进行了检验。
 
 
图
  2.18  
基于代理模型的全局型优化系统流程
 
  
产生初
始种群
预测初始种
群对应的气
动特性
产生变异、
交叉个体
预测变异、交
叉个体对应的
气动特性
输出当代种
群中气动性
能最优个体
更新
种群
优化是否收
敛，或已达到
最大寻优代数
?
Yes
更新代
理模型
No
初始
构型
求解
RANS
方
程获取流场
及气动性能
求解共轭方程
获取梯度信息
优化是否收敛 输出最后构型
Yse
根据梯度信息
调整几何参数
No
参数化方法
生成新构型第三章
  
数据降维方法研究及发展
 
 
33
 
 
第三章
  
数据降维方法研究及发展
 
从数据降维之后信息保留多少的角度可将数据降维的目的分为两大类：一、
数据分类及特征识别；二、高维数据的低维近似表达。在数据分类及特征识别中
，降维之后的数据往往只需保留原始高维数据某一方面或某些方面的特征；但在
高维数据的低维近似表达中，通常要求降维之后的数据尽可能多地保留原始高维
数据所包含的信息。数据降维的目的不同，所需用到的降维方法也不同。本文进
行数据降维的目的是为了将高维空间中的数据较为精确地映射到低维空间以提
升飞行器气动外形设计的效率，故本文所涉及到的数据降维方法主要适用于高维
数据的低维近似表达，当然有些也可以用于数据分类及特征识别。
 
高维空间中的数据可以较为精确的在低维空间中进行近似描述的一个重要
前提是高维空间数据的本征维度
(Intrinsic  dimension)
要小于高维空间的维度。这
里的本征维度是数据降维理论中一个非常重要的基本概念，它在主观上较为容易
理解，但却难以给出确切的、普适的定义。本章将首先解释本征维度的概念，然
后分别对线性降维方法中的 
POD
、
SVD 
方法及非线性降维方法中的 
ISOMAP 
方
法进行研究与发展。
 
3.1 
本征维度的概念及定义
 
从字面上理解，本征维度即为最能体现数据基本特征的维度。然而，从不同
的角度去观察同一个数据集合，很可能看到的基本特征是不同的，即本征维度是
一个强烈受主观因素影响的概念。在严谨的数学学科里这种现象显然是难以容忍
的，所以长久以来数学家们从未停止过对本征维度确切概念的探讨。目前适用性
最广、最为人们所接受的本征维度的概念都是基于流形定义的。
 
3.1.1  
流形的概念及定义
 
满足如下条件的 
Hausdorff 
空间
M 
称为d
 维流形：对于
M 
中的任意一点 
p 
，
存在 
p 
的一个开邻域
U 
与d
 维欧式空间
R
d 
中的一个开子集同胚
[131]
。对于初次接
触流形的人来说，上述流形的严格数学定义显得不太直观，一个常用的、非常有
助于直观理解流形定义的例子为：一个光滑的球面（注意不是球体）即为嵌入在
三维空间中的二维流形。因为在光滑球面上我们可以建立类似地球仪上经纬度一
样的坐标系，这样球面上的任意一点（除两个极点）均对应一个确切的二维坐标
。与之类似，一条光滑的二维曲线可以看作是嵌入在二维空间中的一维流形，因
为我们可以沿着这条曲线建立一个曲线坐标系，在该坐标系下曲线上任意一点均
有一个确定的一维坐标值。作为曲线、曲面的特殊情况，直线、平面以及超平面西北工业大学博士学位论文
 
34 
 
均可以看作是嵌入在高维空间中的低维流形。
 
3.1.2  
本征维度的概念及定义
 
目前最为学术界所接受的本征维度定义为：一组高维数据如果位于一个低维
的流形上，则此流形的维度即为这组高维数据的本征维度
[132]
。然而上述定义在
实际使用中仍然强烈受到主观因素的影响。参考文献
  [133]
中给出了如下一个关
于一组给定数据的本征维度难以确定的例子：如图 
3.1(a)
所示，三维空间中存在
一组数据点（红色圆点），这些点刚好分布在一个二维平面上。按照前述本征维
度的定义，可以认为这组数据点的本征维度为 
2
。然而，如图 
3.1(b)
所示，我们
可以用这组数据点插值出一条样条线，按照流形的定义，这条样条线为嵌入在三
维空间（或二维空间）中的一维流形，故由此又可以认为这组数据点的本征维度
为 
1
。
 
   
     (a)  
本征维度为二维
                             (b)  
本征维度为一维
 
图 
3.1  
本征维度不定举例
 
对于图 
3.1 
中的数据散点，虽然难以给出一个严格的本征维度，但从方便数
据处理的角度来说通常认为其本征维度为 
2
。毕竟在图 
3.1(b)
中的样条线上建立
曲线坐标系再求得这些散点在该曲线坐标系下的坐标值比较麻烦。因此，在大量
的实际应用中本征维度被不成文的默认为：对一组观测数据较为方便地进行数学
建模所需的最少独立变量的个数。
 
3.2 
典型线性数据降维方法
 
线性化的方法具有计算简单、易于理解等优点，因而在数学的各个分支中存
在大量的线性化计算方法，在数据降维领域中亦是如此。典型的线性数据降维方
法包括 
POD 
方法、
SVD 
方法、
  
投影追踪方法、多维尺度变换方法、因子分析
方法等，其中 
POD 
方法与 
SVD 
方法在高维数据的低维近似表达中最为常用。
 第三章
  
数据降维方法研究及发展
 
 
35
 
 
3.2.1 POD 
方法及其基本性质
 
POD 
方法由 
Hotelling
[134]
于 
1933 
年首先正式提出，在不同的学科领域中 
POD
方法的名称不同，在统计学中其被称为主成分分析
(Principle Component Analysis, 
PCA)
[135]
，在信号处理中其被称为 
K-L(Karhunen  Loeve)
变换
[136]
。站在不同的学
科角度直接感受到的 
POD 
方法的原理也是不同的。从统计学的角度来说，
POD
方法的基本原理是：利用一组数据的线性组合来尽可能地描述这组数据的方差结
构；从线性代数与几何学的角度来说，
POD 
方法的基本原理是：为高维空间中
的一组向量张成的空间寻找一组新的基，使得原始向量在这组基的少数维度上的
投影尽可能地大。因为几何意义明确，第二种原理理解起来更为直观、容易。下
面用一个简单的例子对 
POD 
方法的几何意义进行说明。如图 
3.2(a)
所示，有一
组二维数据点近似呈带状分布在二维 
X 
、 
Y 
直角坐标平面上，对这组数据实施
POD 
操作将会在这些数据点的中心位置建立一个新的二维直角坐标系 
X
¢ 
、 
Y
¢ 
。
在这个新坐标系下，绝大部分数据点在 
X
¢
坐标轴上的投影要远远大于其在 
Y
¢
坐
标轴上的投影，故将 
X
¢
坐标轴称为主轴。此时对于这些数据点来说，即便忽略
它们在 
Y
¢
方向上的坐标而只保留它们在 
X
¢
方向上的坐标也能近似描述它们在二
维空间中的位置。即，只需用一维的数据即可近似的描述这些二维空间中的点，
这就是 
POD 
方法降维的原理所在。从上述对 
POD 
原理的描述中可以看出：一组
数据能否用 
POD 
方法进行降维与其在空间的分布形态密切相关。图 
3.2(a)
中的
二维数据点近似呈细长带状分布，明显可以看出其本征维度近似为 
1
，所以可以
使用 
POD 
方法进行降维。但对于图 
3.2(b)
中的二维数据点来说，使用 
POD 
方法
显然是不能有效降维的，因为其本征维度与其所在二维空间的维度是一样的。
 
    
(a) POD 
方法能有效降维
                      (b) POD 
方法不能有效降维
 
图 
3.2  
二维平面上一组数据的本征正交分解示意图
 
除了被用于对可直接写为向量形式的数据进行降维外，近年来 
POD 
方法还西北工业大学博士学位论文
 
36 
 
被拓展到对特定时变物理场的复杂控制方程进行降维（确切的说应该称为降阶）
。采用 
POD 
方法对特定时变物理场的复杂控制方程进行降维的基本原理如下：
首先通过求解原始复杂控制方程得到该时变物理场一定数量的、在不同时刻点的
形态，称为快照，然后采用 
POD 
方法从这些快照中提取出一些主要基本模态（
可理解为图 
3.2(a)
中的主轴 
X
¢
），最后将控制方程投影到这些主要基模态上得到
控制方程的降阶形式。相对于原始复杂的控制方程，求解降阶后的控制方程效率
往往能提高 
2~3 
个数量级。
 
针对不同应用的 
POD 
方法数学推导过程繁复程度也不同，本文使用 
POD 
方
法的目的在于对飞行器设计中的一些物理场（如流场、表面压力分布等）进行快
速预测，故本文在此给出针对提取物理场基模态的 
POD 
数学推导过程。令
( )
{ ( ) :1 , }
i
U
x 
£
i 
£
N x 
Î W 
为 
N 
个快照，
W 
为物理场所在的物理区域。在正式开始
POD 
操作之前首先需要对快照进行中心化预处理，即将每个快照减去所有快照
的平均：
 
( ) ( )
( ) ( ) ( )
i i
%
U
x 
= 
U
x 
- 
U
x                     (3-1) 
U
(x) 为 所 有 快 照 的 平 均 。 如 果 将 
%
U
(i) 
(x) 
看 做 是 一 个 向 量 ， 则 向 量 集 合
( )
{ ( ) :1 , }
i
%
U
x 
£
i 
£
N x 
Î W 
可张成一个线性空间 Ψ ，
POD 
的目的在于找出这个线性
空间的一组正交基
( )
{ ( ) :1 , , }
i
Φ
x 
£
i 
£
M x 
Î W
M 
£
N 
（通常称为基模态），并分辨
哪些基模态对于描述Ψ是重要的，哪些基模态对于描述Ψ是次要的。根据 
POD
的基本原理，所有快照在主要基模态上的投影向量模长之和必然要大于在次要模
态上的投影向量模长之和，故求解主要基模态的问题可转化为如下一个带约束的
求极值问题：
 
( )
2
( )
1
1
Max ,
, 1
N
i
i
N
=
ü
ï
ý
ï
=
þ
å 
%
U 
Φ
Φ Φ
                      (3-2) 
其中，
( )
×
, 
× 
与 
× 
分别为内积运算以及由内积诱导的范数运算，在提取物理场基
模态的计算过程中，通常使用定义在
L
2 
空间，即平方可积空间
(Square Integrable 
Space)
上的内积运算与范数运算。因空间 Ψ 是由快照
( )
{ ( ) :1 , }
i
%
U
x 
£
i 
£
N x 
Î W 
张
成的，故每个基模态
Φ
均可表达为所有快照的线性组合，即：
 
( ) ( )
1
N
i i
i
a
=
Φ
= 
å 
%
U
                          (3-3) 
显然，只要求出上式中的系数
a
(i) 
即可求得基模态
Φ
。将式
(3-3)
代入式
(3-2)
可得
到：
 第三章
  
数据降维方法研究及发展
 
 
37
 
 
2
( ) ( ) ( )
1 1
( ) ( ) ( ) ( )
1 1
1
Max ,
, 1
N N
i i i
i i
N N
i i i i
i i
a
N
a a
= =
= =
ü
æ ö
ï
ç ÷
ï
è ø
ý
æ ö ï
=
ç ÷ ï
è ø þ
å å
å å
% %
% %
U U
U U
                  (3-4) 
在众多的有关 
POD 
的文献中，通常采用著名的拉格朗日乘子法对上式进行
求解
[137,138]
。在拉格朗日乘子法之外，参考文献
[139]
给出了如下一种新颖的求解
方法。首先定义如下一个核函数：
 
( ) ( )
1
1
( )
N
i i
i
x x x x
N
=
K( ,¢) = 
å 
%
U
%
U
(¢)
                   (3-5) 
及如下一个算子：
 
R K x x x dx
W
Φ
= 
ò
( ,¢)
Φ
(¢)¢ 
                    (3-6) 
对 
R 
Φ 
与
Φ
进行内积运算可得：
 
( ) ( )
( ) ( )
( ) ( )
( ) ( )
1
( )
1
R R
1
( ) ( )
1
N
i i
i
N
i
i
x x dx
x x x dx x dx
x x x dx x dx
N
N
W
W W
W W
=
=
( , ) =
= K( ,¢)¢ ¢
=¢ ¢ ¢
= ( , )
ò
ò ò
å ò ò
å
% %
%
Φ Φ Φ Φ
Φ Φ
U U 
Φ Φ
U 
Φ
       (3-7) 
上式右边项恰好等于式
(3-2)
中的求解目标，即式
(3-2)
中的极大值问题被转化
为求解 
(
R 
Φ
,
Φ
) 
的极大值问题。在 
Φ
的模长被限制为单位 
1 
的情况下要使得
(
R 
Φ
, 
Φ
) 
内积运算的值最大显然只有 
R 
Φ 
与 
Φ 
两个向量平行且方向相同，即：
 
R 
Φ
=l
Φ 
                              (3-8) 
对上式进行展开可得：
 
( ) ( ) ( ) ( ) ( ) ( )
1 1 1
1
N N N
i k k i i i
i k i
x x dx a x a x
N
l
W
= = =
é 
æ ö
ù
(¢) (¢)¢ ( ) = ( )
êç ÷ ú
ë
è ø 
û
å å ò 
%
U
%
U
%
U
å 
%
U 
        (3-9) 
仔细观察上式可发现，上式实际上是一个矩阵求特征值的展开形式，即上式等价
于：
 
CV
=l 
V 
                          (3-10) 
其中，
C
为一个 
N 
´
N 
的矩阵，通常称为快照协方差矩阵，其第
i   行 
j 
  
列的元素西北工业大学博士学位论文
 
38 
 
为
( ) ( ) ( )
1 1
=
i k i j
ij
x x dx
N N
( )
W
= 
ò
(¢) (¢)¢ ,C
%
U
%
U
%
U
%
U
；
(1) (2) ( )
= , , ,
T
N
a a a
é ù
ë û
V
L 
。显然，
C
是对称的非负定矩阵，故其具有一组完整的特征值 
(1)
,
(2)
, ,
( )N
l l 
L
l 
。若将这组
特征值按从大到小的顺序排列必然满足 
(1) (2) ( )
0
N
l ³l ³ 
L
³l ³ 
。假设第 
i 
个不
为零的特征值对应的特征向量为
1 2
T
i i i i
N
a a a
( ) ( ) ( ) ( )
=é
 ,
 ,× × ×,ù
ë û
V 
，则：
 
1
N
i i j
j
j
a
( ) ( ) ( )
=
Φ
= 
å 
%
U
                        (3-11) 
为了满足
( )
Φ
,
Φ
=
1的条件需要将每个特征向量的模长进行缩放，每个特征
向量缩放后应满足以下条件：
 
( )
1
,
i i
i
N
l
( ) ( )
V V
= 
                      (3-12) 
进行这种缩放的理由如下：
 
( ) ( ) ( ) ( )
( ) ( )
1 1
( ) ( )
1 1 1
1 1
( )
,
1
,
i i i i
N N
i j i j
j j
j j
N N N
i j j i
j j
j j j
N N
i i
j ij j
j j
i i
i i i
x x dx
a x a x dx
a N x x dx a
N
a N a
N
N
l
W
( ) ( )
W
= =
( ) ( )
W
= = =
( ) ( )
= =
( ) ( )
( ) ( )
= ( ) ( )
= ( ) ( )
æ ö
= ç( ) ( ) ÷
ç ÷
è ø
=
=
=
ò
òå å
å å òå
å å
% %
% %
Φ Φ Φ Φ
U U
U U
C
V CV
V V
      (3-13) 
至 此 ， 由
( )
{ ( ) :1 , }
i
%
U
x 
£
i 
£
N x 
Î W 
张 成 的 线 性 空 间 Ψ 的 一 组 正 交 基
( )
{ ( ) :1 , , }
i
Φ
x 
£
i 
£
M x 
Î W
M 
£
N 
已经被求出，其中 
M 
为矩阵 
C 
的非零特征值个
数。剩下的问题是：如何分辨哪些基模态是主要的，哪些基模态是次要的？
 
由式
(3-2)
可知，判断一个基模态是否是主要基模态可通过所有快照在此基模
态上的投影模长之和的大小来判断。所有快照在第
i 
个基模态上的投影模长平方
之和为：
 第三章
  
数据降维方法研究及发展
 
 
39
 
 
2
2
( ) ( ) ( ) ( )
1 1 1
2
( ) ( )
1 1
2
( )
1 1
2
( ) ( )
1
( ) ( ) ( ) ( )
( ) ( )
( )
( )
, ,
1
), )
,
1
N N N
j i j i k
k
j j k
N N
i k j
k
j k
N N
i
jk k
j k
N
i i
j
j
i i i i
i i
i
i
x a x
N a x x
N
N
N
N
N
N
l
l l
l l
l
l
( )
= = =
( )
= =
= =
=
æ ö
= ( ) ( )
ç ÷
è ø
æ ö
= ( (
ç ÷
è ø
æ ö
=
ç ÷
è ø
=
=
=
=
å å å
å å
å å
å
% % %
% %
U 
Φ 
U U
U U
C V
V
V V
             (3-14) 
即：所有快照在第
i 
个基模态上的投影模长平方之和等于快照协方差矩阵的第
i 
个
特征值。因此，判断一个基模态是否重要可间接通过该基模态对应的特征值大小
来判断。事实上，绝大部分有关 
POD 
应用的文献都采用基于特征值大小定义的
广义能的概念来判断基模态的重要性。将求得的 
M 
个基模态按其对应的特征值
从大到小排列，则前 S
 个基模态中所蕴含的广义能定义为：
 
1 1
M N
i j
S
i j
En 
l l
( ) ( )
= =
= 
å å
                        (3-15) 
使用 
POD 
降维的核心思想即为去掉次要基模态而只保留主要基模态，具体
需要保留的主要基模态的个数可根据著名的 
99%
广义能
[139]
准则来确定。即：当
前 S
 个基模态中蕴含的广义能刚好大于或等于 
99%
时即认为前 
P 
个基模态为主
要基模态。在主要基模态确定之后，任意一个快照均可使用这些主要基模态的线
性叠加来近似表示，具体数学表达式为：
 
( ) ( ) ( )
1
( )
P
i j j
j
b x
=
U
» 
å 
Φ
+ 
U ，
   (
 P 
<<
N)           (3-16) 
线性叠加系数
b
( j) 
可通过最小二乘法得到，具体求解方法将在本文第 
4.1.1 
小节
中进行介绍。上式说明：每个快照只需 
P 
个参数即可得到很好地描述，即，
POD
实现了对所有快照的降维。
 
需要特别指出的是，在上述所有推导过程中用到的内积均为定义在平方可积
空间上的内积，相应的范数或模长也是由平方可积空间上的内积诱导的。这么做
的目的是为了使 
POD 
方法具有更广泛的适用性，使得其不仅能用于对常规的向西北工业大学博士学位论文
 
40 
 
量数据集进行降维还能对物理场集合进行降维。事实上，最为人们所熟悉的、定
义在欧式空间上的内积可以看作是定义在平方可积空间上的内积的一种特殊形
式。当需要使用上述的 
POD 
推导过程对常规的向量数据集进行降维时只需将内
积换为欧式空间上的内积即可。
 
3.2.2 SVD 
方法及其基本性质
 
SVD 
是 
Singular Value Decomposition 
的英文缩写，通常翻译为奇异值分解。
作为一种重要的矩阵分解方法，
SVD 
在图像识别、文本识别及信号处理等领域
获得了广泛的应用。从几何学的角度来说，奇异值分解的实质就是对一个矩阵进
行正交变换，使得变换之后的矩阵成为对角阵，这一点可以很容易的从下面的奇
异值分解定理中看出来。
 
奇异值分解定理：对于任意一个
m 
´
n 
的矩阵
A 
，若其秩为 
r 
(
( )
)
r 
£
min m, n
则必然存在
m 
阶正交方阵
U 
和
n
阶正交方阵 
V 
使得：
 
T
U AV
= 
Σ 
                            (3-17) 
或：
    
T
A
= 
U
Σ
V 
                            (3-18) 
Σ 
为 
m 
´
n 
的矩阵，其前 
r 
阶子式 
σ
为对角线元素均大于零的对角阵，除此之外 
Σ
中的其它元素均为零，即：
 
( )
1 2
, , ,
r
σ
=
diag 
s s 
L
s 
                      (3-19) 
=
σ 
0
Σ
0 0
                             (3-20) 
同时， 
σ
对角线上元素还满足
1 2
0
r
s ³s ³ 
L
³s > 
。矩阵 
U 
与矩阵 
V 
分别满足
T
U U
= 
I 
，
T
V V
= 
I 
。
 
令 
[ ]
=
, ,
L
,
1 2 m
U u u u 
、 
[ ]
=
, ,
L
,
1 2 n
V v v v 
，则
i
u 
与
i
v 
分别称为矩阵 
A 
的左奇
异向量与右奇异向量，
Σ 
对角线上的元素称为矩阵 
A 
的奇异值。当 
r 
<
min
(
m,n
)
时，从式
(3-18)
可以得出如下结论：在使用 
Σ 
、
U 
、 
V 
对矩阵
A 
进行重构的过程
中，完全可以忽略这三个矩阵的部分信息而使得重构出来的矩阵仍然等于
A 
。证
明过程如下：
 
1 11 2 12 1
1 21 2 22 2
1 1 2 2
0 0
0 0
=
0 0
r r
Tr r T
m m r mr
u u u
u u u
u u u
s s s
s s s
s s s
=
L L
L L
M M O M MOM
L L
A U
Σ
V V 
              (3-21) 第三章
  
数据降维方法研究及发展
 
 
41
 
 
可得
A 
的第
i 
行、 
j 
列上的元素为：
 
1
r
ij k ik jk
k
a 
s
u v
=
= 
å 
                        (3-22) 
即：
 
1
=
r
i
i
s
=
å
i i
A u v 
                         (3-23) 
从上式可以看出：当矩阵
A 
的维度
m 
、
n
均很大，但秩 
r 
比较小时，只需存
储 
r 
个实数、
r 
个
m 
维向量及 
r 
个
n
维向量即可完整的保留整个矩阵的信息。这对
于信号传输、图像压缩等专业是非常有意义的。更进一步，如果只需得到矩阵
A
的近似，则可在式
(3-23)
中只使用数值较大的奇异值及其对应的左、右奇异向量
，即：
 
( )
1
k
i
i
s
k r
=
» 
å
<
i i
A u v 
                (3-24) 
上式即为使用 
SVD 
方法进行数据降维的基本原理。
 
3.3 POD 
与 
SVD 
的等价性证明及实际使用中的差异
 
从 
POD 
与 
SVD 
的推导过程来看，两种方法的计算过程存在显著差异，事实
上两种方法在理论上是等价的。不过，两种方法计算过程的不同又决定了它们在
计算效率、计算精度等方面存在一定差异。本节将通过简单但严格的数学推导证
明两种方法在理论上的等价性，同时对两种方法在实际使用中的差异进行简单地
阐述。
 
3.3.1  
两种方法的等价性证明
 
设矩阵
m
´
n
A 
的秩为 
r 
，
1
|
r
i i
=
v 
为该矩阵的右奇异向量，则
i
v 
为方阵 
T
A A 
的特
征向量，
2
i
s 
为对应的特征值，证明过程如下。
 
由式
(3-18)
可得：
 西北工业大学博士学位论文
 
42 
 
2 2 2
1 2
2 2 2
1 2
2
2
, , , ,0, ,0
, , , ,0, ,0
0,0, , ,0, ,0
T T T T
i i
T
r i
T
r i
T
i
i i
diag
diag
s s s
s s s
s
s
=
=
=
=é
 ù
ë û
=
L L
L L
L L
A A v V
Σ 
U U
Σ
V v
V V v
V V v
V
v
       (3-25) 
若将矩阵 
A 
的 
m 
个 
n 
维行向量
1
m
i
i
=
a 
看作是
m
个
n
维的快照，显然 
A
T
A 
相当于
POD 
方法中的快照协方差矩阵，而矩阵 
A 
的前
r
个右奇异向量
i
v 
为矩阵 
A 
的
m
个
n
维行向量所张成线性空间的一组标准正交基。因此，从纯数据降维的角度来说
，
SVD 
方法与 
POD 
方法在理论上是等价的。参照 
POD 
方法中普遍使用广义能
确定需要保留的主要基模态数量的方法，在使用 
SVD 
方法对数据进行降维时同
样也可以使用这种方法，即使用式
(3-15)
确定
(3-24)
中的k
 值。但从式
(3-25)
可以
看出，此时表征
i
v 
所蕴含广义能大小的指标为 
2
i
s 
，而非
i
s 
。
 
3.3.2  
两种方法在实际使用的差异性
 
虽然 
POD 
与 
SVD 
在理论上是等价的，但在大量的实践中人们发现 
POD 
与
SVD 
存在以下三点差异：
 
第一、在采用计算机进行数据降维时，
SVD 
方法的计算精度要高于 
POD 
方
法
[140]
，且原始数据的维度不太高时，
SVD 
的计算效率也高于 
POD 
方法。因此
，对于维度不太高
(
通常维度不超过
10
4 
)
的数据集，通常使用 
SVD 
方法进行降维
；
 
第二、在对超高维数据进行降维时，
SVD 
方法的计算效率要低于 
POD 
方法
。例如，如果需要对 
1000 
个维度为
10
6 
的数据点集合进行降维，那么 
SVD 
方法
需要对一个 
6 3
10 
´
10 
的矩阵进行操作，显然这会耗费很长的计算时间。甚至有些
计算机的内存根本无法装下这种规模的矩阵，此时就无法使用 
SVD 
对数据集进
行降维。而 
POD 
方法则不需要同时将整个数据集读入内存进行运算，只需对一
个 
3 3
10 
´
10 
的矩阵进行特征值与特征向量的求解，故计算效率优于 
SVD 
方法；
 
第三、
  POD 
方法可根据实际需求灵活地定义向量间的内积运算，这使得
POD 
方法不仅可用于纯数据降维还能用于复杂偏微分方程的降阶，这一点对于
SVD 
方法来说是难以企及的。
 
3.4 
非线性数据降维方法 
ISOMAP 
线性化的数据降维方法通常只适用于具有线性结构的数据集，对于具有非线第三章
  
数据降维方法研究及发展
 
 
43
 
 
性结构的数据集往往不能起到很好地降维作用，但具有非线性结构的数据集又大
量存在于各学科领域，为此非线性数据降维方法应运而生。传统的典型非线性降
维方法均脱胎于线性的数据降维方法，并不是基于数据集的非线性本质特征发展
而来的，所以在实际应用中取得的成功比较有限。
 
2000 
年 
Tenenbaum 
等人在《
Science
》发表了一种全新的非线性降维方法
—
等距特征映射
(Isometric Feature Mapping, ISOMAP)
，在同一期期刊上 
Roweis 
等
人 发 表 了 另 一 种 全 新 的 非 线 性 降 维 方 法 
— 
局 部 线 性 嵌 入 
(Locally  Linear 
Embedding,  LLE)
。这两篇文章的刊出开启了非线性降维方法的一个全新研究方
向
—
流形学习。
2003 
年 
De  Silva 
等人
[142]
给出了流形学习的严格数学定义：设
d
Y 
Ì
R 
是一个低维流形， 
:
D
f Y 
®
R 
是一个光滑嵌入，其中 D
 
>
d 。数据集
{ }
i
y
是随机生成的
,  
且经过 
f 
映射为观察空间的数据 
=
f( )
i i
x y 
。流形学习就是在给
定观察样本集{ }
i
x 
的条件下重构 
f 
和{ }
i
y 
。从其定义可以看出，流形学习的目的
就是发现高维数据集中的潜在低维流形结构，同时建立从高维空间到低维流形空
间的非线性映射，从而实现数据维度的降低。
 
从其诞生至今短短十多年的时间里，流形学习得到了极大的发展，涌现出的
流形学习方法多达数十种。作为最早诞生的全局型流形学习算法，
ISOMAP 
算法
捕捉数据集所在低维流形全局结构的能力已经得到了广泛的认可。
 
3.4.1 ISOMAP 
方法及其基本性质
 
ISOMAP 
方法的中文译名为等距特征映射，这里所说的等距即为保持数据集
中 任 意 两 点 间 的 距 离 在 降 维 前 后 不 变 。 这 一 性 质 正 好 是 多 维 尺 度 变 换
(Multidimensional  Scaling,  MDS)
降维方法的基本特征和主要目的。事实上，
ISOMAP 
在实际操作中完整地使用了 
MDS 
方法，故要了解 
ISOMAP 
算法首先需
要了解 
MDS 
算法。
 
3.4.1.1 MDS 
算法
 
假设{
 ,1 }
D
i
X
Î
R 
£
i 
£
N 为 
D 
维空间中的 
N 
个点，则其中第 
i 
个点与第 
j 
个点
之间的距离平方为：
 
( ) ( )
2
T
ij
d 
=
i j i j
X - X X - X 
                    (3-26) 
令
B 
为 
N 
´
N 
的方阵，其
i 
行 
j 
列上的元素为
 
2 2 2 2
2
1 1 1 1
1 1 1 1
2
N N N N
ij ij ij ij ij
i j i j
b d d d d
N N N
= = = =
æ ö
= ç- + + - ÷
ç ÷
è ø
å å åå 
            (3-27) 西北工业大学博士学位论文
 
44 
 
则有：
B 
为对称半正定矩阵，且 
( ) 
( )
T
ij
b 
=
i j
X - X X - X 
，其中
1
1
N
i
i
N
=
X
= 
å 
X 
。上述
结论证明过程如下：
 
( ) ( )
2
2
T
ij i j i j
T T T T
i i j j j i i j
T T T
i i j j i j
d 
=
= + - -
= + -
X - X X - X
X X X X X X X X
X X X X X X
              (3-28) 
则：
 
2
1 1 1
1 1 2
N N N
T T T
ij j j i i i j
i i i
d
N N N
= = =
å
= 
X X
+ 
å 
X X
- 
å 
X X 
              (3-29) 
2
1 1 1
1 1 2
N N N
T T T
ij i i j j i j
j j j
d
N N N
= = =
å
= 
X X
+ 
å
X X
- 
å
X X
              (3-30) 
2 2
2
1 1 1 1
1 1 1 1
1 1 1
1 1 2
N N N N
ij ij
i j i j
N N N N
T T T
i i j j i j
i j i j
d d
NN N
N N N
= = = =
= = = =
æ ö
= ç ÷
ç ÷
è ø
= + -
åå å å
å
X X
å
X X
åå
X X
    (3-31) 
将式
(3-28)~ (3-31)
代入式
(3-27)
可得：
 
( ) 
( )
2 2 2 2
2
1 1 1 1
1 1 1 1
1 1 1 1
2
1 2 2 2
2
2
N N N N
ij ij ij ij ij
i j i j
N N N N
T T T T
i j i j i j i j
j i i j
T T T T
i j i j
T
b d d d d
N N N
N N N
= = = =
= = = =
æ ö
= ç- + + - ÷
ç ÷
è ø
æ ö
= ç- - + ÷
ç ÷
è ø
= - - +
=
å å åå
å å åå
i j
X X X X X X X X
X X X X X X X X
X - X X - X
   (3-32) 
证毕。
 
因 
( ) 
( )
T
ij i j
b 
= 
X - X X - X 
，故矩阵 
B 
又被称为数据集{
 , 1 }
D
i
X
Î
R 
£
i 
£
N 的中
心化内积阵。显然，
B 
为对称半正定矩阵，故
B 
的 
N 
个特征值均大于等于零。
假设
1 2
, , ,
r
l l 
L
l 
为 
B 
的 
r 
个正特征值，且满足
1 2 r
l >l > 
L
>l 
，
i
l 
对应的单位特
征向量为
i
e 
，矩阵 
[ ]
1 2
, , ,
r
Γ
= 
e e
L 
e 
。则对于矩阵
1 1 2 2
, , ,
r r
=é
l l l ù
ë û
Y e e
L 
e 
有
如下结论：
 
1
、 
B
= 
YY
T 
；
 
2
、
T
ij i j
b 
= 
y y 
，其中
i
y 
、
j
y 
分别为矩阵 
Y 
的第 
i 
个行向量与第 
j 
个行向量；
 第三章
  
数据降维方法研究及发展
 
 
45
 
 
3
、 
( ) ( )
2
T
ij i j i j
d 
= 
y
- 
y y
- 
y 
，或 
( ) ( ) ( ) ( )
T T
i j i j
= - -
i j i j
X - X X - X y y y y 
。
 
首 先 证 明 第 一 个 结 论 ， 令 矩 阵 
( )
1 2
, , ,
r
Σ
=
diag 
l l 
L
l 
则 
Y
= 
ΓΣ
1/2 
,
T1/2 T
Y
= 
Σ Γ 
，故
T1/2 1/2 T
YY
= 
ΓΣ Σ Γ 
。由谱分解定理
[65]
可得 
ΓΣ
1/2 
Σ
1/2
Γ
T 
= 
B 
，故
T
B
= 
YY 
，得证。
 
当
B
= 
YY
T 
成立之后，
T
ij i j
b 
= 
y y 
是自然成立的，故第二条结论也得证。
 
在第二条结论得证的情况下有：
 
( ) ( ) 
2
2
T
T T T
i j i j i i j j i j
ii jj ij
b b b
- - = + -
= + -
y y y y y y y y y y
              (3-33) 
按
(3-27)
将上式中的
ii
b 、
jj
b 
、 2
ij
b 
展开再合并同类项可得：
 
2
2
ii jj ij ij
b 
+
b 
-
b 
=
d                       (3-34) 
故 
( ) ( )
2
T
ij i j i j
d 
= 
y
- 
y y
- 
y 
成立，
  
( ) ( ) ( ) ( )
T T
i j i j
= - -
i j i j
X - X X - X y y y y 
也自然
成立，第三条结论得证。
 
上述结论说明：数据集{
 ,1 }
D
i
X
Î
R 
£
i 
£
N 中任意两点
i
X 
、
j
X 
之间的距离
与数据集 {
 ,1 }
r
i
y
Î
R 
£
i 
£
N 中两点
i
y 
、
j
y 
之间 的 距 离 是 相 等 的， 即 数据集
{ , 1 }
D
i
X
Î
R 
£
i 
£
N 被等距地从 
D 
维空间映射到了 
r 
维空间。如果“等距
”
的要求
进一步放宽到
“
近似等距
”
，那么
i
y 
的维度可以进一步降低，即矩阵 
Y 
只使用矩阵
B 
的前 d
(
d 
<
r
) 
个特征值及其对应的单位特征向量，d
 的具体取值取决于“
近似等
距
”
的具体要求。仿照 
POD 
方法中通过广义能确定主要基模态数量的做法，在
MDS 
中也可以设置一个阀值
0
En 来确定 d
 的具体取值，即 
d 可取满足下式的最小
值。
 
                    
0
1 1
d r
d i j
i j
En 
l l
En
= =
= 
å å
³
                   (3-35) 
3.4.1.2 ISOMAP 
算法
 
ISOMAP 
可看作是 
MDS 
算法在流形空间的推广，两者的绝大部分计算过程
完全相同，只不过 
ISOMAP 
将 
MDS 
中两点间的距离由欧式距离换成了测地距离
。所谓测地距离是指流形上两点之间的最短距离，而不是这两点在流形所嵌入高
维空间中的欧式距离。例如地球的表面可看作是嵌入在三维空间中的二维流形，
北京与纽约分别为该流形上的两个点，则北京与纽约之间的测地距离为两者沿地
球表面测出的最短距离，而不是两者之间穿过地球的直线距离。
 
在知道一个数据集所在流形的具体结构的情况下，数据集中任意两点间的测西北工业大学博士学位论文
 
46 
 
地距离可以很容易地计算出来。但 
ISOMAP 
的目的就是挖掘蕴藏在数据集中的
潜在流形结构，故对于给定的数据集合，事先是不知道其所在流形的结构的，所
以数据集中任意两点间的测地距离也就无法直接得到。为此 
ISOMAP 
引入了邻
域与邻域图的概念，而邻域又有k邻域与
e 
邻域之分。在一个给定的数据集中，
一个点的k
 邻域是指距离该点最近的
k 个点所组成的集合；而该点的
e 
邻域则是
指与该点之间距离小于等于
e 
的点所组成的集合。需要特别指出的是：这两个概
念中的距离均为欧式距离。一个数据集的邻域图是一个对称方阵，其阶数为数据
集元素的个数。邻域图中的每个元素按如下的规则确定：若数据集中第 
j 
个点是
第
i 
个点邻域中的元素，则邻域图中第
i 
行、 
j 
列上的元素即为点
i 
与点 
j 
之间的
欧式距离，否则邻域图中第
i 
行、 
j 
列上的元素为 
+¥ 
。
 
在现实生活中，邻域图具有非常直观的物理意义。例如对于一幅包含很多城
市的地图，用邻域图可以方便的实现这些城市之间公路网的数字化记录：如果两
个城市之间有不经第三方城市的公路直接相连，则在邻域图中这两个城市之间的
直接距离为该公路长度，否则认为这两个城市之间的直接距离无穷大。实际上，
两个没有直接公路相连的城市之间通常可以通过其它城市辗转相连。以下图为例
，图中的每个编号代表一个城市，两个编号之间的连线代表这两个城市之间的直
连公路，直线上的数字代表公路的长度。从邻域图上看城市 
1 
与城市 
3 
之间的直
接距离是无穷大的，但实际上我们可以按路线1
®
2 
®
3或路线
1
®
2 
®
5
®
3甚
至路线1
®
2 
®
5
®
6 
®
3来实现从城市 
1 
到达城市 
3 
的目的，但显然路线
1
®
2 
®
3是其中最短的。对于更为复杂的公路网络，在给定了其邻域图之后，
如何寻找两个不直接相连城市之间的最短距离路线是一个非常实际的问题，而此
问题可以通过 
Dijkstra 
算法
[143]
或 
Floyd 
算法
[144]
很好地解决。
 
 
图 
3.3 9 
个城市之间的公路网
 
ISOMAP 
计算测地距离的思路与在一个公路网中寻找两个城市之间最短路
线的思路是一样的。对于给定的数据集，在得到其邻域图后，任意两点间的测地第三章
  
数据降维方法研究及发展
 
 
47
 
 
距离计算规则如下：如果这两个点彼此属于对方的邻域，则两点之间的测地距离
为两点之间的欧式距离；否则，两点之间的测地距离为基于邻域图找出的两点之
间最短路线距离。
 
在计算出任意两点间的测地距离后，
ISOMAP 
后续的计算过程与 
MDS 
完全
相同。至此，我们可以给出如下基本的 
ISOMAP 
计算过程：
 
1)  对于给定的数据集根据 
k 邻域准则或
e 
邻域准则建立邻域图；
 
2)  根据邻域图计算数据集中任意两点间的测地距离；
 
3)  将数据点之间的测地距离代入式
(3-27)
建立中心化内积阵 
B 
；
 
4)
  
求解矩阵 
B 
的特征值与特征向量，根据特征向量得到原始数据集在低维
流形上的坐标
。
 
图 
3.4(a)
为 
Swiss-roll 
三维曲面上随机分布的 
3000 
个点，显然 
Swiss-roll 
曲
面是一个嵌入在三维空间中的二维流形。图 
3.4(b)
为按照上述步骤得到的这 
3000
个点在二维流形上的分布，计算过程中采用k邻域准则，且
k 
=
20。显然，在此
算例中 
ISOMAP 
很好地捕捉到了这 
3000 
个三维空间中的点所蕴含的二维流形结
构。
 
    
(a)                                          (b) 
图 
3.4  
三维 
Swiss-roll 
数据集及采用 
ISOMAP 
得到的此数据集二维流形
 
虽然在上面的算例中 
ISOMAP 
准确地捕捉到了蕴含在数据集中的流形结构
，但基本的 
ISOMAP 
方法仍然有以下一些地方不太完善：
 
首先，上述过程中没有给出确定步骤 
1 
中邻域参数k或
e 
具体值的规则或方
法，而实际上邻域参数是否合适对于捕捉数据集中所蕴含的流形结构至关重要。
如图 
3.5 
所示，如果邻域参数设置过小，则可能出现断路现象；如果设置过大则
可能出现短路现象。不论是断路还是短路，都会使得 
ISOMAP 
的计算得不到正
确的结果。
 西北工业大学博士学位论文
 
48 
 
          
(a)  
断路
                                   (b)  
短路
 
图 
3.5 Swiss-roll 
数据集上出现的断路与短路现象，图片来自参考文献
[100] 
其次，当数据集的规模较大时，计算出所有数据点之间的测地距离需要耗费
较长的计算时间，同时计算矩阵
B 
的特征值与特征向量也相当费时。在一台 
CPU
主频为 
3.4GHz 
的个人计算机上，完成图 
3.4 
中的算例需要 
128.27 
秒。如果将数
据点的个数进一步增加到 
5000 
个点，则需耗时 
818.40 
秒。
 
最后，上述过程中没有给出一个合理的准则或方法来确定步骤 
4 
中到底需要
使用矩阵
B 
的前多少个特征值与特征向量，也就是说上述过程没有给出一个合理
的准则或方法来估算原始数据集的本征维度。而如果原始数据集的本征维度估算
有误，那么整个 
ISOMAP 
的计算过程都是没有意义的。虽然 
MDS 
算法给出了确
定低维空间维度的公式
(
式
(3-34))
，但它的目的仅仅为了保持数据点在低维空间
的距离与在原始高维空间的距离大体相等，并不是为了估算原始数据集的本征维
度，所以在这里并不适用。在图 
3.4 
所示的算例中，通过人的肉眼观察即可看出
数据集的本征维度为 
2
，但对于高于 
3 
维的数据集来说，人的肉眼基本是无法判
断数据集的本征维度的。
 
3.4.2 
基于最小子集覆盖的 
L-ISOMAP 
算法
 
当数据集的规模较大时导致 
ISOMAP 
计算效率显著降低的主要原因有两点
[100]
：数据点之间的测地距离计算及矩阵 
B 
特征值与特征向量的求解。对于数据
点之间测地距离的计算，目前普遍使用的是计算效率较高的 
Dijkstra 
算法，其计
算复杂度为
2
O(k Nlog N) 
，其中 k
 为邻域参数， 
N 
为数据点个数。而矩阵 
B 
特征
值与特征向量的求解计算复杂度为
3
O(N) 
。为了克服上述问题，
De Silva 
等人于
2004 
年提出了 
L-ISOMAP(Landmark point ISOMAP)
算法
[145]
。
 
3.4.2.1 L-ISOMAP 
算法
 
L-ISOMAP 
算 法的 基本 原理为 ： 首 先 从数量 为 
N 
的 数据集中 选 出 
M
( M 
=
N) 
个数据点作为 
Landmark 
点，在计算测地距离时，只计算所有数据点与第三章
  
数据降维方法研究及发展
 
 
49
 
 
Landmark 
点之间的测地距离，而无需计算所有数据点之间的测地距离。然后，
利用 
M 
个 
Landmark 
点之间的测地距离按照标准的 
MDS 
算法计算出 
Landmark
点在低维流形上的坐标。最后，利用其余数据点与 
Landmark 
点之间的测地距离
计算出其在低维流形上的坐标。上述过程中前两步操作较为简单，无须过多阐述
，第三步的具体操作过程如下：
 
1)  设 
D 
为一个 
M 
´
M 
的方阵，其第 
i 
行、
j 
列上的元素
2
ij
d 
为第 
i 
个 
Landmark
点与第 
j 
个 
Landmark 
点之间的测地距离平方，
1 2
, , ,
M
Δ Δ
L 
Δ 
为 
D 
的 
M 
个
列向量。计算出
1 2
, , ,
M
Δ Δ
L 
Δ 
的均值向量
1 2
( ) /
M
Δ
= 
Δ
+ 
Δ
+
L
+ 
Δ
M ；
 
2)  设原始数据集的本征维度为 
d ，由 
M 
个 
Landmark 
点间测地距离构建的
中心化内积阵为
B 
，
1 2
, , ,
d
l l 
L
l 
为矩阵 
B 
的前 d
 个特征值，
i
l 
对应的单
位特征向量为
i
e 
。计算 
M 
个 
Landmark 
点在 d
 维流形空间坐标矩阵的伪
逆转置矩阵
#
1 2
1 2
1 1 1
, , ,
T
d
d
l l l
é ù
= 
ê ú
ê
ë
ú
û
L e e
L 
e 
；
 
3)  对于原始数据集中任意一个非 
Landmark 
数据点 
x 
，其在低维流形空间的
坐标向量为
#
-
( 
-
) / 2
x
L 
Δ Δ 
，其中
x
Δ 
为 
x 
与所有 
Landmark 
点之间的测地
距离平方列向量。
 
在 
L-ISOMAP 
中，使用 
Dijkstra 
算法计算测地距离的计算复杂度为
O(k MNlog N) 
，计算所有数据点在低维流形的坐标的计算复杂度为
2
O(NM) 
，
相对于基本 
ISOMAP 
算法，计算效率大大提升。
 
然而，雷迎科指出：
Landmark 
点选取的好坏对 
L-ISOMAP 
的最终计算结果
具有显著影响，当所选取的 
Landmark 
点分布不均匀时，
L-ISOMAP 
得到的结果
往往不太理想。而在原始的 
L-ISOMAP 
中，
Landmark 
点的选取完全是随机的，
显然这是不能保证所选取的 
Landmark 
点分布均匀的。为此，在其博士论文中雷
迎科发展了基于最小子集覆盖的 
Landmark 
点选取方法来克服这一问题。
 
3.4.2.2 
基于最小子集覆盖的 
L-ISOMAP 
算法
 
最小子集覆盖
(Minimum Set Cover, MSC)
的数学定义如下：设
1
{ }
N
i
i
x
=
为包含
N 
个元素的集合，
1
{ }
M
i
i
s
=
为包含 
M 
个元素的集合，它满足：
 
1
、
1
{ }
M
i
i
s
=
中的每个元素均为集合
1
{ }
N
i
i
x
=
的子集，即 (1 )
i
s 
£
i 
£
M 本身也是一
个集合；
 
2
、所有
i
s 中的元素组成的集合必须包含
1
{ }
N
i
i
x
=
中的所有元素。
 
最小子集覆盖即为满足上述要求的
1
{ }
M
i
i
s
=
中元素个数最少的集合。
 
对于 
D 
维空间的数据集{
 ,1 }
D
i
X
Î
R 
£
i 
£
N ，在给定邻域参数后可得到任意
点
i
X 
的邻域点集合
i
s ，设集合
1 2
{ , , , }
N
S 
=
s s 
L
s ，
1 2
{ , , , }
c c cm
C 
=
s s 
L
s 为 S
 的子集西北工业大学博士学位论文
 
50 
 
中
i
X 
的最小子集覆盖。则，在基于最小子集覆盖的 
L-ISOMAP 
中 
Landmark 
点为
1 2
, , ,
c c cm
X X
L 
X 
。为保证最后构造的邻域图是连通的，集合C
 中任意一个元素
ci
s
与 C
 中 除
ci
s 之 外 的 其 它 元 素 组 成 的 集 合 之 间 的 交 集 不 能 为 空 ， 即
/
cj ci
ci s C s cj ci
s s 
a
s
Î
Ç È ³ 
，其中
a 
为重叠系数，且满足0
 
<a <
1，
ci
s 表示集合
ci
s
中的元素个数。为了从
1 2
{ , , , }
N
S 
=
s s 
L
s 找出满足上述要求的{
 , 1 }
D
i
X
Î
R 
£
i 
£
N
的最小子集覆盖C
 ，文献
[100]
给出了如下的贪婪算法：
 
1)  令 
C 初始为空集，首先从
1 2
{ , , , }
N
S 
=
s s 
L
s 找出使得 s 
Ç
S 达到最大的邻
域点集合 
s 
，然后将 
s 
加入到集合C
 ，并将 
s 
从 S
 中去掉；
 
2)  若 
S 不为空，则执行下一步，否则转到第 
6 
步；
 
3)  从 
S 中找出邻域点集合 
s 
，使得 s 
Ç
S 最大且 s 
Ç
S 
£
（1
-
a
s
） ；
 
4)  将前一步找出的 
s 
加入集合 C
 ，同时将 
s 
从 S
 中去掉；
 
5)  返回第 
2 
步；
 
6)  计算结束。
 
图 
3.6 
为采用 
L-ISOMAP 
得到的图 
3.4(a)
中的三维 
Swiss-roll 
数据集的二维
流形结果。其中，图 
3.6(a)
中的 
Landmark 
点采用随机方法生成，图 
3.6(b)
中
Landmark 
点采用最小子集覆盖方法生成，两者的 
Landmark 
点数均为 
150 
个。在
完成图 
3.4 
中算例所用的同一台电脑上完成图 
3.6(a)
中的算例耗时 
11.31 
秒，完成
图 
3.6(b)
中的算例耗时 
11.21 
秒，两者耗时基本相同，且均不及原始 
ISOMAP 
方
法的十分之一。对比图 
3.6(a)
与图 
3.6(b)
，明显可以看出基于最小子集覆盖的
L-ISOMAP 
方法得到的结果更好，与图 
3.4(b)
中原始 
ISOMAP 
方法得到的结果高
度相似。而采用随机生成 
Landmark 
点的 
L-ISOMAP 
方法虽然捕捉到了二维流形
的大体形态，但显然其得到的原始数据集在二维流形上的映射结果非常不均匀。
 
  
(a) Landmark 
点随机生成
           (b) Landmark 
点由最小子集覆盖生成
 
图 
3.6  
采用 
L-ISOMAP 
得到的三维 
Swiss-roll 
数据集的二维流形
  第三章
  
数据降维方法研究及发展
 
 
51
 
 
3.5 
新型邻域参数与本征维度估算方法
 
基于最小子集覆盖的 
L-ISOMAP 
方法在保持原始 
ISOMAP 
方法计算精度的
情况下计算效率大大提高，但它仍然没有解决 
ISOMAP 
方法事先不能估计邻域
参数和本征维度的问题，这极大的妨碍了 
L-ISOMAP 
在实际问题中的应用。本
节将基于最小子集覆盖与 
SVD 
构建一种新型邻域参数与本征维度估算方法。
 
3.5.1 
方法的构建
 
在 
ISOMAP 
算法中，邻域参数估计与本征维度估计通常是捆绑在一起的。
这是因为：属于同一个邻域的两个数据点之间的测地距离即为这两个点之间的欧
式距离，而相距较远的两个点之间的测地距离则不能直接使用两者之间的欧式距
离。说明 
ISOMAP 
认为属于同一邻域的数据点构成了一个局部的线性空间，而
蕴藏在高维数据集中的流形是由这些局部的线性空间拼接而成的。因此，可以认
为高维数据集的本征维度即为每个局部线性空间的维度—虽然这种观点从理论
数学的角度来说是不严谨的。
 
基于 
ISOMAP 
的上述特点，人们自然而然的想到从分析数据集中每个点的
邻域维度入手去分析整个数据集的本征维度。而分析线性空间的维度是非常容易
的，例如本文 
3.2 
节中的介绍的 
POD 
方法与 
SVD 
方法均可以直接用来完成这项
工作。事实上，人们已经开发了多种基于局部 
PCA  (POD 
在统计学中的简称
)
的
数据集本征维度估计方法。其基本原理为：首先采用 
PCA 
判断高维数据集中每
个数据点的邻域维度，然后统计所有维度的分布，最后选择对应邻域数最多的维
度作为数据集的本征维度。但是，从拼接成流形的角度来说，显然并不需要所有
数据点的邻域，因为两个在空间上非常接近的数据点的邻域大部分是重合的。因
此，在采用局部 
PCA 
方法估计流形的本征维度时，也并不需要对所有数据点的
邻域进行维度估计，而只需要对原始数据集的最小子集覆盖进行维度判断即可，
这可以显著提高计算效率。同时，本文在 
3.2.3 
小节已经论述过：在对纯数据集
进行降维时，
SVD 
与 
POD 
在理论上是等价的，但 
SVD 
的计算精度更高。且当
数据集的原始维度不太高时，
SVD 
的计算效率也更高。基于上述分析，本文构
建了一种基于最小子集覆盖与 
SVD 
的新型邻域参数与本征维度估算方法。
 
对于 
D 
维空间的数据集{
 ,1 }
D
i
X
Î
R 
£
i 
£
N ，以 
k 邻域参数为例，基于最小
子集覆盖的邻域参数与本征维度估算过程如下：首先给定邻域参数的一个候选区
间
[ ]
min max
k,k 以及一个广义能阀值
n
E ，设置初始
min
k 
=
k ，按如下步骤遍历所有k
的候选值。
 
1)  找出邻域参数为 
k 时数据点
i
X 
的邻域点集合
i
s ，将所有数据点的邻域点西北工业大学博士学位论文
 
52 
 
集合组成一个集合
1 2
{ , , , }
N
S 
=
s s 
L
s ；
 
2)  从集合 
S中找出
{ , 1 }
D
i
X
Î
R 
£
i 
£
N 的最小子集覆盖
1 2
{ , , , }
c c cm
C 
=
s s 
L
s ；
 
3)  根据设置的广义能阀值，采用 
SVD 
方法计算出集合 C
 中每个元素的主要
奇异值数量，并将
ci
s 的主要奇异值数量视作其本征维度；
 
4)  k 
=
k 
+
1；
 
5)  若
max
k 
>
k 则结束计算，否则返回步骤
1
。
 
完成上述计算之后，对于区间
[ ]
min max
k,k 中的每个 k
 值将得到一组本征维度
值，将
max min
k 
-
k 
+
1组本征维度值绘制成
max min
k 
-
k 
+
1条曲线以便观察。如果大
量k值的最小子集覆盖维度均为同一个值
d，则认为数据集
{ ,1 }
D
i
X
Î
R 
£
i 
£
N 的
本征维度为d。至于最佳邻域参数，可取所有最小子集覆盖本征维度均为
d的
k值
中最大的那个。当邻域参数为
e 
时，只需设置一个最大的
max
e 
与一个最小的
min
e 
，
然后让
e 
由
min
e 
按照一个固定的间隔 
De 
逐渐增加到
max
e 
再计算每个 
e 
对应的所
有最小子集覆盖的本征维度即可。
 
3.5.2 
算例验证
 
以三维空间中的 
Swiss-roll 
数据集为例，证明本文开发的新型邻域参数与本
征维度估算方法的适用性。图 
3.7 
为数据量为 
3000 
的 
Swiss-roll 
数据集。设定邻
域参数的候选区间为
[ ]
10,50 ，
SVD 
方法中计算主要奇异值数量的广义能量阀值
采用最为常用的 
99%
，寻找最小子集覆盖时的重叠系数为 
0.9
。图 
3.8(a)~  (d)
分
别为k
 
=
10、
k 
=
25、
k 
=
40及
k 
=
41时最小子集覆盖中所有邻域的本征维度分布
曲线。从图中可以看出：当邻域参数k位于区间
[
10, 40
] 
时，所有最小子集覆盖中
各个邻域的本征维度均为 
2
，当k
 
=
41时，会出现最小子集覆盖中的前两个邻域
本征维度为 
3 
的情况。根据本文提出的邻域参数选择及本征维度估算准则，此时
最佳邻域参数为k
 
=
40，而原始数据集的本征维度为 
2
。图 
3.9 
展示了k
 
=
41时本
征维度为 
3 
的两个邻域中的数据点，显然，这两个邻域出现了短路现象。图 
3.10
、
3.11
、
3.12 
分别为k
 
=
41、
k 
=
40及
k 
=
10时采用基于最小子集覆盖的 
L-ISOMAP
得到的图 
3.7 
中 
Swiss-roll 
数据集降维结果。从上述图中可以看出：当k
 
=
41时得
到的降维结果是错误的，而 k
 
=
40及 
k 
=
10时得到的降维结果均捕捉到了原始
Swiss-roll 
数据集中蕴含的二维流形结构，但，显然 k
 
=
40得到的结果更好。此算
例证明本文提出的基于最小子集覆盖与 
SVD 
的邻域参数与本征维度估算方法是
有效且实用的。
 第三章
  
数据降维方法研究及发展
 
 
53
 
 
 
图 
3.7  
三维 
Swiss-roll 
数据集
 
    
(a)  k 
=
10                                     (b)  k 
=
25  
    
(c)  k 
=
40                                     (d)  k 
=
41  
图 
3.8  
不同 
k 
值时最小子集覆盖中各个邻域本征维度的分布
 
    
图 
3.9  k 
=
41
时本征维度为 
3 
的两个邻域
         
图 
3.10  k 
=
41 
时 
Swiss-roll 
降维结果
 西北工业大学博士学位论文
 
54 
 
    
图 
3.11  k 
=
40 
时 
Swiss-roll 
降维结果
          
图 
3.12  k 
=
10
时 
Swiss-roll 
降维结果
 
  第四章
  Gappy POD  
反设计方法改进及应用
 
 
55
 
 
第四章
  Gappy POD 
反设计方法改进及应用
 
虽然优化设计已经成为当前气动设计中的主流方法，但是优化设计中仍然存
在一些影响其实际应用的缺点。比如，基于现代启发式算法的优化设计系统效率
比较低，而基于梯度信息的优化设计系统往往只能得到局部最优解。但本文第一
章中已经论述过：如果初始构型的性能较好，那么上述两个问题的严重程度将会
得到一定程度的缓解。因此，如果能在正式开始优化设计之前采取某种高效的方
法在一定程度上提升初始构型的气动性能，那么随后的优化设计过程将会变得更
为容易。
 
反设计方法已非当前气动设计中的主流方法，但其优点使得反设计方法具有
实现上述构想的潜力，当然，事先需要对其固有缺点可能造成的不利影响进行评
估。事实上，反设计方法四个固有缺陷（见 
1.1.1 
小节）中的第一个（需要给定
气动性能优秀的目标压力分布的缺陷）及第三个（不能选用除压力分布或速度分
布之外的设计目标的缺陷）对于上述构想的实现影响并不大。其原因在于：首先
，在上述设想中并不要求反设计方法一步到位地设计出气动性能极为优秀的构型
，所以对反设计中所给定的目标压力分布要求也不是特别高，只需其对应的气动
性能好于初始构型即可；其次，了解各种压力分布所对应的大致气动特性是从事
气动外形设计的工作者必备的基本技能，所以面对一个压力分布指出其大致的改
进方向在实际中并不难。
 
综上所述，如果反设计方法能够在给定的目标压力分布不太合理的情况下仍
然能正常工作，甚至在设计中能考虑几何与气动方面的约束，则可将其与优化设
计方法结合，形成高效、可靠的气动设计系统。其中，在给定的目标压力分布不
合理的情况下仍然能正常工作尤为重要，因为设计人员给出目标压力分布的方式
往往是直接对已有构型的压力分布进行部分修改，这样给出目标压力分布往往是
没有真实气动外形与之对应的，也就是不太合理的。其理由为：基本不存在两个
不同的气动外形在同一个状态下的表面压力分布只有一部分存在差异而其它部
分完全相同。
 
2004 
年，麻省理工的 
Bui-Thanh 
等人发明的全新气动外形反设计方法
—
Gappy  POD 
反设计方法彻底克服了传统反设计方法在目标压力分布不合理时
鲁棒性差的缺点，从而为实现反设计方法与优化方法结合的设计策略提供了契机
。
 
4.1 Gappy POD 
反设计方法
 
Gappy POD 
反设计方法由 
Gappy POD 
算法发展而来，故在介绍 
Gappy POD西北工业大学博士学位论文
 
56 
 
反设计方法之前首先需要对 
Gappy POD 
算法进行介绍。
 
4.1.1 Gappy POD 
方法
 
Gappy POD 
是一种用于修复缺失了部分数据系统的方法，最早由 
Everson 
等
人
[106
为了进行图像修复而提出。
Gappy POD
方法的基本原理为：假设某系统由 
M
个
n 
维向量
{ :1 }
i
U
£
i 
£
M 
组成，每个向量称之为一个快照，
i
j
u 
为第 
i 
个快照中的
第 
j 
个元素，另设第 
M 
个快照 
U
M 
中有 
h(h n)
< 
个元素未知，称之为缺陷快照
(Gappy  snapshot)
。为了估计出缺陷快照中 h
 个元素的近似值，首先根据式
(4-1)
将缺陷快照在形式上修复完整。
 
1
1
1
1
M
M l
j j
l
u u
M
-
=
=
-
å 
                        (4-1) 
其中
M
j
u 
为缺陷快照中的第 
j 
个未知元素。然后采用如下的迭代方法即可得到所
有h个未知元素的近似值。
 
1)  采用标准 
POD 
方法求得所有 
M 
个快照所张成线性空间的一组基模态
{ :1 , }
i
Φ
£
i 
£
P P 
£
M 
；
 
2)  用主要基模态线性拟合缺陷快照，拟合结果记为 
U
%
M 
；
 
3)  按如下规则对缺陷快照进行更新：如果该快照中的第 
j(1 
£
j 
£
n) 
个元素
在初始时是未知的，则用
U
%
M 
中的第 
j 
个元素替换，否则保持不变；
 
4)  判断迭代是否收敛。若收敛，则停止迭代并输出缺陷快照中事先未知的 
h
个元素的最新值；否则返回第 
1 
步。
 
第 
4 
步中的收敛准则为：缺陷快照中事先未知的h个元素的估计值在前后两个迭
代步之间的差异小于设定的阀值，或迭代步数达到设定的上限。第 
2 
步中的主要
基模态可用本文 
3.2.1 
小节中介绍的 
99%
广义能准则来确定。主要基模态拟合缺
陷快照的方法为最小二乘法，具体求解过程为：令主要基模态的数量为 
Z 
，所有
M 
个快照的平均为 
U 
，则 
U
M 
可表示为：
 
1
Z
M i M
i
i
b
=
U
» 
å 
Φ
+ 
U
= 
U
%
                     (4-2) 
令 
[ ]
1 2
= , , ,
T
Z
b
b b 
L
b 
，则 
b
可通过求解线性方程组 
Hb = F 
求得。其中： 
H 
为一个
Z 
´
Z 
的实对称矩阵，其第 k
 行、
l 列的元素为
k l
kl
H 
= 
Φ 
, 
Φ 
；
F
为一个 
Z 
维向量
，其第k个元素为
M k
k
f = U , 
Φ 
。因为
1
|
i P
k
=
Φ 
为一组单位正交基，有：
 
0 ( )
=
1 ( )
k l
kl
k l
H
k l
ì¹
= 
í
=
î
Φ 
,
Φ 
                   (4-3) 第四章
  Gappy POD  
反设计方法改进及应用
 
 
57
 
 
故：
 
,
( 
1,2, ,
)
i i
b 
=
f i 
= 
L
Z  
                   (4-4) 
4.1.2 Gappy POD 
反设计方法
 
如果将一个气动外形及其表面压力分布视作一个快照，则在气动反设计问题
中，给定的目标压力分布及其对应的气动外形即为一个缺陷快照，因为这里的气
动外形是事先未知的。除了缺陷快照之外，如果还有其它一些完整的快照，则可
以采用 
Gappy  POD 
方法估计出目标压力分布对应的气动外形。上述思路即为
Gappy POD 
反设计方法的基本原理。令
T
Cp 
为目标压力分布向量，完整的 
Gappy 
POD 
气动反设计过程如下：
 
1)  采样阶段：在一个初始气动外形的基础上用一定的参数化方法对其进行
扰动，以生成一定数量的不同气动外形，然后采用压力分布求解器计算
出每个气动外形的表面压力分布；
 
2)  组装快照：将每个气动外形与其表面压力分布组成一个快照。令向量 
Y
i
为第
i 
个快照的气动外形，
i
Cp 
为第 
i 
个快照的表面压力分布，则第 
i 
个快
照
U
i 
的表达式为
 
i
i
i
é ù
= 
ê ú
ê
ë
ú
û
Y
U
Cp
                           (4-5) 
3)  反设计阶段：将目标压力分布
T
Cp 
视作是一个缺陷快照
G
U 
中的已知部
分，采用标准 
Gappy POD 
方法估算出
T
Cp 
对应的气动外形
T
Y 
。
 
从 
Gappy  POD 
反设计方法的基本原理及具体设计过程可以看出此方法具有
以下优点：
 
1
、
Gappy POD 
反设计方法实际上是在最小二乘意义下利用一定数量快照（
即样本）的线性组合逐步拟合出目标压力分布所对应的气动外形。其反设计过程
与表面压力分布求解器完全无关，所以能和任意压力分布求解器相结合，适用性
非常广；
 
2
、只要压力分布和气动外形能够组成一个快照即可采用此方法进行反设计
。因此，
Gappy POD 
反设计方法对二维和三维问题是完全通用的；
 
3
、当给定的目标压力分布并不真实存在时，理论上 
Gappy POD 
反设计方法
会逐步拟合出快照空间中表面压力分布较为接近目标压力分布的气动外形，而不
会出现因计算无法收敛而给不出任何结果的情况。
 
下面通过亚音速翼型及跨音速翼型的反设计算例来验证 
Gappy  POD 
反设计西北工业大学博士学位论文
 
58 
 
方法的可行性。亚音速设计算例为：根据 
NACA-2412 
的表面压力分布从
NACA-0012 
反设计出 
NACA-2412 
翼型；跨音速算例为：根据 
RAE-5212 
的表面
压力分布从 
RAE-2822 
反设计出 
RAE-5212 
翼型。图 
4.1(a)
为 
NACA-0012 
翼型与
NACA-2412 
翼型的几何外形对比，图 
4.1(b)
为两翼型在马赫数 M
a 
=
0.2 、雷诺数
6
Re 
=
4.5 
´
10 
、升力系数 C
l 
=
0.5时的表面压力分布对比，压力分布求解器为 
Xfoil
。图 
4.2(a)
为 
RAE-2822 
翼型与 
RAE-5212 
翼型的几何外形对比，图 
4.2(b)
为两翼
型在马赫数 M
a 
=
0.72 、雷诺数 
6
Re 
=
5.6 
´
10 
、迎角
a =
2.8 
°
时的表面压力分布对
比，压力分布求解器为翼型跨音速气动力快速评估程序。
 
  
(a)  
几何外形
                           (b)  
压力分布
 
图 
4.1 NACA-0012 
翼型与 
NACA-2412 
翼型的几何外形及表面压力分布对比
 
  
(a)  
几何外形
                           (b)  
压力分布
 
图 
4.2 RAE-2822 
翼型与 
RAE-5212 
翼型的几何外形及表面压力分布对比
 
亚音速翼型反设计算例中的快照生成过程如下：在 
NACA-0012 
翼型的上下
表面各布置 
13 
个 
Hicks-Henne 
鼓包对其进行随机扰动，生成 
74 
个外形各异的翼
型。然后采用 
Xfoil 
计算出这些翼型在设计状态下的表面压力分布，并将翼型表
面离散点的纵坐标与离散点上的压力系数组合成快照。跨音速翼型反设计算例中
的快照生成过程如下：在 
RAE-2822 
翼型的上下表面各采用 
9 
阶 
CST 
鼓包进行
随机扰动，生成 
74 
个外形各异的翼型。然后采用翼型跨音速气动力快速评估程
序计算出这些翼型在设计状态下的表面压力分布，并将翼型表面离散点的纵坐标第四章
  Gappy POD  
反设计方法改进及应用
 
 
59
 
 
与离散点上的压力系数组合成快照。
 
图 
4.3(a)
为亚音速算例中反设计出的翼型与 
NACA-2412 
翼型的对比，从图
中可以看出反设计结果与目标压力分布对应的真实翼型是非常吻合的。图 
4.3(b)
为反设计翼型的真实表面压力分布与目标压力分布的对比，显然两者也是吻合得
比较好的。图 
4.4(a)
为跨音速算例中反设计出的翼型与 
RAE-5212 
翼型的对比，
图 
4.4(b)
为反设计翼型的真实表面压力分布与目标压力分布的对比。与亚音速反
设计算例结果类似，这里无论是设计出的翼型还是其表面压力分布均与真实结果
吻合得较好。上述两个算例说明：当目标压力分布比较合理时 
Gappy  POD 
反设
计方法是可行的。
 
  
(a)  
翼型对比
                           (b)  
压力分布对比
 
图 
4.3 Gappy POD 
反设计结果与 
NACA-2412 
翼型的对比，及反设计翼型的真实压力分布与
目标压力分布的对比
 
  
(a)  
翼型对比
                           (b)  
压力分布对比
 
图 
4.4 Gappy POD 
反设计结果与 
RAE-5212 
翼型的对比，及反设计翼型的真实压力分布与目
标压力分布的对比
 
为了检验 
Gappy  POD 
反设计方法在目标压力分布不太合理时的鲁棒性，分
别将 
NACA-2412 
与 
RAE-5212 
在设计状态下的表面压力分布修改为如图 
4.5(a)
、
4.5(b)
所示的样子，然后再基于上一算例中的完整快照进行反设计。设计过程
表明：对于如此不合理的目标压力分布，
Gappy  POD 
反设计方法仍然能够正常西北工业大学博士学位论文
 
60 
 
运行并给出设计结果。图 
4.6(a)
为基于修改后的 
NACA-2412 
表面压力分布反设
计出的翼型与 
NACA-2412 
翼型的对比，从图中可以看出两翼型几何外形之间的
差异是相当大的。图 
4.6(b)
为反设计翼型的真实表面压力分布与目标压力分布的
对比。从图中可以看出：虽然两者之间的差异也很大，但反设计翼型上表面后半
部分及下表面中间部分的压力分布还是与目标压力分布吻合得比较好的。图
4.7(a)  
为基于修改后的 
RAE-5212 
表面压力分布反设计出的翼型与 
RAE-5212 
翼
型的对比，显然这里反设计出的翼型与 
RAE-5212 
是比较接近的。图 
4.7(b)
为反
设计翼型的真实表面压力分布与目标压力分布的对比。从图中可以看出：如果将
目标压力分布上不规则的锯齿看做是一种随机扰动，那么反设计翼型的表面压力
分布基本上就是将这种随机扰动消除之后的效果。因此，从统计平均的角度来说
，反设计结果与目标压力分布是吻合得比较好的。在这种理解下，反设计出的翼
型与 
RAE-5212 
较为接近就不足为奇了。
 
上述两个算例说明：当目标压力分布非常不合理时 
Gappy  POD 
反设计方法
仍然能够正常运行且能给出压力分布总体上尽可能接近目标压力分布的设计结
果。
 
  
(a) NACA-2412                          (b) RAE-5212 
图 
4.5 NACA-2412 
翼型及 
RAE-5212 
翼型表面压力分布修改前后对比
 
  
(a)  
翼型对比
                          (b)  
压力分布对比
 
图 
4.6   NACA-2412 
翼型表面压力分布修改后 
Gappy POD 
反设计结果与 
NACA-2412 
翼型的
对比，及反设计翼型的真实压力分布与目标压力分布的对比
 第四章
  Gappy POD  
反设计方法改进及应用
 
 
61
 
 
  
(a)  
翼型对比
                          (b)  
压力分布对比
 
图 
4.7   RAE-5212 
翼型表面压力分布修改后 
Gappy POD 
反设计结果与 
RAE-5212 
翼型的对
比，及反设计翼型的真实压力分布与目标压力分布的对比
 
4.2 Gappy POD 
反设计方法的改进
 
基于对 
Gappy  POD 
反设计方法各个步骤特点的分析，本文对此方法的采样
过程及迭代过程进行了旨在提高设计精度的改进，以下是本文改进的具体情况。
 
4.2.1 
最优快照替换采样法
 
从 
Gappy  POD 
反设计方法的基本原理来看，此方法采样阶段中随机生成的
气动外形对设计结果至关重要，因为反设计出来的气动外形即来自于这些气动外
形的线性组合。因此，如果采样阶段随机生成的气动外形总体上与目标压力分布
对应的气动外形较为接近，那么设计结果就会更好。基于这一原理，本文提出了
一种最优快照替换采样法以使采样阶段生成的气动外形总体上尽可能地接近目
标压力分布对应的气动外形。这种采样法与原始采样法的主要差别在于：在采样
过程中每得到一个气动外形及其对应的压力分布即评估其压力分布与目标压力
分布之间的差异，如果此气动外形的压力分布比已生成的气动外形或者初始气动
外形的压力分布更接近目标压力分布，那么用此气动外形取代初始气动外形作为
参数化方法扰动的新基准外形。显然最优快照替换采样法的核心思想即为通过不
断使用离精确解更近的气动外形作为参数化方法扰动的新基准外形，使得生成的
样本气动外形总体上更加接近目标压力分布对应的气动外形。
 
为了检验新采样方法的实际效果，用此方法重新生成上一节算例中反设计
NACA-2412 
时的样本翼型，然后分别用新样本翼型的线性组合与老样本翼型的
线性组合拟合 
NACA-2412
。通过对比拟合结果与 
NACA-2412 
的接近程度即可对
比出两种采样方法的优劣。样本翼型拟合 
NACA-2412 
时的线性叠加系数由 
4.1.1
小节中介绍的最小二乘法求得。图 
4.8 
为两种采样方法采集的样本翼型拟合
NACA-2412 
的结果对比，图 
4.9 
为两个拟合翼型与 
NACA-2412 
之间的误差对比西北工业大学博士学位论文
 
62 
 
，其中误差的定义为：翼型表面弦向位置相同的点纵坐标之差的绝对值。从图中
可以看出，新样本翼型拟合出的结果较之原始样本翼型拟合的结果明显更加接近
NACA-2412
，说明本文提出的采样方法所采集的翼型与目标压力分布对应的翼
型总体上更加接近。
 
 
图 
4.8  
不同采样方法采集的样本翼型拟合 
NACA-2412 
的结果对比
 
  
(a)  
上表面
                              (b)  
下表面
 
图 
4.9 
不同采样方法采集的样本翼型拟合 
NACA-2412 
的误差对比
 
4.2.2 
迭代过程中目标压力分布的修正
 
在使用 
Gappy  POD 
方法进行反设计的过程中，每迭代一次均会产生一个由
主要基模态线性叠加而成的向量（即 
Gppy POD 
方法迭代流程第 
2 
步中的 
M 
¢
向
量），此向量中包含一个气动外形及一个压力分布。不难推断：这里的气动外形
来自样本气动外形的线性组合；而压力分布来则自于样本气动外形压力分布的线
性组合，且两个线性组合的系数是一样的。因为压力分布与气动外形之间的关系
是高度非线性的，所以 
Gappy  POD 
反设计每个迭代步中所产生的压力分布并不
是所产生气动外形的真正压力分布。基于这一点，本文提出了一种方法对 
Gappy 
POD 
反设计迭代过程中的目标压力分布进行实时修正，以使得设计结果更加精
确。
 
假设第
i 
个迭代步产生的压力分布为
i
Cp 
，所产生的气动外形的真实压力分
布为
i,R
Cp 
，那么我们可以近似认为：
i,R i
Cp
- 
Cp 
为
Gappy POD 
反设计每个迭代
步拟合出的压力分布的误差。也就是说：为了让拟合出的压力分布是拟合出的气
动外形的真实压力分布，每次迭代所产生的压力分布应该是
i,R
Cp 
，然而由于第四章
  Gappy POD  
反设计方法改进及应用
 
 
63
 
 
Gappy POD 
方法的误差，却得到了
i
Cp 
。换个角度看待上述现象：如果要让每次
迭代产生的气动外形的真实压力分布为
i,R
Cp 
，则需要将压力分布的拟合目标设
置为
, ,
( )
i R i R i i
Cp
- 
Cp
- 
Cp
= 
Cp 
。同理，为了让每次迭代产生的气动外形的真实
压 力 分 布 为 目 标 压 力 分 布
T
Cp 
， 则 可 以 将 目 标 压 力 分 布 修 改 为
,
( )
T i R i
Cp
- 
Cp
- 
Cp 
。这与用一支准心有问题的枪打靶一样，如果瞄准靶心射击
，则不能击中靶心，而是靶心附近的某个位置；反之为了击中靶心，则需要瞄准
靶心附近的某个位置射击。
 
令
i,G
Y 
为原始
Gappy  POD 
反设计方法第 
i 
个迭代步结束后缺陷快照
G
U 
中的
气动外形部分，i
 
=
0时
0,G
Y 
为所有样本气动外形的平均。初始时i
 
=
1，则引入目
标压力分布修正后的 
Gappy POD 
反设计迭代过程为：
 
采用标准 
POD 
方法求得包括缺陷快照在内的所有快照所张成线性空间的一组基
模态；
 
1)  用主要基模态线性拟合缺陷快照
i,G
G
T
é ù
=
ê ú
ë û
Y
U
Cp
，拟合结果记为
i
i
i
é ù
=
ê ú
ë û
Y
U
Cp
；
 
2)  采用压力分布求解器计算出气动外形
i
Y 
的真实压力分布
i,R
Cp 
；
 
3)  将缺陷快照修改为
,
,
( )
i G
G
t i R i
é ù
= 
ê ú
- -
ë û
Y
U
Cp Cp Cp
，然后用主要基模态对其进
行线性拟合，拟合结果记为
,
,
,
i C
i C
i C
é ù
= 
ê ú
ë û
Y
U
Cp
；
 
4)  若迭代收敛或已达到最大迭代步，则停止计算，将
i,C
Y 
作为最终设计结
果输出；否则执行下一步；
 
5)  i 
=
i 
+
1，
i
+
1,G i,C
Y
= 
Y 
，
i1,G
G
T
+
é ù
=
ê ú
ë û
Y
U
Cp
转到第 
1 
步。
 
4.2.3 
改进方法设计精度检验
 
采用改进后的 
Gappy POD 
反设计方法重复 
4.1.2 
小节中的两个算例，以检验
改进后的方法在设计精度方面的提升程度。因引入目标压力分布修正后每完成一
次迭代都需要调用一次压力分布求解器，所以为了保证结果的可比性，在两个算
例中均只用最优快照替换采样法采集 
64 
个样本，同时设置反设计的最大迭代步
数为 
10 
步，以保证改进后的方法在整个设计过程中最多只调用 
74 
次压力分布求
解器，不会超过原始方法设计时调用压力分布求解器的次数。
 
图 
4.10(a)
、
(b)
分别为亚音速翼型算例中两种方法设计出的翼型对比及两种
方法所设计翼型表面压力分布的对比。图 
4.11(a)
、
(b)
分别为跨音速翼型算例中西北工业大学博士学位论文
 
64 
 
两种方法设计出的翼型对比及两种方法所设计翼型表面压力分布的对比。从图中
可以看出：改进方法设计出的翼型较之原始方法设计出的翼型更加接近目标压力
分布对应的真实翼型，而改进方法所设计翼型的表面压力分布也更加接近目标压
力分布。尤其是在亚音速翼型设计算例中，改进方法设计出的翼型及其压力分布
基本已经与真实结果重合了。
 
上述算例证明：在调用压力分布求解器次数不增加的情况下，本文对 
Gappy 
POD 
反设计方法所作的改进能显著提升设计结果的精度。
 
  
(a)  
翼型对比
                           (b)  
压力分布对比
 
图 
4.10 Gappy POD 
反设计方法改进前后对 
NACA-2412 
反设计结果的对比
 
  
(a)  
翼型对比
                           (b)  
压力分布对比
 
图 
4.11 Gappy POD 
反设计方法改进前后对 
RAE-5212 
反设计结果的对比
 
4.3  
反设计与优化相结合的跨音速翼型设计
 
改进的 
Gappy POD 
反设计方法精度高于原始 
Gappy POD 
反设计方法，且具
备了与优化方法结合的基本条件，故可将其与优化设计方法组合起来实现本章引
言中的组合设计策略。以下将通过对一个简单的算例来检验这种组合策略的有效
性。
 
采用改进的 
Gappy  POD 
气动反设计方法分别与基于代理模型的全局型气动
外形优化系统及基于梯度信息的气动外形优化系统相结合对
RAE-2822
翼型进行第四章
  Gappy POD  
反设计方法改进及应用
 
 
65
 
 
优化。设计状态为：马赫数 M
a 
=
0.72 ，雷诺数 
6
Re 
=
5.6 
´
10 
，迎角
a =
2.8 
°
；优
化目标为升阻比最大。此外，分别采用两种优化系统直接对 
RAE-2822 
翼型进行
优化，然后对同一优化系统结合反设计方法前后的设计结果进行对比。
 
4.3.1 
旨在削弱激波的反设计
 
对于与反设计相结合的优化系统，需要事先由反设计方法设计出一个比初始
构型性能更好的构型。为此，采用改进的 
Gappy  POD 
反设计方法对 
RAE-2822
进行旨在削弱激波的反设计。图 
4.12 
为 
RAE-2822 
在设计状态下的压力分布与反
设计中设定的目标压力分布的对比，其中 
RAE-2822 
的压力分布由本文第二章中
介绍的翼型跨音速气动特性快速评估程序求得。从图中可以看出：在设计状态下
RAE-2822 
上表面的激波是比较强的，给定的目标压力分布则将此激波抹平了，
但并没有改变其它位置处的压力分布。可以推断：这样给定的目标压力分布很可
能是不合理的，即很可能在设计状态下是没有翼型与之对应的。但如果反设计程
序在设计过程中努力向图 
4.12 
中给定的目标压力分布靠近，则设计结果的激波
相对于 
RAE-2822 
的激波必然能显著削弱。
 
在正式开始反设计前先使用 
9 
阶 
CST 
参数化方法对 
RAE-2822 
进行扰动生
成 
70 
个样本翼型，然后使用翼型跨音速气动特性快速评估程序计算所有样本翼
型在设计状态下的表面压力分布，最后将样本翼型表面离散点的纵坐标及压力系
数组装成 
70 
个快照。反设计的最大迭代步数设置为 
30
。图 
4.13 
为反设计结果与
RAE-2822 
的对比，从图中可以看出反设计结果相对于 
RAE-2822 
的最大变化在
于翼型上表面前半部分变得更薄。图 
4.14 
为反设计结果的表面压力分布与
RAE-2822 
表面压力分布及目标压力分布的对比，虽然反设计结果的表面压力分
布未能很好地贴合目标压力分布，但相对 
RAE-2822 
的表面压力分布其激波强度
还是显著减弱了。图 
4.15 
为 
RANS 
方程求解器计算的 
RAE-2822 
与反设计结果
的表面压力分布对比，相对于翼型气动特性快速评估程序的计算结果，显然图中
两个翼型的激波强度都有所减弱，尤其是反设计结果的激波已趋于消失。
RANS
方程求解器评估得到的 
RAE-2822 
及反设计结果在设计状态下的升阻比分别为
68.29 
和 
79.41
。显然，针对削弱初始构型的激波、为优化设计系统提供一个优于
初始构型的反设计是相当成功的。
 
需要特别指出的是，因为压力分布求解器为翼型跨音速气动特性快速评估程
序，所以在一台 
CPU 
主频为 
3.4GHz 
的个人计算机上单线程完成整个反设计过程
只需大约 
240 
秒，仅相当于 
RANS 
方程求解器多线程并行计算一个二维翼型流
场所需的时间。可见，上述反设计过程不仅效果好，而且效率也非常高。
 西北工业大学博士学位论文
 
66 
 
  
图 
4.12 RAE-2822 
表面压力分布及目标压力
分布 
图 
4.13  
反设计结果与 
RAE-2822 
的对比 
  
图 
4.14  
反设计结果表面压力分布与
RAE-2822 
表面压力分布及目标压力分布的
对比 
图 
4.15 RANS 
方程求解器计算的 
RAE-2822
与反设计结果的表面压力分布对比 
 
4.3.2 
基于优化系统的精细设计
 
首先进行基于代理模型的全局型优化系统在与反设计方法结合前后的设计
效果对比。为此，采用该优化系统分别基于 
RAE-2822 
与上一小节中的反设计结
果进行设计状态下的翼型升阻比最大化设计。两设计过程除了基础翼型外其它设
置完全相同，具体为：参数化方法为 
CST 
参数化方法，设计变量个数为 
12 
个；
代理模型方法为 
Kriging 
代理模型，初始样本个数为 
200 
个，采用 
RASN 
方程求
解器对样本气动特性进行评估；
ADMPDE 
算法的种群规模为 
60
，优化代数为 
100
，局部增强因子为 
0.2
，变异因子与交叉因子的下限均为 
0.1
，上限均为 
0.9
；优
化过程中的代理模型管理框架为紧密式代理模型管理框架，具体管理代理模型的
方法为：从每代种群中挑选出适应度最大的个体与预测方差最大的个体进行校核
计算，然后将校核计算结果加入到样本集中，最后对 
Kriging 
代理模型进行更新
。
 第四章
  Gappy POD  
反设计方法改进及应用
 
 
67
 
 
基于构建好的初始代理模型，将两个优化过程重复十次，表 
4.1 
为两优化过
程在这十次优化中得到的最优结果对比。从表中可以看出，在反设计结果上进行
的优化较之在 
RAE-2822 
上进行的优化总能得到更好的结果，且十次优化最优结
果的标准差也小得多。说明，基于反设计结果进行的优化不仅寻优能力强，而且
寻优能力也更稳健。图 
4.16 
为基于 
RAE-2822 
进行的第 
7 
次优化与基于反设计结
果进行的第 
5 
次优化的优化算法收敛历程对比，这两次优化得到的结果分别为两
优化过程在十次优化中的最佳结果。显然，相对基于 
RAE-2822 
的优化，基于反
设计结果的优化只需其一半的优化代数即可达到收敛，且收敛的结果也更好。图
4.17(a)
为这两次优化得到的翼型及 
RAE-2822 
之间的几何外形对比；图 
4.17(b)
为这三个翼型在设计状态下的表面压力分布对比。从图中可以看出，两个优化翼
型在设计状态下的压力分布形态非常相似，上表面已不存在激波，但基于反设计
结果的优化结果在设状态下的升力更大。
 
该算例表明：基于现代启发式算法与代理模型的气动外形优化系统与基于快
速气动特性评估的反设计方法相结合能显著提升优化效率，且能得到更好的优化
结果。
 
表 
4.1 
基于不同初始构型的十次优化结果对比
 
实验编号
  
基于 
RAE-2822  
基于反设计结果
 
1 
79.86  81.62 
2 
80.05  80.63 
3 
78.64  80.78 
4 
79.08  81.65 
5 
80.96  81.73 
6 
80.52  81.69 
7 
81.06  81.45 
8 
80.23  81.54 
9 
80.42  81.36 
10 
79.88  81.18 
均值
 
80.07  81.36 
标准差
 
0.58  0.15 西北工业大学博士学位论文
 
68 
 
 
图 
4.16  
基于不同初始构型的优化收敛历程对比
 
  
(a)  
翼型对比
                           (b)  
压力分布对比
 
图
  4.17  
基于不同初始构型的优化结果对比
 
在检验了基于现代启发式算法与代理模型的气动外形优化系统结合反设计
方法的效果后，进一步检验基于梯度信息的优化系统与反设计方法结合的效果。
为此，采用本文第二章构建的基于梯度信息的优化系统分别在 
RAE-2822 
与上一
小节反设计结果的基础上进行设计状态下的翼型升阻比最大化优化。两个优化过
程除了初始构型不同其它设置完全相同，具体设置为：参数化方法为 
FFD 
参数
化方法，设计参数共 
12 
个，优化停止的标准为：相邻两个搜索步的升阻比之差
绝对值小于 
0.02
。
 
图 
4.18 
为两优化过程中目标函数值随搜索步的变化曲线对比，其中基于
RAE-2822 
的优化过程共搜索了 
19 
次才达到收敛，其最优目标函数值为 
80.74
；
而基于反设计结果的优化过程只搜索了 
7 
次即达到收敛，其最优目标函数值为
81.48
。显然，基于反设计结果的优化搜索不仅效率远远高于基于 
RAE-2822 
的优
化搜索，而且优化结果更好。图 
4.19(a)
为两优化搜索最终得到的翼型及 
RAE-2822
之间的几何外形对比；图 
4.19(b)
为这三个翼型在设计状态下的表面压力分布对第四章
  Gappy POD  
反设计方法改进及应用
 
 
69
 
 
比。从图中可以看出，基于反设计结果优化得到的翼型上表面已不存在激波，而
基于 
RAE-2822 
优化得到的翼型上表面仍然存在较弱的激波。
 
此算例表明：基于梯度信息的气动外形优化系统与基于快速气动特性评估的
反设计方法相结合同样能显著提升优化效率，且能得到更好的优化结果。
 
 
4.18  
基于不同初始构型的优化目标函数值随搜索步的变化曲线对比
 
  
(a)  
翼型对比
                           (b)  
压力分布对比
 
图 
4.19  
基于不同初始构型的优化结果对比
 
  
 西北工业大学博士学位论文
 
70 
 
 
  第五章
  
缩短流场求解时间的新思路及方法
 
 
71
 
 
第五章
  
缩短流场求解时间的新思路及方法
 
在基于现代启发式算法的气动外形优化过程中存在一个显著的特点：需要对
大量气动外形各异的构型进行流场求解以获得对应的气动力。但是，相对于气动
优化过程中的其它操作，高精度的流场求解是最为费时的。
Marian
 [146]
的研究表
明：在一个采用了离散伴随求解器的气动外形优化过程中，
71%
的时间被耗费在
了 
CFD 
运算上。显然，在使用现代启发式算法的优化体系中流场求解所需的时
间将更多。因此，尽可能地减少流场求解所需时间成为当今气动外形优化研究中
的一个重要方向。
 
为了减少气动优化过程中流场求解所需时间，一种广泛的处理方法是采用计
算量很小的代理模型代替求解器直接进行气动力的预测。但是，在使用代理模型
的气动优化过程中有两个环节仍然需要对一定数量的构型采用 
CFD 
求解其气动
力：第一个环节为优化正式开始之前的采样环节，第二个环节为优化过程中的代
理模型样本更新环节。更为关键的是，要获得预测精度令人满意的代理模型，构
建代理模型所需的样本个数与设计变量的个数大体上应成指数函数关系。这就使
得对于稍微复杂一点的气动外形优化设计问题，例如三维翼身组合体的气动外形
优化，即便使用代理模型也需要进行数百次、甚至上千次的流场求解
[147]
显然，
在当前的技术体系下，进一步缩短气动优化中的流场求解时间仍然是非常有必要
的。
 
5.1  
优化过程中缩短单次流场求解时间的思路
 
缩短气动优化中流场求解时间的基本方法只有两个：一、减少流场求解的次
数；二、缩短每次流场求解的时间。显然，使用代理模型代替流场求解器属于第
一种方法。因此，如果能在第二种基本方法方面有所突破，则可以在代理模型的
基础上进一步缩短气动外形优化过程中的流场求解时间。而 
CFD 
流场求解的特
点以及代理模型的基本原理为具体实现第二种方法提供了一条思路。
 
众所周知，除了极个别特别简单的情况外，很难得到 
N-S 
方程的解析解
[148]
。因此，
CFD 
求解器在进行流场求解时都是采用数值迭代的方法进行，即：从
一个初始流场开始（一般都是处处与自由来流相同的均匀流场），按照一定的迭
代方法一步一步对流场进行更新、直至收敛。假如迭代正式开始前的初始流场就
已经比较接近最终的收敛流场了，那么极有可能能减少流场求解的迭代步数，进
而缩短单次流场求解的时间。实现这一想法的关键是：如何快速的在迭代正式开
始前就预测出比较接近最终收敛流场的初始流场？
 西北工业大学博士学位论文
 
72 
 
5.1.1  
基于几何相似的初始流场预测思路
 
不论是否采用代理模型，气动外形优化过程中存在一个不太引人注目的特征
，即：对大量较为相似的构型进行流场求解，而这些相似构型的流场也是较为相
似的。这里相似的概念是相对而言的，例如在一个翼型优化过程中，随机的取出
两个中间翼型，那么相对一个正方形、或者一个圆形而言这两个翼型的几何外形
是相似的。同样，相对于处处与远方自由来流相同的均匀流场而言，这两个翼型
的流场也是互相更为相似的。因此，在一个气动外形优化过程中，只要完成了第
一个构型的流场求解，那么这个构型的流场即可作为第二个构型的初始流场来加
速其流场求解的速度；如果已经求解出一定数量构型的流场，对于下一个需要进
行流场求解的构型，可以对比此构型与这些流场已知构型之间的几何外形相似程
度，挑选几何外形与其最为相似的构型的流场作为其流场迭代求解的初始流场。
显然，上述操作的理由是：几何外形更相似意味着其对应流场也更相似。从流形
学习的角度来说，这是有一定道理的。因为在气动外形优化过程中引起流场变
化的唯一原因就是几何外形的变化，即流场的本征维度就是几何外形的维度。
不过，几何外形与其对应流场之间的关系是通过 
N-S 
方程建立起来的复杂非线
性关系，通过直接对比几何外形之间的相似性来判断流场之间的相似性则是将这
种非线性关系简单地线性化了。但，从实用的角度来说，我们只是用这种简单的
线性关系为一个流场未知的构型快速地预估一个初始流场，只要这个初始流场比
均匀流场更为接近该构型的求解收敛流场那么它就可以被使用。
 
5.1.2  
基于代理模型的初始流场预测思路
 
进一步，如果我们能发展一种比上述方法更精确且计算效率仍然非常高的方
法来进行初始流场的预测，那么极有可能会进一步加速流场求解的过程。作为专
门用来代替难于求解的甚至未知的函数关系的代理模型方法显然具备实现上述
设想的潜力。因为代理模型能用简单、易于求解的函数代替原始复杂、难于求解
的函数并保持模拟精度大致相当。但是流场的高维、甚至超高维特性使得代理模
型难以直接被用于对流场进行预测，因为现有的代理模型方法从本质上来说只能
建立多输入、单输出类型的函数关系。如果在一个复杂系统里，有多个输出变量
，通常的做法是对所有输入变量与每个输出变量之间建立一个代理模型。这种做
法在输出变量较少时可行，但当输出变量达到数万乃至数百万的时候，使用代理
模型显然就会得不偿失，因为此时需要构建的代理模型的数量与输出变量的数量
相同。而用 
N-S 
方程求解出的离散流场的变量（注意：与建立 
N-S 
方程中流场
基本变量不是一个概念）个数通常就在这一范围之内，因为离散之后的流场的变
量个数为网格点数（或网格单元数）与 
N-S 
方程中流场基本变量个数的乘积。第五章
  
缩短流场求解时间的新思路及方法
 
 
73
 
 
因此，直接建立几何外形参数与对应流场之间的代理模型得不偿失—除非能把离
散流场的维度降低几个数量级。
 
在本文 
3.2 
节中已经介绍过 
POD 
方法和 
SVD 
方法均能实现高维数据的降维
，即一个维度很高的向量可以用少数维度与其一样的常向量的线性叠加来近似表
示。用数学公式表示为：
 
1
i
i c
m
b
i
» å+
=
U 
Φ 
U 
                       (5-1) 
其中，
U 
为被近似表示的高维向量， 
i
Φ 
与
c
U 
为维度与 
U 
相同的常向量，
m 
为 
i
Φ
的个数，通常它远小于
U 
的维度。上式为利用代理模型实现流场的快速预测提供
了思路：我们不必为流场中每个网格点或网格单元中心上的每个流场基本变量建
立一个代理模型，而只需对近似描述该流场的线性叠加表达式中的每个线性叠加
系数建立代理模型。
 
以一个网格点数为 
4
2.0 
´
10 
的二维流场为例，若流场求解器采用格点格式，
湍流模型采用一方程的湍流模型，则每个网格点上会产生 
5 
个流场基本变量，整
个离散流场的维度为 
5
1.0 
´
10 
。如果直接使用代理模型进行流场预测，则需要建
立 
5
1.0 
´
10 
个代理模型；而如果通过预测线性叠加系数的方法进行流场预测，则
需要建立的代理模型个数很可能只有 
1 2
10 ~ 10
量级。显然前一种情况非常不实用
，而后一种情况则显得简单可行。
 
5.2 
基于几何相似的初始流场预测
 
本节将开发具体的方法实现基于几何相似的初始流场预测思路，并对方法加
速流场求解速度的能力进行检验。
 
5.2.1 
流场预测方法
 
在一定数量的样本中对任意两个样本在某些方面进行相似性比较在统计学
中称为相似性度量
[149]
，样本之间的相似性通常用两个样本间的某种距离来表征
。假如在进行相似性度量时需要考虑
n
个指标值，那么可将每个样本当作
n
维空
间中的一个点，此样本的
n
个指标值即为其在
n
维空间中的坐标。在这种情况下
，两个样本之间的距离即为这两个样本点在
n
维空间中的距离。
 
当进行相似性度量的 
n 
个指标确定之后两个样本间的相似性仍然是不确定
的，因为
n
维空间中两点间距离的定义方式可以有很多种。在统计学中常用的距
离定义有明考夫斯基距离、马氏距离、兰氏距离及余弦角距离
[149]
。令
1 2
[ , , , ]
n T
i i i i
X
=
x x 
…
x 、
1 2
[ , , , ]
n T
j j j j
X
=
x x 
…
x 
分别为 
n 
维空间中的两个点，明考夫斯西北工业大学博士学位论文
 
74 
 
基距离的定义为：
 
1/
1
( )
n
q
k k q
ij i j
k
d x x
=
= 
å
- 
                         (5-2) 
当 
q 
=
2 
时明考夫斯基距离即为通常的欧氏距离。
 
设
n
维空间中共有 
N 
个样本点，则第
i 
个点与第 
j 
个点间的马氏距离定义为
：
 
1
( ) ( )
T
ij i j i j
d
-
= 
X
- 
X
å 
X
- 
X 
                    (5-3) 
式中， 
å
为 
N 
个样本不同分量的协方差矩阵（注意与样本间协方差矩阵相区别
）。相对明考夫斯基距离马氏距离具有以下优点：马氏距离考虑了不同维度之间
的相关性，即考虑了样本不同评价指标之间的相关性；同时马氏距离还消除了不
同评价指标的量纲对距离度量的影响，将样本数据进行线性变换后样本间的马氏
距离不变。因为上述优点，马氏距离在相似性度量中得到了广泛的应用。但马氏
距离只适用于样本个数大于样本维度（也就是样本分量数）的情况，因为当样本
个数小于样本维度之后变量协方差矩阵的逆矩阵是不存在的。
 
n 
维空间中两点
i
X 
、
j
X 
间的兰氏距离定义为：
 
1
1
k k
n
i j
ij 
k k
k i j
x x
d
n x x
=
-
=
+
å 
                         (5-4) 
兰氏距离同样能消除不同分量量纲对相似性度量的影响，但它仅适用于每个样本
的每个分量值都为正值的情况。此外，兰氏距离也没有考虑样本不同分量之间的
相关性。
 
1 2
[ , , , ]
n T
i i i i
X
=
x x 
…
x 除了可视为 
n 
维空间中的一个点外还可视为 
n 
维空间中
由原点指向该点的一个向量，而向量间是可以进行夹角度量的，据此可以定义两
个样本间的余弦角距离为：
 
,
arccos
i j
ij
i j
d
æ ö
=ç ÷
ç ÷
è ø
X X
X X
                         (5-5) 
其中，
( 
,
)
i j
X X 
为
i
X 
与
j
X 
间的内积，
i
X 
为由同一内积诱导的
i
X 
的模。
 
上述距离定义各有特点，在不同的问题中有不同的适用性。气动外形的几何
设计参数往往具有不同的量纲，例如描述机翼控制剖面外形的参数与描述控制剖
面扭转角的参数量纲就不同。马氏距离能很好地消除变量量纲的差异对相似性度
量的影响，且对变量取值范围没有要求，所以本文选用马氏距离作为两个气动外
形之间相似性的度量。但马氏距离要求样本个数大于样本的维度，当样本个数小第五章
  
缩短流场求解时间的新思路及方法
 
 
75
 
 
于样本维度的时候无法使用马氏距离，此时本文采用欧式距离作为两个气动外形
之间相似性的度量。
 
5.2.2 
预测初始流场加速流场求解的效果
 
本小节将通过对亚音速和跨音速工况下二维翼型定常流场的预测来测试基
于几何相似原则所预测的初始流场加速流场求解的效果。
 
5.2.2.1  
亚音速流场测试结果
 
亚音速流场预测算例的计算工况为：马赫数 M
a 
=
0.5，雷诺数 
6
Re 
=
4.0 
´
10
，迎角
a =
1
°
。采用 
FFD 
参数化方法在 
GA [W] 1-12 
翼型基础上进行随机扰动以
生成样本翼型与测试翼型，
GA [W] 1-12 
翼型及所构建的 
FFD 
控制框如图 
5.1 
所
示。图中 
FFD 
控制框最前端和最后端的控制点始终保持不动，实际扰动翼型几
何外形的只有中间的 
12 
个 
FFD 
控制点。在扰动过程中，
12 
个 
FFD 
控制点的横
坐标始终保持不变，故控制翼型几何外形的参数即为 
12 
个 
FFD 
控制点的纵坐标
。图 
5.2(a)
为 
GA  [W]  1-12 
翼型与这 
12 
个 
FFD 
控制点在给定的纵坐标变化范围
内能够生成的最厚翼型与最薄翼型的几何外形对比；图 
5.2(b)
为利用本文第二章
中介绍的 
RANS 
方程求解器计算得到的这三个翼型在计算工况下的表面压力分
布对比，湍流模型为一方程的 
S-A 
模型。
 
 
图 
5.1 GA [W] 1-12 翼型及其 
FFD 
控制框
 
   
(a)  
几何外形对比
                     (b)  
压力分布对比
 
图 
5.2 GA [W] 1-12 
翼型及参数化方法能够生成的最厚翼型与最薄翼型几何外形对比以及这
三个翼型在计算工况下的表面压力分布对比
 西北工业大学博士学位论文
 
76 
 
在给定的变化范围内，利用 
12 
个 
FFD 
控制点纵坐标的随机变化生成 
110 
个
扰动翼型，利用 
RANS 
方程求解器计算这 
110 
个扰动翼型在给定工况下的流场
。所有 
110 
个扰动翼型的网格点数与 
GA [W] 1-12 
翼型的保持一致，均为 
29893
，图 
5.3 
为 
GA [W] 1-12 
翼型的网格。
 
 
图 
5.3 GA [W] 1-12 
翼型计算网格
 
将 
110 
个扰动翼型中的前 
100 
个作为样本翼型，其对应流场作为样本流场，
将最后 
10 
个扰动翼型作为测试翼型，其对应流场作为测试流场。基于 
12 
个 
FFD
控制点纵坐标参数计算 
10 
个测试翼型与 
100 
个样本翼型间的马氏距离。将每个
测试翼型与 
100 
个样本翼型间最小的测地距离找出来即可得到与每个测试翼型
几何外形最为相似的样本翼型。在 
10 
个测试翼型的 
10 
个最小马氏距离中，第 
6
个测试翼型的最小马氏距离最小，由第 
6 
个测试翼型与第 
89 
个样本翼型间测得
；第 
10 
个测试翼型的最小马氏距离最大，由第 
10 
个测试翼型与第 
47 
个样本翼
型间测得。
 
第 
6 
个测试翼型与第 
89 
个样本翼型之间的几何外形对比如图 
5.4(a)
所示，
两翼型在计算工况下的表面压力分布对比如图 
5.4(b)
所示。两翼型在计算工况下
的流场马赫数云图分别如图 
5.5(a)
、
5.5(b)
所示。从上述几幅图的对比中可以看出
，第 
6 
个测试翼型与第 
89 
个样本翼型间无论是几何外形还是绕流流场都是非常
相似的。图 
5.6 
为直接使用求解器求解第 
6 
个测试翼型流场与使用第 
89 
个样本
翼型的流场作为初始流场求解第 
6 
个测试翼型流场在升力系数、阻力系数及力矩
系数收敛速度方面的对比，两个求解过程初始时间步长及时间步长变化策略完全
相同。为了能清楚地判断出两个求解过程的收敛迭代步数，图中只给出了最后
1000 
个迭代步的收敛情况。从图中可以看出，当使用第 
89 
个样本翼型的流场作
为流场求解的初始流场之后，第 
6 
个测试翼型的流场求解收敛过程显著加快。当
使用求解器直接求解流场时，第 
6 
个测试翼型的三个力系数完全收敛需要 
1200
个迭代步；而使用第 
89 
个样本翼型的流场作为初场时，三个力系数完全收敛则
只需要 
600 
个迭代步。即，使用基于几何相似准则预测的初始流场之后，第 
6
个测试翼型的流场求解速度能加快一倍。
 第五章
  
缩短流场求解时间的新思路及方法
 
 
77
 
 
  
(a)  
几何外形对比
                            (b)  
压力分布对比
 
图 
5.4  
第 
6 
个测试翼型与第 
89 
个样本翼型的几何外形对比及两翼型在计算工况下的表面压
力分布对比
 
   
(a)  
第 
6 
个测试翼型
                          (b)  
第 
89 
个样本翼型
 
图 
5.5  
第 
6 
个测试翼型在计算工况下的马赫数云图与第 
89 
个样本翼型在计算工况下的马赫
数云图
 
   
(a)  
升力系数
                (b)  
阻力力系数
              (c)  
力矩系数
 
图 
5.6  
直接使用求解器求解第 
6 
个测试翼型流场与使用第 
89 
个样本翼型流场作为初始流场
求解第 
6 
个测试翼型流场在升力系数、阻力力系数及力矩系数收敛速度方面的对比
 西北工业大学博士学位论文
 
78 
 
第 
10 
个测试翼型与第 
47 
个样本翼型之间的几何外形对比如图 
5.7(a)
所示，
两翼型在计算工况下的表面压力分布对比如图 
5.7(b)
所示。两翼型在计算工况下
的流场马赫数云图分别如图 
5.8(a)
、
5.8(b)
所示。从上述几幅图的对比中可以看出
，第 
10 
个测试翼型与第 
47 
个样本翼型之间的几何外形与绕流流场均很相似，但
其相似度不如第 
6 
个测试翼型与第 
89 
个样本翼型之间的相似度高。图 
5.9 
为直
接使用求解器求解第 
10 
个测试翼型流场与使用第 
47 
个样本翼型的流场作为初始
流场求解第 
10 
个测试翼型流场在升力系数、阻力系数及力矩系数收敛速度方面
的对比。与第 
6 
个测试翼型的情况类似，当使用基于几何相似准则预测的初始流
场之后，第 
10 
个测试翼型的流场求解速度也加快了一倍。
 
   
(a)  
几何外形对比
                           (b)  
压力分布对比
 
图 
5.7  
第 
10 
个测试翼型与第 
47 
个样本翼型的几何外形对比及两翼型在计算工况下的表面压
力分布对比
 
   
(a)  第 
10 
个测试翼型
                      (b)  
第 
47 
个样本翼型
 
图 
5.8  
第 
10 
个测试翼型在计算工况下的马赫数云图与第 
47 
个样本翼型在计算工况下的马赫
数云图
 第五章
  
缩短流场求解时间的新思路及方法
 
 
79
 
 
   
(a)  
升力系数
                (b)  
阻力力系数
              (c)  
力矩系数
 
图 
5.9  
直接使用求解器求解第 
10 
个测试翼型流场与使用第 
47 
个样本翼型流场作为初始流场
求解第 
10 
个测试翼型流场在升力系数、阻力力系数及力矩系数收敛速度方面的对比
 
5.2.2.2 
跨音速流场测试结果
 
跨音速流场预测算例的计算工况为：马赫数 M
a 
=
0.72 ，雷诺数 
6
Re 
=
5.4 
´
10
，迎角
a =
2.8
°
。采用 
FFD 
参数化方法在 
RAE-2822 
翼型基础上进行随机扰动以
生成样本翼型与测试翼型，
RAE-2822 
翼型及所构建的 
FFD 
控制框如图 
5.10 
所
示。与图 
5.1 
中的 
FFD 
控制框类似，这里 
FFD 
控制框最前端和最后端的控制点
也始终保持不动，而中间可运动的 
FFD 
控制点也只有纵坐标可以变化，所以扰
动翼型的参数仍然为 
12 
个。图 
5.11(a)
为 
RAE-2822 
翼型在这 
12 
个 
FFD 
控制点
在给定的纵坐标变化范围内能够生成的最厚翼型与最薄翼型的几何外形对比；图
5.11(b)
为利用本文第二章中介绍的 
RANS 
方程求解器计算得到的这三个翼型在
计算工况下的表面压力分布对比，湍流模型为一方程的 
S-A 
模型。
 
 
图 
5.10 RAE-2822 翼型及其 
FFD 
控制框
 
   
(a)  
几何外形对比
                          (b)  
表面压力分布对比
 
图
5.11 RAE-2822
翼型及参数化方法能够生成的最厚翼型与最薄翼型几何外形对比以及这三
个翼型在计算工况下的表面压力分布对比
 西北工业大学博士学位论文
 
80 
 
与亚音速流场测试一样，在给定的变化范围内，仍然利用 
12 
个 
FFD 
控制点
纵坐标的随机变化生成 
110 
个扰动翼型，利用 
RANS 
方程求解器计算这 
110 
个扰
动翼型在给定工况下的流场，湍流模型采用一方程的 
S-A 
模型。所有 
110 
个扰动
翼型的网格点数与 
RAE-2822 
翼型的保持一致，均为 
29434
，图 
5.12 
为 
RAE-2822
的网格。
 
 
图 
5.12 RAE-2822 
翼型计算网格
 
将 
110 
个扰动翼型中的前 
100 
个作为样本翼型，其对应流场作为样本流场，
将最后 
10 
个扰动翼型作为测试翼型，其对应流场作为测试流场。基于 
12 
个 
FFD
控制点纵坐标参数计算 
10 
个测试翼型与 
100 
个样本翼型间的马氏距离。在 
10
个测试翼型的 
10 
个最小马氏距离中，第 
6 
个测试翼型的最小马氏距离最小，该
距由第 
6 
个测试翼型与第 
23 
个样本翼型间测得；第 
3 
个测试翼型的最小马氏距
离最大，由第 
3 
个测试翼型与第 
45 
个样本翼型间测得。
 
第 
6 
个测试翼型与第 
23 
个样本翼型之间的几何外形对比如图 
5.13(a)
所示，
两翼型在计算工况下的表面压力分布对比如图 
5.13(b)
所示。两翼型在计算工况
下的流场马赫数云图分别如图 
5.14(a)
、
5.14(b)
所示。从上述图中可以看出，第 
6
个测试翼型与第 
23 
个样本翼型之间在几何外形、表面压力分布、空间流场马赫
数云图方面还是比较相似的。图 
5.15 
为直接使用求解器求解第 
6 
个测试翼型流
场与使用第 
23 
个样本翼型的流场作为初始流场求解第 
3 
个测试翼型流场在升力
系数、阻力力系数及力矩系数收敛速度方面的对比。从图中可以看出：使用基于
几何相似准则预测的初始流场后，第 
6 
个测试翼型的流场求解收敛迭代步数由
 
1500 
步减少到 
1000 
步。
 第五章
  
缩短流场求解时间的新思路及方法
 
 
81
 
 
   
(a)  
几何外形对比
                           (b)  
表面压力分布对比
 
图 
5.13  
第 
6 
个测试翼型与第 
23 
个样本翼型的几何外形对比及两翼型在计算工况下的表面压
力分布对比
 
   
(a)  
第 
6 
个测试翼型
                     (b)  
第 
23 
个样本翼型
 
图 
5.14  
第 
6 
个测试翼型在计算工况下的马赫数云图与第 
23 
个样本翼型在计算工况下的马赫
数云图
 
   
(a)  
升力系数
                (b)  
阻力力系数
              (c)  
力矩系数
 
图 
5.15  
直接使用求解器求解第 
3 
个测试翼型流场与使用第 
23 
个样本翼型流场作为初始流场
求解第 
3 
个测试翼型流场在升力系数、阻力力系数及力矩系数收敛速度方面的对比
 西北工业大学博士学位论文
 
82 
 
第 
3 
个测试翼型与第 
45 
个样本翼型之间的几何外形对比如图 
5.16(a)
所示，
两翼型在计算工况下的表面压力分布对比如图 
5.16(b)
所示。两翼型在计算工况
下的流场马赫数云图分别如图 
5.17(a)
、
5.17(b)
所示。从图中可以看出：虽然第 
3
个测试翼型与第 
45 
个样本翼型的几何外形较为相似，但其表面压力分布及空间
流场方面的相似性却非常低，这说明跨音速流场对几何外形的变化是非常敏感的
。图 
5.18 
为直接使用求解器求解第 
3 
个测试翼型流场与使用第 
45 
个样本翼型的
流场作为初始流场求解第 
3 
个测试翼型流场在升力系数、阻力力系数及力矩系数
收敛速度方面的对比。从图中可以看出，当使用第 
45 
个样本翼型的流场作为流
场求解的初始流场之后，第 
3 
个测试翼型的流场求解收敛过程基本不会加快。在
两种流场求解方式下，阻力系数均需 
1500 
个迭代步才能达到基本收敛。
 
   
(a)  
几何外形对比
                          (b)  
表面压力分布对比
 
图 
5.16  
第 
3 
个测试翼型与第 
45 
个样本翼型的几何外形对比
(a)
，及两翼型在计算工况下的
表面压力分布对比
(b) 
   
(a)  第 
3 
个测试翼型
                       (b)  
第 
45 
个样本翼型
 
图 
5.17  
第 
3 
个测试翼型在计算工况下的马赫数云图与第 
45 
个样本翼型在计算工况下的马赫
数云图
 第五章
  
缩短流场求解时间的新思路及方法
 
 
83
 
 
   
(a)  
升力系数
                (b)  
阻力力系数
              (c)  
力矩系数
 
图 
5.18  
直接使用求解器求解第 
3 
个测试翼型流场与使用第 
45 
个样本翼型流场作为初始流场
求解第 
3 
个测试翼型流场在升力系数、阻力力系数及力矩系数收敛速度方面的对比
 
5.3  
基于代理模型与 
POD 
的初始流场预测
 
本节将开发具体的方法实现基于代理模型的初始流场预测思路，并对方法加
速流场求解速度的能力进行检验。
 
5.3.1 
流场预测方法
 
设已经采用 
CFD 
方法求得了 
N 
个构型的流场，描述每个流场的基本变量个
数为 
z 
个，分别为
1 2 3
, , , ,
z
v v v 
×××
v 。所有流场均用拓扑相同、网格单元数相同的网
格进行离散，每套网格的网格单元数为
m 
。在这些已知信息的基础上，为了能够
使用式（
5-1
）进行流场预测，首先需要从一定数量的样本流场中分析出这些流
场的主要模态。
SVD 
方法虽然比 
POD 
方法的计算精度高，但本文在第 
3.2.3 
小
节中已经阐述过：当样本维度很高时 
SVD 
的计算效率非常低，而且对计算机内
存的要求也很高。因此，本文采用 
POD 
方法进行样本流场主要模态的提取。
 
在正式进行模态提取之前，需要将每个样本流场改写成向量的形式，否则无
法进行 
POD 
运算。在基于 
POD 
的流场控制方程降阶过程中，往往将每个样本流
场写为如下的单一向量形式：
 
1,1 1,2 1, 2,1 ,
[ , , , , , , ]
i i i i i i T
z m z
U
=
v v 
×××
v v 
×××
v                  (5-6) 
其中，
i 
为样本流场的编号，
( )
,
i
j k
v 
为第 k
 个基本流场变量在第 
j 
个网格点处的值。
这么做的目的是为了保证能将流场控制方程顺利的投影到流场主要基模态上。如
果不考虑流场控制方程向流场主要基模态的投影而只考虑数据降维的精度，上述
做法是不太合理的。因为，即使所有流场变量无量纲化之后流场中不同变量的量
级仍然可能会存在一定差异，且不同变量的主要特征在流场中的分布也很可能不
同。如果将每个流场按式
(5-1)
写为单一向量的形式，则很可能会导致某个量级较西北工业大学博士学位论文
 
84 
 
大的流场变量的主要特征分布会主导流场基模态的计算，这显然是不合理的。事
实上，
Colonius
  
等人
[150]
早就意识到了这种不合理性，并且尝试过在基于 
POD 
的
流场控制方程降阶过程中不将整个流场写为单一向量的形式。但在将流场控制方
程投影到流场基模态的过程中遇到了不可克服的障碍，最终他们的尝试以失败告
终。对于本文来说，完全不涉及到将流场控制方程投影到流场主要基模态上的过
程，故可以不用使用式
(5-1)
的形式对样本流场进行表达。根据前面的陈述，将每
个样本流场中不同的流场基本变量分开写到不同的单一向量中有利于提高流场
降维的精度。因此，本文将每个样本流场写为如下的多个单一向量形式：
 
 
1 1,1 2,1 ,1
2 1,2 2,2 ,2
1, 2, ,
[ , , , ]
[ , , , ]
[ , , , ]
i i i i T
m
i i i i T
m
i i i i T
z z z m z
v v v
v v v
v v v
= × × ×
= × × ×
= × × ×
U
U
U
M M
                     (5-7) 
即将每个样本流场中所有
m 
个网格点上相同的流场变量组成一个单一向量，而一
个完整的样本流场则由 
z 
个长度为
m 
的单一向量组成。因此，在使用 
POD 
方法
对 
N 
个样本流场进行模态提取之后，我们将得到 
z 
组基模态。
 
在使用 
POD 
提取物理场的基模态时，运算过程中的内积通常采用定义在
L
2
空间上的内积。但如果仅仅只是提取基模态，而不需要将流场的控制方程投影到
基模态上，则采用最常见的定义在欧式空间中的内积完全可行。在本文中，所有
POD 
运算中的内积均采用定义在欧式空间中的内积。
 
令
1
=( ) /
N
i
j j
i
N
=
U
å
U 
， 
i
= 
i
-
j j j
U
%
U U
，
( )
1
|
k N
j k 
=
Φ 
为采用 
POD 
方法从
1
|
i N
j i
=
U
%
张成的空
间中提取的一组正交基模态，本文称之为基模态流场。从线性代数的角度理解，
1
|
k N
j i
=
Φ 
与
1
|
i N
j i
=
U
%
在张成空间方面是等价的。因此，任意一个样本流场 
U
i 
的第 
j 
个
流场变量向量
i
j
U 
可精确的表达为
1
|
k N
j k 
=
Φ 
的线性组合，即：
 
,
1
=
N
i k
j j k j j
k
b
=
U
å 
Φ
+ 
U 
                      (5-8) 
线性组合系数
, 1
|
N
j k k
b
=
可由最小二乘法求得，具体求解方法见本文 
4.1.1 
小节。式
(5-8)
已经非常接近式
(5-1)
，唯一的不同点在于式
(5-1)
是用少数主要基模态流场的
线性叠加来近似表示样本流场；式
(5-8)
是用所有基模态流场的线性叠加来精确表
示样本流场。为了能将式
(5-8)
完全写为式
(5-1)
的形式，要求离散样本流场在高维
空间中的分布很不均匀，且适合采用 
POD 
进行降维，即离散样本流场的绝大部
分特征会被集中在少数基模态流场中。对于气动外形优化过程中产生的流场来说
，往往是具备这种特征的。从主观上来说，气动外形优化过程中不同构型的流场第五章
  
缩短流场求解时间的新思路及方法
 
 
85
 
 
之所以不同是因为他们的几何外形参数不同，当一个构型的几何外形参数确定了
，它的绕流流场也就确定了。换个说法即：气动外形优化过程中流场的本征维度
应该与几何外形参数的个数相等。这说明气动外形优化过程中产生的流场很有可
能是适合采用 
POD 
方法进行降维的。基于上述分析，式
(5-8)
可以近似写为：
 
,
1
, ( )
j
P
i k
j j k j j
k
b P N
=
U
» 
å 
Φ
+ 
U
<< 
            (5-9) 
其中，
j
P 为包含了样本流场绝大部分特征的主要基模态流场的个数。根据本文
第三章中介绍的方法，
j
P 的具体取值可由 
99%
广义能准则来确定。
 
假如描述每个样本流场对应几何构型的几何参数有
n
个，第
i 
个样本流场对
应的几何构型参数为
1 2 3
[ , , , , ]
i i i i i T
n
X
=
x x x 
×××
x ,  则我们可以说：由向量 
X
i 
决定的第 
i
个样本流场的第 
j 
个流场变量向量
i
j
U 
可以由长度为
j
P 的向量
i
j
b 
近似描述。令
1
z
j
j
P P
=
= 
å 
，则我们可以说气动外形优化过程中的流场求解问题被近似转换成了一
个
n
维输入、
P 
维输出的问题，且 
P 
相对于流场的网格单元数
m 
来说是一个很小
的数，这就使得采用代理模型进行流场预测变得切实可行。
 
本文采用第二章中介绍的 
Kriging 
代理模型进行流场预测。因为离散流场的
维度被近似降低到了 
P 
维，所以需要构建 
P 
个代理模型，也就是在每个基本流场
变量的主要基模态的线性叠加系数与所有 
n 
个几何外形参数之间构建一个近似
函数关系。构建所有代理模型的样本输入参数是相同的，均为
1
|
i N
i
=
X 
，而构建所
有代理模型的样本输出参数是不同的，构建预测第 
j 
个基本流场变量的第k个主
要基模态线性叠加系数的代理模型所需的样本输出参数为
( )
, 1
|
i N
j k i
b
=
。当完成所有 
P
个代理模型的构建之后，对于一个由任意几何参数
X 
确定的气动外形，只需将
X
带入所构建的 
P 
个代理模型中，即可得到 
P 
个主要基模态的线性叠加系数，进而
通过
(5-8)
式得到此构型的近似流场。
 
5.3.2 
预测初始流场加速流场求解的效果
 
本小节将采用
5.2.2 
小节中的二维算例对基于代理模型与
POD
的流场预测精
度进行测试，并检验这种流场预测方法预测的初始流场加速流场求解的效果。在
二维情况下描述流场的基本变量包括密度
r
、水平方向速度
u 
、竖直方向速度
v 
及
压力 
p 
。而本文所使用的 
RANS 
方程求解器在选择 
S-A 
湍流模型时所求解的流
场变量为
r
、 
u
r
、 
v
r
、
2
r
(e 
+
V/ 2) 
及
u
~，其中 
e 
为内能，
V 
为合速度，
u
~为 
S-A
湍流模型中引入的涡粘性系数相关量。为了让预测出的流场能直接用作流场求解
的初场，在下面的算例中我们将直接预测出流场中的
r
、 
u
r
、 
v
r
、
2
r
(e 
+
V/ 2)西北工业大学博士学位论文
 
86 
 
及
u
~，而不是最基本的
r
、
u 
、
v 
及 
p 
。
 
5.3.2.1  
亚音速流场测试结果
 
5.2.2 
小节亚音速流场预测算例中的 
100 
个样本流场的平均流场密度云图如
图 
5.19(a)
所示，
POD 
方法得到的广义能曲线随基模态数的变化如图 
5.19(b)
所示
。对于所预测的 
5 
个流场变量
r
、 
u
r
、 
v
r
、
2
r
(e 
+
V/ 2) 
及
u
~来说，满足 
99%
广义能的基模态数分别为 
8
、
9
、
8
、
8
、
8
。则在进行流场预测时需要建立的代理
模型数量为 
8+9+8+8+8=41 
个，也就是说，只需 
41 
个变量即可近似描述算例中
流场随几何外形的变化情况。相对于流场网格点数 
29893 
与每个网格点上的所需
求解的流场变量数 
5 
的乘积 
149465 
来说，显然流场的维度被大大降低了。
5.20(a)~ 
5.20(f)
分别为叠加了样本平均密度场的第 
1 
个、第 
2 
个、第 
3 
个、第 
5 
个、第 
10
个、第 
20 
个及第 
50 
个密度基模态场云图。从图中可以看出，随着基模态编号的
逐渐增加，密度基模态场逐渐趋近于样本的平均密度场，实际上第 
10 
个密度基
模态场就已经比较接近样本的平均密度场了。其它流场变量基模态场也呈类似的
趋势。这种现象与图 
5.19(b)
中的广义能曲线是吻合的。
 
  
(a)  
密度云图
                       (b)  
广义能随基模态数的变化
 
图 
5.19  
样本平均流场的密度云图及广义能随基模态数的变化
 
   
(a)  
第 
1 
个
                  (b)  
第 
2 
个
                    (c)  
第 
3 
个
 第五章
  
缩短流场求解时间的新思路及方法
 
 
87
 
 
   
(d)  
第 
10 
个
                 (e)  
第 
20 
个
                  (f)  
第 
50 
个
 
图 
5.20  
叠加了样本平均密度场的密度基模态场云图
 
图 
5.21(a)
为从第 
6 
个测试翼型的预测流场中提取的表面压力分布与 
RANS
方程求解器计算结果的对比。从图中可以看出，预测结果几乎与 
CFD 
计算结果
完全重合。图 
5.21(b)
为从第 
6 
个测试翼型的预测流场中经过变量间的运算得到
的马赫数云图，显然它与图 
5.5(a)
中的 
CFD 
计算结果是非常相似的。图 
5.22 
为
直接使用求解器求解第 
6 
个测试翼型流场与使用预测流场作为初始流场求解第 
6
个测试翼型流场在升力系数、阻力力系数及力矩系数收敛速度方面的对比，两个
求解过程初始时间步长及时间步长变化策略完全相同。为了能清楚的判断出两个
求解过程的收敛迭代步数，图中只给出了前 
200 
个迭代步的收敛情况。从图中明
显可以看出，当使用预测流场作为流场求解的初始流场之后，第 
6 
个测试翼型的
三个力系数完全收敛需要 
200 
个迭代步。而从 
4.2.2 
小节中可知，直接使用求解
器求解第 
6 
个测试翼型的流场需要 
1200 
个迭代步才能使三个力系数完全收敛。
 
   
(a)  
表面压力分布
                           (b)  
马赫数云图
 
图 
5.21  
第 
6 
个测试翼型预测流场中提取的表面压力分布与 
CFD 
计算结果的对比及第 
6 
个测
试翼型预测流场的马赫数云图
 西北工业大学博士学位论文
 
88 
 
   
(a)  
升力系数
                (b)  
阻力力系数
              (c)  
力矩系数
 
图 
5.22  
直接使用求解器求解第 
6 
个测试翼型流场与使用预测流场作为初始流场求解第 
6 
个
测试翼型流场在升力系数、阻力力系数及力矩系数收敛速度方面的对比
 
图 
5.23(a)
为从第 
10 
个测试翼型的预测流场中提取的表面压力分布与 
RANS
方程求解器计算结果的对比。与第 
6 
个测试翼型类似，第 
10 
个翼型预测的表面
压力分布与 
CFD 
计算结果仍然吻合得非常好。图 
5.23(b)
为从第 
10 
个测试翼型
的预测流场中经过变量间的运算得到的马赫数云图，显然它与图 
5.8(a)
中的 
CFD
计算结果是非常相似的。图 
5.24 
为直接使用求解器求解第 
10 
个测试翼型流场与
使用预测流场作为初始流场求解第 
10 
个测试翼型流场在升力系数、阻力力系数
及力矩系数收敛速度方面的对比，两个求解过程初始时间步长及时间步长变化策
略完全相同。与第 
6 
个测试翼型的情况类似，使用预测流场作为求解的初始流场
之后，第 
10 
个测试翼型的三个力系数完全收敛也只需要 
200 
个迭代步，相对于
直接求解所需的 
1200 
个迭代步，速度大大加快。
 
   
(a)  
表面压力分布
                           (b)  
马赫数云图
 
图 
5.23  
第 
10 
个测试翼型预测流场中提取的表面压力分布与 
CFD 
计算结果的对比及第 
10
个测试翼型的预测流场马赫数云图
 第五章
  
缩短流场求解时间的新思路及方法
 
 
89
 
 
   
(a)  
升力系数
                (b)  
阻力力系数
              (c)  
力矩系数
 
图 
5.24  
直接使用求解器求解第 
10 
个测试翼型流场与使用预测流场作为初始流场求解第 
10
个测试翼型流场在升力系数、阻力力系数及力矩系数收敛速度方面的对比
 
5.3.2.2  
跨音速流场预测结果
 
5.2.2 
小节跨音速流场预测算例中的 
100 
个样本流场的平均流场密度云图如
图 
5.25(a)
所示，使用 
POD 
方法对减去了平均流场的 
100 
个样本流场进行基模态
提取过程中得到的广义能曲线随基模态数的变化如图 
5.25(b)
所示。对于所预测
的 
5 
个流场变量
r
、 
u
r
、 
v
r
、
2
r
(e 
+
V/ 2) 
及
u
~来说，满足 
99%
广义能的基模态
数分别为 
23
、
18
、
18
、
23
、
5
。则在进行流场预测时需要建立的代理模型数量为
23+18+18+23+5=87 
个，也就是说，只需 
87 
个变量即可近似描述算例中流场随几
何外形的变化情况。相对于亚音速算例中的 
41 
个变量，这里的流场自由度显然
是增加了；但相对于流场网格点数 
29434 
与每个网格点上的所需求解的流场变量
数 
5 
的乘积 
147170 
来说，显然流场的维度仍然是被极大的降低了。图 
5.26(a)~ 
5.26(i)
分别为叠加了样本平均密度场的第 
1 
个、第 
2 
个、第 
3 
个、第 
4 
个、第 
5
个、第 
10 
个、第 
20 
个、第 
30 
个及第 
50 
个密度基模态场云图。与亚音速算例中
的情况类似，随着基模态编号的逐渐增加，跨音速工况下各个密度基模态场也在
逐渐逼近样本平均密度场，但逼近的速度明显要比亚音速工况下慢得多。另外，
从图 
5.26 
中还能发现一个非常特别的、在亚音速算例中不存在的现象：在每个
密度基模态场中翼型上表面的区域，总是存在类似激波间断的密度间断条纹，随
着基模态编号的增加，密度间断条纹的宽度逐渐减小、强度逐渐减弱，但数量却
在逐渐增加。对于这种现象，我们可以解释为：在 
100 
个样本流场中存在的强度
、位置各异的激波间断特征经过 
POD 
运算后被以上述形式分解到了各个基模态
中。
 西北工业大学博士学位论文
 
90 
 
   
(a)  
密度云图
                       (b)  
广义能随基模态数的变化
 
图 
5.25  
样本平均流场的密度云图及广义能随基模态数的变化
 
   
  (a)  
第 
1 
个
                  (b)  
第 
2 
个
                    (c)  
第 
3 
个
 
   
  (d)  
第 
4 
个
                  (e)  
第 
5 
个
                    (f)  
第 
10 
个
 
   
(g)  
第 
20 
个
                 (h)  
第 
30 
个
                  (i)  
第 
50 
个
 
图 
5.26  
叠加了样本平均密度场的密度基模态场云图
 第五章
  
缩短流场求解时间的新思路及方法
 
 
91
 
 
图 
5.27(a)
为从第 
6 
个测试翼型的预测流场中提取的表面压力分布与 
RANS
方程求解器计算结果的对比。从图中可以看出，预测结果大体上是较为吻合 
CFD
计算结果的。图 
5.27(b)
为从第 
6 
个测试翼型的预测流场中经过变量间的运算得
到的马赫数云图，大体上它与图 
5.14(a)
中的 
CFD 
计算结果是非常相似的。但仔
细观察翼型上方的超音速区会发现一些不太明显的条纹。对于这些条纹的来源可
以解释为：当使用类似图 
5.26 
中所示的基模态的线性组合来近似表示含有激波
的流场时，预测流场中的激波就靠基模态中包含的间断特征的线性叠加来表示。
但正如图 
5.26 
中所展示的那样，一个基模态中往往包含多个间断特征，其在预
测流场激波位置的间断特征能与其他基模态在该处的间断特征共同组合成预测
流场中的真实激波。但这些基模态在其它位置的间断特征往往难以互相抵消，故
会出现图 
5.27(b)
中的条纹。
 
图 
5.28 
为直接使用求解器求解第 
6 
个测试翼型流场与使用预测流场作为初
始流场求解第 
6 
个测试翼型流场在升力系数、阻力力系数及力矩系数收敛速度方
面的对比，两个求解过程初始时间步长及时间步长变化策略完全相同。为了能清
楚地判断出两个求解过程的收敛迭代步数，图中只给出了最后 
1000 
个迭代步的
收敛情况。从图中可以看出，当使用预测流场作为流场求解的初始流场之后，第
6 
个测试翼型的三个力系数完全收敛只需要 
900 
个迭代步。而直接使用求解器求
解第 
6 
个测试翼型的流场则需要 
1500 
个迭代步才能使三个力系数完全收敛。
 
   
(a)  表面压力分布
                            (b)  
马赫数云图
 
图 
5.27  
第 
6 
个测试翼型预测流场中提取的表面压力分布与 
CFD 
计算结果的对比及第 
6 
个测
试翼型预测流场的马赫数云图
 西北工业大学博士学位论文
 
92 
 
   
(a)  
升力系数
                (b)  
阻力力系数
              (c)  
力矩系数
 
图 
5.28  
直接使用求解器求解第 
6 
个测试翼型流场与使用预测流场作为初始流场求解第 
6 
个
测试翼型流场在升力系数、阻力力系数及力矩系数收敛速度方面的对比
 
图 
5.29(a)
为从第 
3 
个测试翼型的预测流场中提取的表面压力分布与 
RANS
方程求解器计算结果的对比，图 
5.29(b)
为从第 
3 
个测试翼型的预测流场中经过
变量间的运算得到的马赫数云图。显然，预测结果并没有捕捉到计算结果中第一
道较强激波，但捕捉到了第二道很弱的激波。图 
5.30 
为直接使用求解器求解第 
3
个测试翼型流场与使用预测流场作为初始流场求解第 
3 
个测试翼型流场在升力
系数、阻力力系数及力矩系数收敛速度方面的对比。从图中可以看出，当使用预
测流场作为流场求解的初始流场之后，第 
3 
个测试翼型的三个力系数完全收敛只
需要 
900 
个迭代步。而直接使用求解器求解第 
3 
个测试翼型的流场则需要 
1500
个迭代步才能使三个力系数完全收敛。
 
   
(a)  
表面压力分布
                            (b)  
马赫数云图
 
图 
5.29  
第 
3 
个测试翼型预测流场中提取的表面压力分布与 
CFD 
计算结果的对比及第 
3 
个测
试翼型预测流场的马赫数云图
 第五章
  
缩短流场求解时间的新思路及方法
 
 
93
 
 
   
(a)  
升力系数
                (b)  
阻力力系数
              (c)  
力矩系数
 
图 
5.30  
直接使用求解器求解第 
3 
个测试翼型流场与使用预测流场作为初始流场求解第 
3 
个
测试翼型流场在升力系数、阻力力系数及力矩系数收敛速度方面的对比
 
5.4 
两种流场预测方法的对比及搭配使用
 
从前两节的算例可以看出，本文开发的两种流场预测方法加快流场求解速度
的能力存在明显差别，此外两种方法所需样本流场的数量也不同。本节将对这两
种方法加速流场求解的能力进行对比。同时，基于两种方法所需样本流场数量的
差异，本节还将提出一种在优化设计过程中将两种方法搭配使用的策略，以最大
限度地减少气动外形优化过程中流场求解所需的时间。
 
5.4.1 
两种流场预测方法加速流场求解的能力对比
 
表 
5.1 
给出了在不同算例中使用不同的流场求解方法达到力系数收敛所需迭
代步的对比。从表中数据可以得出如下结论：
 
1
、在亚音速算例中，使用两种流场预测方法预测初始流场后再进行流场求
解均能明显减少流场达到收敛所需的迭代步数。其中，使用基于几何相似原则的
流场预测方法进行初始流场的预测能减少一半的迭代步数；而使用基于代理模型
和 
POD 
的流场预测方法进行初始流场的预测能减少 
5/6 
的迭代步数；
 
2
、在跨音速算例中，基于几何相似原则预测的初始流场能否缩短流场求解
的迭代步数取决于能否在样本中找到与需要求解流场的构型几何相似度较高的
样本。当存在这样的样本时，则基于几何相似原则预测的初始流场能够使流场求
解达到收敛的迭代步减少 
1/3
；否则，这种加速流场求解的方法基本失效。但基
于代理模型和 
POD 
所预测的初始流场在加速流场求解方面则表现更加稳定，在
两个测试翼型中，此方法均使得流场求解达到收敛的迭代步减少了 
2/5
。
 
 
 
 西北工业大学博士学位论文
 
94 
 
表 
5.1  
不同算例中使用不同流场求解方法达到力系数收敛所需迭代步对比
 
   
直接求解
 
基于几何相似原
则预测初始流场
 
基于代理模型和
POD 
预测初始流场
 
亚音速算例
 
第 
6 
个测
试翼型
 
1200 
步
  600 
步
  200 
步
 
第
10
个测
试翼型
 
1200 
步
  600 
步
  200 
步
 
跨音速算例
 
第 
6 
个测
试翼型
 
1500 
步
  1000 
步
  900 
步
 
第 
3 
个测
试翼型
 
1500 
步
  1500 
步
  900 
步
 
 
 
5.4.2 
两种流场预测方法的搭配使用
 
虽然基于代理模型与 
POD 
的流场预测方法较之基于几何相似的流场预测方
法精度更高，但前一种方法需要一定数量的快照流场才能进行流场预测，而后一
种方法则只要有一个构型的流场已知即能开展流场预测。因此在实际使用中可将
两种方法搭配使用。以前述跨音速算例中的 
RAE2822 
翼型为例，若采用基于代
理模型与现代启发式优化算法的气动外形优化方法对其进行气动性能优化，且参
数化方法采用图 
5.10 
中的 
FFD 
参数化方法，则构建气动参数与几何参数之间的
初始代理模型至少需要 
200 
个样本点，在后续的优化过程中可能还需要增加几十
个样本点以不断提升代理模型的精度。假设完成整个优化过程需要计算 
250 
个样
本点，那么可采用如下的策略实现这 
250 
个样本点流场的快速求解：
 
1)  首先随机地选择一个样本，调用 
CFD 
求解器计算其流场；
 
2)  采用基于几何相似准则的初始流场预测方法加速后续样本点流场的求
解。在此过程中，采用几何参数之间的欧式距离作为两个构型气动外形
之间的相似性度量；
 
3)  当已求解出的样本点流场数量超过几何设计参数个数之后继续采用基
于几何相似准则的初始流场预测方法加速后续样本点流场的求解；但与
之前不同的时，这里采用几何参数之间的马氏距离作为两个构型气动外
形之间的相似性度量；
 
4)  当已求解出的样本点流场数量达到 
100 
个之后，采用基于代理模型与第五章
  
缩短流场求解时间的新思路及方法
 
 
95
 
 
POD 
的初始流场预测方法加速后续样本点流场的求解。
 
 
  西北工业大学博士学位论文
 
96 
 
 
  第六章
  
基于 
ISOMAP 
的设计空间过滤与重构
 
 
97
 
 
第六章
  
基于 
ISOMAP 
的设计空间过滤与重构
 
在飞行器的气动外形优化中，常常会设置一定的几何约束条件，以保证最终
设计结果在物理上的可实现性以及在其它学科方面的性能不会受到明显损失。为
此，处理各种几何约束即成为气动外形优化中不可回避的问题。对于一个约束优
化问题，约束处理的好坏严重影响整个寻优过程的收敛性以及最终优化结果的好
坏。本章将基于流形学习的观点对气动外形优化中的几何约束处理问题开展相应
的研究。
 
6.1  
存在等式约束时设计空间的特征及提取
 
从主观上来说，对于给定的设计空间，增加一个约束条件很可能会使得满足
所有约束条件的设计空间范围有所减小，甚至维度有所降低。如果事先将满足所
有约束条件的设计空间从给定的设计空间中提取出来并将其指定为新的设计空
间，则约束优化问题即可转变为无约束优化问题，且寻优空间的范围也有所减小
、甚至维度也有所降低。显然这对简化约束优化问题的求解、提高优化算法的寻
优效率是极为有利的。而等式约束的性质及流形学习算法的发明使得上述构想的
实现成为可能。
 
6.1.1  
存在等式约束时设计空间的主要特征
 
以存在等式约束的三维设计空间为例说明存在等式约束时满足所有约束条
件的设计空间特征。假设三维空间中的一个约束优化问题为：
 
( )
2 2 2 2
min , ,
0
. . 0
0
f x y z
x y
s t x z
x y z r
ì + ³
ï
í
+ ³
ï
+ + - =
î
                  (6-1) 
其中，
r 
为绝对值大于零的实数。三维空间中满足式
(6-1)
中两个不等式约束的分
界面及满足等式约束的球面如图 
6.1(a)
所示。从图中可以看出：满足 
x 
+
y 
³
0
约
束条件的设计空间位于平面 
x 
+
y 
=
0 
的前方；满足 x
 
+
z 
³
0约束条件的设计空间
位于平面 x
 
+
z 
=
0的右方；满足式
(6-1)
中等式约束的设计空间即为图 
6.1(a)
中的
蓝色球面。不难得出：同时满足式
(6-1)
中三个约束的设计空间即为图 
6.1(b)
中的
小半个蓝色球面，而优化问题本身的最优解必然就在这小半个球面上。
 西北工业大学博士学位论文
 
98 
 
   
(a)                                        (b) 
图 
6.1  
满足式
(6-1)
中两个不等式约束的分界平面及满足等式约束的球面
(a)
，满足全部约束
条件的设计空间
(b) 
令 
D
n 
为约束优化问题给定的设计空间，n为此空间的维度。从上面的例子
可以看出：在约束优化问题中，满足单个不等式约束的优化子空间
d
m 
往往与
D
n
的维度相等，即m 
=
n ；而满足单个等式约束的优化子空间 
k
E 
往往是嵌入在给定
设计空间中的超曲面（站在广义的角度，本文认为曲线和曲面是超曲面的特殊情
况）。从本征维度的角度来说，该超曲面的维度要低于所给定设计空间的维度，
即 
k 
<
n 
。显然，满足所有约束条件的设计空间 
S
k 
即为 
E
k 
与
m
d 
的交集，即
k m k
S
= 
d
Ç 
E 
。从几何学的角度来说，
k
S 
为超曲面 
E
k 
嵌入在
m
d 
中的部分，故
k
S
仍然是超曲面，其本征维度与
E
k 
相等，只是范围小于
k
E 
。根据本节开头的设想
，如果能将优化问题的设计空间由原来的
D
n 
重新限定到
k
E 
，则优化算法的寻优
效率很有可能会因为寻优空间维度与范围的减小及约束条件的消除而大幅提高。
 
主观上，上述想法非常具有吸引力，但真正实施起来必须首先解决以下两个
方面的问题：
 
1
、如何判断等式约束的函数表达式代表的是嵌入在给定设计空间中的超曲
面？当等式约束本身是优化变量的显示函数时，此问题可通过分析函数本身的性
质得到解决。但当等式约束本身不是优化变量的显式函数时，此问题就显得比较
棘手。在飞行器优化设计中，诸如翼型的最大厚度约束之类的很多约束条件往往
难以写为优化变量的显式函数；
 
2
、如果能够判断等式约束的函数表达式代表的是嵌入在给定设计空间 
D
n 
中
的超曲面，那么如何才能将
S
k 
从
D
n 
中提取出来，并将优化算法的寻优空间限定
为
S
k 
？从之前的论述可知
k
S 
是 
E
k 
与
m
d 
的交集，如果想将
k
S 
从 
D
n 
中提取出来并
将寻优空间限定为
S
k 
，最常用的做法即为施加一个约束，让寻优空间中的点同
时属于
E
k 
与
m
d 
。但这样做显然又让问题的求解回到了原点，使方法本身失去了
应有的意义。
 第六章
  
基于 
ISOMAP 
的设计空间过滤与重构
 
 
99
 
 
6.1.2  
满足所有约束条件的子空间提取方法
 
本文 
3.3 
节已经介绍过：流形学习的目的就是发现高维数据集中的潜在低维
流形结构，同时建立从高维空间到低维流形空间的非线性映射，从而实现数据维
度的降低。显然，流形学习可以被用来解决上述两个问题中的第一个问题及第二
个问题的第一部分。具体实施步骤如下：
 
1)  从本文第三章中对流形学习的介绍可知，流形学习算法直接操作的对象
并不是一个特定的空间，而是空间中一定数目的离散点。因此，在正式
进行流形学习之前首先需要获得一定数目的、满足所有约束条件的样本
点；
 
2)  基于获得的样本点，根据一定的准则估计这些样本点所在流形空间的本
征维度。如果估计的本征维度小于给定设计空间的维度，那么可以认为
约束优化问题中的等式约束函数表达式代表的是嵌入在给定设计空间中
的超曲面；
 
3)  如果满足所有约束条件的优化子空间为嵌入在给定设计空间中的低维流
形，则采用流形学习算法将所有满足约束条件的样本点投影到低维流形
空间。
 
至此，可以认为满足所有约束条件的优化子空间已经从所给定的设计空间中
被提取出来。
 
需要特别指出的是：因为需要完整地将
S
k 
从
D
n 
中提取出来，故步骤 
3 
中的
流形学习算法需要采用全局性的方法。
 
6.2  
流形结构重建的必要性及方法
 
上节的工作实现了对设计空间的过滤，即剔除了设计空间中不满足约束条件
的部分。在此基础上，本节将进一步开展工作，以重构过滤后的设计空间。
 
6.2.1  
流形空间重构的必要性
 
当设计空间中满足所有约束的样本点被映射到低维的流形空间后，并不意味
着嵌入在给定设计空间中的满足所有约束条件的优化子空间已经确定了。因为，
现有的大多数流形学习算法都只是将高维空间中离散的样本数据点投影到其所
在的低维流形上，但并没有给出投影的具体函数关系。除了用于流形学习的样本
点，在给定设计空间中还存在无数个同样满足所有约束的点，而这些点同样也属
于满足所有约束的流形空间，但它们并没有随着样本点被投影到低维流形空间。
当然，我们可以把给定设计空间中任意满足约束条件的点添加到样本点集中，然西北工业大学博士学位论文
 
100 
 
后重新调用流形学习算法把整个新的样本点集投影到流形空间。这种做法看似可
行，但实际应用中存在以下两个问题：
 
1
、频繁的调用全局性的流形学习算法需要耗费更多的计算资源；
 
2
、对于一个已有样本点集合 
A 
，如果将另外一个样本点集合 
B 
加入其中组
成新的样本点集合 
A
È
B 
，然后使用同一种流形学习方法分别将 
A 
中的点及
A 
È
B 
中的点投影到低维流形空间，则两种情况下 
A 
中的点在低维流形上的投影
坐标很可能会不同。即，两种情况下得到的流形空间很可能不是同一个空间。
 
导致第二个问题的原因在于：当集合 
B 
中的点加入到集合 
A 
中后很可能会改
变集合 
A 
中的样本点之间的相对位置关系，而很多的流形学习算法都基于样本点
之间的相对位置关系进行数据降维的。以全局型的流形学习算法 
ISOMAP 
为例
具体说明相对位置关系的改变对计算结果的影响。如图 
6.2 
所示，点
1
a 
、
2
a 
、
3
a
属于某集合 
A 
，而点
1
b 
则属于另一个集合 
B 
。当集合 
B 
没有与集合
A 
合并时，
假如在给定的邻域参数下点
1
a 
、
2
a 
互不属于对方的邻域，他们之间的测地距离
路径是通过点
3
a 
的折线。当集合 
B 
与集合
A 
合并之后，
1
a 
、
2
a 
仍然互不属于对
方的邻域，但他们之间的测地距离路径却变成了通过点
1
b 
的折线。这显然会改
变
1
a 
、
2
a 
在低维流形空间的投影坐标。图 
6.3(a)
为容量为 
5000 
的 
Swiss-roll 
数据
集，采用基于最小覆盖子集的 
L-ISOMAP 
算法单独对前 
4900 
个点进行降维得到
的结果为图 
6.3(b)
中的绿点，对所有 
5000 
个点进行降维得到的结果为图 
6.3(b)
中的红点。显然，图中绝大部分的红点与绿点都是不重合的，说明前 
4900 
个点
中的绝大多数在两次投影过程中得到的坐标是不同的。
 
从上面的论述可以看出，基于确定数量的样本点在低维流形空间的投影构建
一个确定的流形空间是非常有必要的。
 
 
图 
6.2  
增加样本点之后两个样本点之间的测地距离发生改变
 第六章
  
基于 
ISOMAP 
的设计空间过滤与重构
 
 
101
 
 
   
(a) Swiss-roll 
数据集
                         (b)  
二维投影
 
图 
6.3  
容量为 
5000 
的 
Swiss-roll 
数据集以及使用 
5000 
个样本点和使用 
4900 
个样本点得到
的二维投影
 
6.2.2  
流形空间返回高维空间映射的必要性
 
对于一个约束优化问题，当满足所有约束条件的优化子空间被确定性的构建
之后，还需解决一个问题才能毫无障碍的实现在此优化子空间中进行寻优。该问
题为：如何实现从流形空间返回到原始设计空间？
 
以本章针对的带几何约束的气动外形优化问题为例，假如满足所有几何约束
的优化子空间事先已经从给定的设计空间中分离出来，那么此空间内每个点的坐
标代表的还是气动外形的几何参数。通过这些几何参数即可得到对应的气动外形
，进而求得对应的气动特性。但是，在满足所有几何约束的优化子空间所对应的
流形空间中，每个点的坐标并没有明确的物理意义。即，我们根本不能直接通过
该空间中每个点的坐标得到对应的气动外形，也就无从求得对应的气动力。显然
，这种情况下优化过程是无法进行的。
 
6.2.3  
基于 
ISOMAP 
的流形结构重建
 
从 
6.2.1 
及 
6.2.2 
小节的论述可知，如果能找出流形空间与其所嵌入的高维空
间之间的相互映射关系，则流形空间的重构及流形空间返回高维空间的映射问题
即可得到解决。事实上
,  
孟德宇等人
[151]
经意识到：如何实现流形空间与其所嵌
入的高维空间之间的相互映射关系
,  
或者说如何基于流形产生的数据完整准确
地重建流形结构
,  
是目前流形学习领域亟需解决的主要问题之一。通过研究
ISOMAP 
方法运行的内在机理，他们给出了两种高效的流形结构重建方法。本文
在此给出其中一种方法的主要推导过程，关于两种方法完整且严密的推导过程可西北工业大学博士学位论文
 
102 
 
参考文献
[151]
。
 
假设
S
k 
为嵌入在
n
维空间
D
n 
中的
k
维流形，集合
{ }
1
N
n
i
i
R
=
x
Ì 
为 
S
k 
上 
N 
个样
本点在 
D
n 
中的坐标，集合
{ }
1
N
k
i
i
R
=
y
Ì 
为这 
N 
个样本点在 
S
k 
中的坐标。设两个
坐标系之间的互相转换关系分别为： 
y
=
f(x) 
， 
x
=
g( y) 
。根据泰勒展开定理，
i
y 邻域内任意一点 
y 
在 
D
n 
中的坐标 
g( y) 
可表示为
 
( ) ( )( )+ ( , )
i i i i
g y
= 
x
+ 
J
y y
- 
y 
R
y y  
                 (6-2) 
其中， ( )
i
J
y 为函数 
g( y) 
在点
i
y 的雅克比矩阵， ( , )
i
R
y y 为泰勒余项。略去泰勒
余项，上式变为
 
( ) ( )( )
i i i
g y
» 
x
+ 
J 
y y
- 
y                      (6-3) 
假设在设定的邻域参数下点
i
x 的邻域内共有 
z 
个点，分别为
,1 ,2 ,
, , ,
i i i z
x x 
L
x 
，
其在
S
k 
中的坐标分别为 
y
i,1
, y
i,2
,
L
, y
i,z 
。将这 
z 
个点在两个空间中的坐标代入式
(6-3)
可得
 
,1 ,1
,2 ,2
, ,
( )( )
( )( )
( )( )
i i i i i
i i i i i
i z i i i z i
» + -
» + -
» + -
x x y y y
x x y y y
x x y y y
M M M
J
J
J
                    (6-4) 
为方便推导，将式
(6-4)
写为如下更紧凑的形式
 
( )
i i i
X
» 
J
y Y  
                         (6-5) 
其中，
,1 ,
( , , )
i i i i z i
X
= 
x
- 
x 
L
x
- 
x 
，
,1 ,
( , , )
i i i i z i
Y
= 
y
- 
y 
L
y
- 
y 
。在上式两边同乘 
T
i
Y
可得
 
( )
T T
i i i i i
X Y
» 
J
y YY                        (6-6) 
由此可求得
 
1
( )( ) ( )
T T
i i i i i
-
X Y YY
» 
J
y                      (6-7) 
即，函数 
g( y) 
在点
i
y 的雅克比矩阵可由上式近似得到。然而，矩阵
T
i i
YY 的逆矩
阵
1
( )
T
i i
-
YY 并不总是存在，为确保式
(6-7)
的普适性，采用
T
i i
YY 的广义逆 
( )
T G
i i
YY 代
替
1
( )
T
i i
-
YY ，可得
 
( ) ( )( )
T T G
i i i i i
J
y
» 
X Y YY                      (6-8) 
令 (
 )( )
T T G
i i i i i
Q
= 
X Y YY ，则有
 第六章
  
基于 
ISOMAP 
的设计空间过滤与重构
 
 
103
 
 
( )
i i i
x
» 
x
+ 
Q y
- 
y                       (6-9) 
( )
T
i i i
y
» 
y
+ 
Q x
- 
x                       (6-10) 
根据上述推导过程，可给出如下的流形结构重建方法：
 
对于流形空间
S
k 
中任意一点 
y 
，求其在
k
S 
所嵌入的高维空间 
D
n 
中的坐标 x
步骤为：
 
1)  从
{ }
1
N
i
i
=
y 中找出距点 
y 
最近的点
s
y ；
 
2)  找出
s
y 在高维空间 
D
n 
中的坐标
s
x 、
s
x 的邻域点
,1 ,2 ,
, , ,
s s s z
x x 
L
x 
以及这
些邻域点在
S
k 
中的坐标 
y
s,1
, y
s,2
,
L
, y
s,z 
；
 
3)  构建矩阵
,1 ,
( , , )
s s s s z s
X
= 
x
- 
x 
L
x
- 
x 
及
,1 ,
( , , )
s s s s z s
Y
= 
y
- 
y 
L
y
- 
y 
，计算矩
阵 (
 )( )
T T G
s s s s s
Q
= 
X Y Y Y ；
 
4)  点 
y 
在 
D
n 
中的坐标 ( )
s s s
x
» 
x
+ 
Q y
- 
y 。
 
对于流形空间
S
k 
中的任意一点，在只知道其在
k
S 
所嵌入的高维空间 
D
n 
中的
坐标 x 的情况下求其在
S
k 
中的坐标 
y 
的步骤与上述步骤相似，只需将第 
1 
步修
改为：从
{ }
1
N
i
i
=
x 中找出距点 
x 最近的点
s
x ；将第 
4 
步修改为： (
 )
T
s s s
y
» 
y
+ 
Q x
- 
x
即可。
 
为验证上述方法的有效性，对属于三维 
Swill-roll 
数据集的 
100 
数据点在三
维嵌入空间与二维流形空间之间进行来回转换。图 
6.4(a)
中红色的点为三维
Swiss-roll 
曲面上 
3000 
个点在二维空间的投影，这些点在三维空间中位置如图
6.4(b)
中红色的点所示。
6.4(a)
中绿色的点为在二维空间中额外增加的 
100 
个测试
点，它们位于展平之后的 
Swiss-roll 
矩形平面的对角线上，但其在三维空间中的
位置事先未知。图 
6.4(b)
中绿色的点为计算得到的 
100 
个测试点在三维空间中的
位置，显然它们被完美地映射到了三维 
Swiss-roll 
曲面的对角线上。
 
图 
6.5(a)
中红色的点为三维 
Swiss-roll 
曲面上 
3000 
个点，这些点在二维空间
中位置如图 
6.5(b)
中红色的点所示。
6.5(a)
中绿色的点为三维 
Swiss-roll 
曲面上的
100 
测试点，它们位于嵌入在 
Swiss-roll 
曲面中的正弦曲线上，但其在二维空间
中的位置事先未知。图 
6.5(b)
中绿色的点为计算得到的这 
100 
个测试点在二维空
间中的位置，显然它们被完美地映射到了二维空间中的正弦曲线上。
 
上述两个算例说明，本章给出的流形重构方法是有效的。
 西北工业大学博士学位论文
 
104 
 
   
(a)                                       (b) 
图 
6.4 
容量为 
3000 
的 
Swiss-roll 
数据集在二维空间的投影及二维空间中的 
100 
个测试点
(a)
，
100 
个测试点在三维 
Swiss-roll 
上的位置
(b) 
   
(a)                                       (b) 
图 
6.5 
容量为 
3000 
的 
Swiss-roll 
数据集及 
Swiss-roll 
上的 
100 
个测试点
(a)
，
100 
个测试点在
二维空间的投影
(b) 
6.3  
满足几何约束的设计空间提取与重构
 
某些存在几何约束的气动外形优化问题适合采用流形学习方法提取满足所
有几何约束条件的设计空间然后再进行优化。其理由在于：对于当前绝大部分气
动外形参数化方法来说，当几何参数给定之后，生成与之对应的气动外形并评估
该气动外形是否满足给定的几何约束非常迅速。也就是说我们可以在给定的几何
参数空间中不断随机生成气动外形然后评估其是否满足几何约束，对于满足几何
约束的构型，记录其对应的几何外形参数作为流形学习的样本点。当记录到的样
本点达到一定数目之后即可采用流形学习方法基于这些样本点上建立满足所有
约束条件的优化子空间。
 第六章
  
基于 
ISOMAP 
的设计空间过滤与重构
 
 
105
 
 
6.3.1  
几何约束处理方法
 
从 
6.1 
节的论述中可知，如果给定的几何约束条件中不存在等式约束，那么
很可能满足所有约束条件的优化子空间不是嵌入在给定设计空间中的超曲面，此
时流形学习方法将会失效。而在很多带几何约束的气动外形优化问题中，并不存
在等式约束条件。但是这并不意味着采用流形学习方法提取满足所有几何约束的
优化子空间的方法完全不可行。因为，我们可以根据实际情况将某些不等式约束
改写为等式约束。例如在对某个翼型进行给定升力系数下的升阻比优化时，假如
设定的几何约束条件为翼型的最大厚度不能小于一个给定的值，那么通常最终优
化出的翼型的最大厚度是非常接近给定的约束值的。此时，将最大厚度不小于给
定值的约束改为最大厚度等于给定的约束值是完全可行的。
 
需要特别指出的是：在实际采集满足所有几何约束的样本点时，几何等式约
束关系式需要适当地放宽，否则很可能采集不到满足几何约束的样本点。以翼型
的最大厚度约束为例，根据概率中的概率密度理论
[149]
，当翼型的几何外形参数
随机变化时，即使产生成千上万个样本翼型也不可能找出一个翼型的最大厚度刚
好等于指定值，而只可能找出一些最大厚度落在特定区间中的翼型。但当等式几
何约束适当放宽之后，所采集到的满足所有约束条件的样本点显然又不会严格的
位于一个超曲面上，这就要求流形学习算法以及流形结构重建方法均需要具备一
定的抗噪声能力。
 
以下用一个实际算例证明本文所采用的基于最小子集覆盖的 
L-ISOMAP 
算
法以及基于 
ISOMAP 
的流形结构重建方法是具备较强的抗噪声能力的。
 
在 
NACA-0012 
翼型的上下表面各布置 
4 
个 
Hicks-henne 
鼓包对翼型进行随
机扰动，
4 
个鼓包的峰值站位分别位于 
10%
、
35%
、
65%
、
90%
翼型弦长处，前 
3
个鼓包的高度变化范围均为
[-0.1, 0.1]
，第 
4 
个鼓包高度变化范围为
[-0.05,0.05]
。
在翼型几何外形随机变化过程中将最大厚度位于
[12%, 12.1%]
之间的翼型对应的
8 
个几何参数记录下来作为样本点，当记录的样本点数量达到 
3000 
之后采样过
程停止。采用基于最小覆盖子集的邻域参数与本征维度估算方法对 
3000 
个样本
点的分析结果为：这 
3000 
个样本点所在流形空间的本征维度为 
7
，说明使得翼
型最大厚度位于
[12%, 12.1%]
之间几何外形参数所构成的空间是嵌入在 
8 
维空间
中的 
7 
维超曲面。
 
进一步，采用基于最小覆盖子集的 
L-ISOMAP 
方法将 
3000 
个样本点投影到
7 
维流形空间，并将这 
3000 
个点在每个维度上坐标的最小值和最大值作为流形
空间在此维度上的边界。在设定了边界的 
7 
维流形空间内随机生成 
1000 
个测试
点，采用基于 
ISOMAP 
的流形结构重建方法将这 
1000 
个测试点映射到 
8 
维的翼
型几何参数空间，然后再用 
Hicks-Henne 
参数化方法生成对应的翼型。图 
6.6 
为西北工业大学博士学位论文
 
106 
 
流形空间内随机生成的 
1000 
个测试点所对应翼型的最大厚度分布，从图中可以
看出：
1000 
个测试点所对应翼型的最大厚度分布在
[11.95%, 12.15%]
之间，且绝
大部分位于
[12.0%, 12.1%]
之间。
 
此算例证明：本文所采用的基于最小子集覆盖的 
L-ISOMAP 
算法以及基于
ISOMAP 
的流形结构重建方法具备较强的抗噪声能力。
 
 
图 
6.6  
流形空间生成的 
1000 
个样本点对应的翼型最大厚度分布
 
6.3.2  
梯度信息从高维空间到流形空间的转换
 
在基于梯度信息的气动外形优化体系中，除了需要对同一个点的坐标在两个
空间中进行相互转换外，还需要将优化目标在高维空间中的梯度信息转换到低维
的流形空间才能开展优化。在 
6.2.3 
小节的讨论框架下可知：完成这项工作的关
键在于求出高维空间中任意一点
i
x 相对其在流形空间中坐标
i
y 的雅克比矩阵，而
从式
(6-10)
可以看出这里的雅克比矩阵即为式
(6-10)
中的矩阵
T
i
Q 。即：假如气动
优化目标函数 
f 
在点
i
x 的梯度为
 
( )
( ) ( ) ( )
1 2
, , ,
T
i i i
i
n
f f f
f
x x x
æ¶ ¶ ¶ ö
=
ç ÷
¶ ¶ ¶
è ø
x x x
Ñ
x 
K 
               (6-11) 
则其流形空间中点
i
y 处的梯度为
 
( )
( ) ( ) ( )
1 2
, , ,
T
T i i i
i i
n
f f f
f
x x x
æ¶ ¶ ¶ ö
=
ç ÷
¶ ¶ ¶
è ø
x x x
Ñ
y Q 
K 
             (6-12) 
下面通过一个简单的例子证明上式给出的梯度转换关系是可行的。图 
6.7(a)
为三维空间中半圆柱面上的 
2000 
个离散点，该半圆柱面的方程为
 第六章
  
基于 
ISOMAP 
的设计空间过滤与重构
 
 
107
 
 
2 2
25
5 5
0 5
x y
y
z
+ =
- £ £
£ £
                        (6-13) 
显然，我们也可以在该半圆柱面上建立如图 
6.7(b)
所示的二维曲面坐标系，且不
难得出，从图 
6.7(b)
中的二维曲面坐标系转换到图 
6.7(a)
中的三维直角坐标系的
转换关系式为
 
5sin
5
5 5cos
5
x
y
z
h
x
h
æ ö
=
ç ÷
è ø
=
æ ö
= -
ç ÷
è ø
                      (6-13) 
从三维直角坐标系转换到二维曲面坐标系的转换关系式为
 
5arctan
5
x
z
y
h
x
æ ö
=
ç ÷
è-
 ø
=
                     (6-14) 
三维空间中任意函数 
f(x, y, z) 
在半圆柱面上的任意一点的梯度转换到二维曲面
坐标系中的计算公式为
 
( )
( )
( )
( )
( )
, ,
,
, ,
,
, ,
f x y z
f x y z x
f x y z
fx y z y
f x y z
z
h x
h h h h
h x
x
x x x
é¶ ù
ê ú
é¶ ù 
é¶ ¶ ¶ ù¶
ê ú
ê ú 
ê ú
¶ ¶ ¶ ¶ 
ê¶
 ú
ê ú 
=ê ú
ê ú
ê ¶ú ê
¶ ¶ ¶ 
ú¶
ê ú
ê ú 
ê ú
¶ ë
¶ ¶ ¶ 
ûê ¶ ú
ë û
ê ú
ë¶ û
              (6-15) 
根据式
(6-13)~(6-15)
，当知道了函数 
f(x, y, z) 
在柱面上任意一点的梯度，即
可求得函数 
( )
f 
h
,
x 
在该点的梯度理论解。与此同时，我们也可以根据式
(6-12)  
得
函数 
( )
f 
h
,
x 
在该点的梯度近似解，但事先需要采用流形学习算法根据图
6.7(a)
中的 
2000 
个离散点构建图 
6.7(b)
中二维曲面空间的近似空间。图 
6.8 
为采用基于
最小子集覆盖的 
L-ISOMAP 
算法得到的半圆柱面上 
2000 
个点在二维空间的投影
，邻域参数k
 
=
30。显然，整个投影区域与图 
6.7(a)
中的半圆柱面展平之后的形
状是非常相似的。
 
在图 
6.7(a)
中的半圆柱面上随机生成 
10 
个测试点，并假设函数 
f(x, y, z) 
在
这 
10 
个测试点的梯度向量均为
(1,1,1)
。表 
6.1 
列出了函数f
(
h
,
x
) 
在这
10 
个测试
点的梯度理论解与近似解以及理论解与近似解之间的夹角。从表中可以看出：在
10 
个测试点中函数f
(
h
,
x
) 
梯度的近似解偏离理论解最多
1.5322
°，最少仅西北工业大学博士学位论文
 
108 
 
0.0917
°，说明
(6-12)
所给出的将优化目标在高维空间中的梯度信息转换到低维
流形空间的计算方法是合理的。
 
   
(a)                                       (b) 
图 
6.7  
三维空间坐标系及分布在三维半圆柱面上的 
2000 
个离散点
(a)
，在半圆柱面上建立的
二维曲面坐标系
(b) 
 
图 
6.8  
流形学习算法求得的半圆柱面上 
2000 
个点在二维空间的投影
 
表 
6.1  
半圆柱面上 
10 
个测试点在二维曲面坐标系中的梯度理论解与近似解以及理论解与近
似解之间的夹角
 
测试点
编号
 
理论解
  
近似解
 
理论解与近似解
之间夹角
( 
°
 ) 
f
(
h
,
x
)
h
¶
¶
 
f
(
h
,
x
)
x
¶
¶
 
f
(
h
,
x
)
h
¶
¶
 
f
(
h
,
x
)
x
¶
¶
 
1 
1.1751   1.0000   1.1512   0.9638   0.4624  
2 
1.2945   1.0000   1.2954   0.9827   0.5015  
3 
-0.0239   1.0000   -0.0304   0.9953   0.3833  
4 
0.1977   1.0000   0.2214   1.0123   1.1548  
5 
0.9907   1.0000   0.9944   0.9705   0.9638  第六章
  
基于 
ISOMAP 
的设计空间过滤与重构
 
 
109
 
 
6 
1.2077   1.0000   1.2130   0.9814   0.6472  
7 
1.3063   1.0000   1.2871   0.9820   0.0917  
8 
0.5569   1.0000   0.5189   0.9915   1.4859  
9 
1.1336   1.0000   1.1616   0.9707   1.5322  
10 
0.9131   1.0000   0.9467   0.9838   1.4998  
 
6.4  
方法适用性检验
 
本节将把设计空间过滤与重构方法分别应用于本文第二章构建的三套气动
外形优化设计系统，以检验方法在不同用途气动外形优化系统中的适用性。
 
6.4.1  
在气动力直接求解的全局型优化系统中的适用性
 
采用本文 
2.6.1 
小节构建的基于气动力直接求解的全局型优化系统对
NACA-0012 
翼型进行优化。设计状态为：马赫数 
Ma 
=
0.3 
，雷诺数 
6
Re 
=
5.0 
´
10
，升力系数C
l 
=
0.9 。优化目标为阻力系数
Cd 最小，约束条件为翼型最大厚度
不减小。求解器采用 
xfoil
，参数化方法采用 
Hicks-Henne 
参数化方法，翼型上下
表面各布置 
4 
个 
Hicks-Henne 
扰动鼓包。
 
当 不 对 设 计 空 间 事 先 进 行 几 何 过 滤 及 重 构 时 ， 设 计变量即为 
8 
个
Hicks-Henne 
扰动鼓包的高度系数。在优化过程中，对于所对应翼型最大厚度小
于 
NACA-0012 
最大厚度的个体采用罚函数法对其适应值进行惩罚，罚函数的具
体形式为
 
( )
max max
Cd 
=
Cd
¢ +
0.2 0.12 
-
t(t 
<
0.12) 
     (6-16) 
其中，C
d 为个体适应值，
Cd
¢
为求解器输出的阻力系数，
max
t 为个体对应翼型的
最大厚度。
 
当对设计空间事先进行几何过滤及重构时，首先需要提取一定数量的满足约
束条件的样本。根据 
6.3.1 
小节中的讨论，在此过程中需要将关于翼型最大厚度
的不等式约束进行适当修改以使得满足约束条件的样本位于嵌入在设计空间的
超曲面上。为此，在采样过程中将最大厚度约束修改为：
 
max
0.12 
£
t 
£
0.122 
                     (6-17) 
共采集 
3000 
个满足上述约束条件的样本。采用基于最小覆盖子集的邻域参
数与本征维度估算方法对 
3000 
个样本点的分析结果表明这些样本点位于一个 
7
维流形上，而流形学习算法可以使用的 k
 邻域参数范围为 
16~40
。设置k
 
=
40，西北工业大学博士学位论文
 
110 
 
采用基于最小覆盖子集的 
L-ISOMAP 
算法将样本点投影到 
7 
维流形空间。基于
所有样本点在 
8 
维几何参数空间及 
7 
维流形空间的坐标采用式
(6-9)
构建从 
7 
维流
形空间到 
8 
维参数空间的映射。在流形空间中进行优化时，评估每个个体的适应
值的过程如下：首先计算出该个体在 
8 
维几何参数空间的坐标，然后根据得到的
几何参数生成相应的翼型，最后采用求解器进行气动参数评估。从 
6.3.1 
小节的
验证算例可知：在所构建的 
7 
维流行空间中存在少量的点，其对应翼型的最大厚
度会略小于设定的几何约束下限。为此，在 
7 
维流形空间中进行优化时仍然需要
设置罚函数，为使结果可比性更强，我们仍然采用式
(6-16)
所示的罚函数。
 
在两组不同的 
ADMPDE 
优化算法参数设置下分别在几何参数空间及满足几
何约束的流形空间中进行寻优。第一组为小规模寻优参数，其种群规模仅为变量
个数的 
3 
倍且只寻优 
20 
代；第二组为大规模寻优参数，其种群规模为变量个数
的 
8 
倍且寻优 
100 
代。两组优化算法的其它参数均相同，其中变异因子与交叉因
子的下限均为 
0.1
，上限均为 
0.9
；局部增强因子为 
0.2
。表 
6.2
、
6.3 
分别为采用
两组优化算法参数在两个空间中进行 
10 
次优化实验得到的最优翼型的阻力系数
、阻力系数的均值及标准差的对比。从表中可以得出以下结论：
 
1
、不论是小规模寻优还是大规模寻优，优化算法在流形空间中寻优的结果
总体上明显优于在几何参数空间中寻优的结果。说明在流形空间中优化算法的寻
优能力更强；
 
2
、不论是小规模寻优还是大规模寻优，在流形空间中得到的 
10 
个最优翼型
的阻力系数标准差要小于从几何参数空间中得到的 
10 
个最优翼型的阻力系数标
准差。说明在流形空间中优化算法的寻优能力更稳定；
 
3
、相对于在几何参数空间中寻优的结果，优化算法在流形空间中小规模寻
优得到的结果与大规模寻优得到的结果更为接近。说明在流形空间中随着寻优规
模的增加优化算法的收敛性更好。
 
图 
6.9 
为在几何参数空间中第 
6 
次大规模寻优时的优化收敛历程与在流形空
间中第 
8 
次大规模寻优时的优化收敛历程的对比，这两次寻优得到的翼型分别为
两空间中 
10 
次大规模寻优得到的最优翼型中阻力最小的。图 
6.10(a)
为这两次寻
优得到的翼型之间及它们与 
NACA-0012 
翼型之间的几何外形对比；图 
6.10(b)
为三个翼型在设计状态下的表面压力分布对比。从图 
6.9 
中可以看出，在优化的
初始阶段，流形空间中的结果要明显优于几何参数空间中的结果；当寻优 
26 
代
后，优化算法在几何参数空间中即过早收敛。从图 
6.10(a)
中可以看出，优化得
到的两个翼型几何外形差异较大，但又具有非常相似的局部几何特征，例如后缘
厚度很薄、弯度很大，头部厚度很大。从图 
6.10(b)
中还可以看出，两翼型在设
计状态下的表面压力分布也较为相似。这些现象说明：两次寻优分别找到了设计第六章
  
基于 
ISOMAP 
的设计空间过滤与重构
 
 
111
 
 
空间中两个相距较远的目标函数极小值点，但维度更低且基本满足几何约束的流
形空间有利于优化算法在初始阶段即锁定最优解的大致区域，并且也能有效防止
优化算法过早地陷入局部最优。
 
此算例表明：满足几何约束的设计空间提取与重构方法适用于基于现代启发
式算法与直接气动力求解的优化系统。
 
表 
6.2  
种群规模为变量个数 
3 
倍寻优 
20 
代
结果
 
实验编号
  
参数空间
  
流形空间
 
1 
84.80E-04  83.99E-04 
2 
85.19E-04  83.79E-04 
3 
85.19E-04  83.79E-04 
4 
85.37E-04  83.60E-04 
5 
86.70E-04  83.79E-04 
6 
85.69E-04  83.10E-04 
7 
85.10E-04  83.69E-04 
8 
86.96E-04  82.79E-04 
9 
86.39E-04  83.10E-04 
10 
84.60E-04  82.70E-04 
均值
 
85.60E-04  83.43E-04 
标准差
 
0.81E-4  0.47E-04 
 
表 
6.3  
种群规模为变量个数 
8 
倍寻优 
100 
代
结果
 
实验编号
  
参数空间
  
流形空间
 
1 
83.60E-04  82.00E-04 
2 
84.69E-04  82.90E-04 
3 
82.59E-04  82.59E-04 
4 
83.60E-04  82.90E-04 
5 
82.40E-04  82.59E-04 
6 
82.29E-04  82.09E-04 
7 
82.59E-04  82.79E-04 
8 
83.10E-04  81.79E-04 
9 
83.90E-04  82.90E-04 
10 
82.79E-04  82.40E-04 
均值
 
83.16E-04  82.50E-04 
标准差
 
0.77E-4  0.41E-04 
 
 
图 
6.9  
几何参数空间与流形空间中两次大规模寻优的优化收敛历程的对比
 西北工业大学博士学位论文
 
112 
 
  
(a)                                       (b) 
图 
6.10  
不同空间中大规模寻优所得最优翼型之间及其与 
NACA-0012 
翼型之间的几何外形
对比
(a)
，及三个翼型在设计状态下的表面压力分布对比
(b) 
6.4.2  
在使用代理模型的全局型优化系统中的适用性
 
验证了方法在气动力直接求解的全局型优化系统中的适用性之后，只需验证
代理模型在满足几何约束的流形空间中预测精度不会发生显著变化即可证明方
法在基于现代启发式算法与代理模型的优化系统中也是适用的。为此，在上一小
节算例的基础上分别在几何参数空间与满足几何约束的流形空间中随机产生数
量为设计变量 
30 
倍的样本点，采用 
xfiol 
计算这些样本点所对应翼型在设计状态
下的阻力值。基于所取得的样本，分别在两空间中构建预测设计变量所对应翼型
阻力系数的 
Kriging 
代理模型。额外，再在两空间中分别产生 
50 
个测试点，采
用 
xfoil 
计算这些测试点所对应翼型在设计状态下的阻力值。最后分别用所构建
的 
Kriging 
代理模型预测其所在空间中 
50 
个测试点所对应翼型的阻力值。图 
6.11
、
6.12 
分别为几何空间与流形空间中所构建的代理模型对各自空间中 
50 
个测试
点阻力系数的预测结果与 
xfiol 
计算结果的对比。从图中可以看出：几何空间中
构建的代理模型预测精度远远高于流形空间中构建的代理模型预测精度。在几何
空间中，代理模型预测的阻力最大误差为 
0.547counts
，通常这样的精度在气动
外形优化中是可以接受的；但在流形空间中，代理模型预测的阻力最大误差达到
了 
5.244counts
，这样的精度基本上是无法接受的。进一步，将流形空间中的样
本数量增加到设计变量的 
50 
倍，即 
350 
个，然后构建 
Kriging 
代理模型对之前
的 
50 
测试点处的阻力进行预测。图 
6.13 
为预测结果与计算结果的对比，显然，
此时代理模型的预测精度仍然很差，其预测阻力最大误差为 
3.821counts
，仍然
不能满足气动优化设计的需求。
 第七章
  
设计算例及分析
 
 
113
 
 
从该算例可以得出如下结论：满足几何约束的设计空间提取与重构方法不能
适用于基于现代启发式算法与代理模型的气动外形优化系统。
 
   
图 
6.11  
几何空间中代理模型预测的阻力系
数与 
xfoil 
计算结果的对比
 
图 
6.12  
流形空间中代理模型预测的阻力系
数与 
xfoil 
计算结果的对比
 
 
图 
6.13  
流形空间中增加样本点数量后代理模型预测的阻力系数与 
xfoil 
计算结果的对比
 
6.4.3  
在基于梯度信息的优化系统中的适用性
 
采用本文 
2.6.3 
小节构建的基于梯度信息的气动外形优化系统对 
RAE-2822
翼型进行优化。设计状态为：马赫数 M
a 
=
0.72 ，雷诺数 
6
Re 
=
5.6 
´
10 
，升力系
数C
l 
=
0.773。优化目标为阻力系数
Cd 最小，约束条件为翼型最大厚度不减小
。图 
6.14 
展示了 
RAE-2822 
翼型的几何外形及优化所用的 
FFD 
控制框，图中 
4
个蓝色的 
FFD 
控制点在优化过程中保持不动，
12 
个红色的 
FFD 
控制点在优化中
只改变纵坐标。即，实际控制翼型外形的几何参数为 
12 
个。
 西北工业大学博士学位论文
 
114 
 
 
图 
6.14   RAE-2822 翼型及其 
FFD 
控制框
 
当不对设计空间事先进行几何过滤及重构时，设计变量即为 
12 
个红色 
FFD
控制点的纵坐标。因本文所使用的基于黄金分割线性搜索的最速下降法不能处理
几何方面的约束，故在几何空间中优化时不考虑翼型最大厚度不减小的约束，只
面向阻力最小进行优化。
 
当对设计空间事先进行几何过滤及重构时，首先需要提取一定数量的满足约
束条件的样本。为此，需要将翼型最大厚度不减小的不等式约束进行适当修改以
使得满足约束条件的样本位于嵌入在设计空间的超曲面上。修改后的翼型最大厚
度约束条件为
 
max
0.123 
£
t 
£
0.125 
                     (6-18) 
其中，0
.123为 
RAE-2822 
的相对厚度。按照修改后的约束条件采集 
2000 
个样本
，采用基于最小覆盖子集的邻域参数与本征维度估算方法对这 
2000 
个样本点进
行分析。结果表明：这些样本点位于一个 
11 
维流形上，而流形学习算法可以使
用的k邻域参数范围为 
18~45
。设置k
 
=
45，采用基于最小覆盖子集的 
L-ISOMAP
算法将样本点投影到 
11 
维流形空间。在流形空间寻优过程中，任意一点对应的
梯度求解方法如下：首先根据式
(6-9)
计算出该点在几何空间中的坐标，进而利用
FFD 
参数化方法得到该点对应的几何外形；然后采用 
RANS 
方程求解器计算几
何外形的流场，基于求得的流场进一步采用离散伴随方程求解器计算出构型阻力
系数在几何空间中的梯度；最后根据式
(6-12)
计算出构型阻力系数在流形空间中
的梯度。
 
图 
6.15(a)
、
(b)
分别为优化算法在两空间中自 
RAE-2822 
翼型出发优化得到
的翼型与 
RAE-2822 
翼型的对比，以及三个翼型在设计状态下的表面压力分布对
比。其中几何空间中优化后的翼型在设计状态下的阻力系数为 
141.34counts
；流
形空间中的优化后的翼型在设计状态下的阻力系数为 
141.44counts
；
RAE-2822
翼型在设计状态下的阻力系数为 
155.46counts
。显然，优化算法在两空间中得到
的翼型阻力性能基本相当，相对于 
RAE-2822 
阻力系数均减少了约 
14counts
。优
化后翼型阻力的显著减小反映到图 
6.15(b)
中的表面压力分布上即为翼型上表面
的激波被抹平。
 
对两优化后的翼型的几何分析表明：几何空间中优化后的翼型的最大厚度为
12.00%
，相对于 
RAE-2822 
减小了 
2.5%
；流形空间中优化后的翼型的最大厚度
为 
12.31%
，相对于 
RAE-2822 
增加了 
0.01%
。从图 
6.5(a)
中也能很明显的看出三第七章
  
设计算例及分析
 
 
115
 
 
翼型之间的最大厚度差异。显然，在几何空间中的优化过程并没有得到满足约束
条件的结果，而在流形空间中的优化过程则得到了满足约束条件的结果。
 
为了使得几何空间中优化后的翼型也满足几何约束条件，采用 
Xfoil 
将其最
大厚度放大到 
12.3%
。数值评估结果表明：厚度放大后的翼型在设计状态下的阻
力系数为 
143.86counts
，相对于最大厚度放大前增加了 
2.52counts
。图 
6.16 
为
RAE-2822 
翼型、流形空间中优化后的翼型以及几何空间中优化后的翼型最大厚
度放大后在设计状态下的表面压力分布对比。从图中可以看出：几何空间中优化
后的翼型最大厚度放大后翼型上表面出现了明显的弱激波。
 
此算例表明：满足几何约束的设计空间提取与重构方法适用于基于梯度信息
的气动外形优化系统。
 
   
(a)                                       (b) 
图 
6.15  
优化算法在两空间中自 
RAE-2822 
翼型出发优化得到的翼型与 
RAE-2822 
翼型的对
比
(a)
，及三个翼型在设计状态下的表面压力分布对比
(b) 
 
图 
6.16
 
RAE-2822 
翼型、流形空间中优化后的翼型以及几何空间中优化后的翼型最大厚度放
大后在设计状态下的表面压力分布对比
 西北工业大学博士学位论文
 
116 
 
  第七章
  
设计算例及分析
 
 
117
 
 
第七章
  
设计算例及分析
 
本章将采用本文构建的三套基本气动外形优化设计系统及基于数据降维方
法发展的各种新技术、新方法对 
L1T2 
二维多段翼型及某远程宽体客机机翼进行
气动外形优化设计，以检验本文研究成果的实用性。
 
7.1  
二维多段翼型优化设计
 
文献
[113]
采用基于伴随方程的气动外形优化方法对 
L1T2 
三段翼型的襟翼
进行了几何外形、缝道参数及偏角的优化。优化设计状态为：马赫数 M
a 
=
0.197
，雷诺数 
6
Re 
=
4.6 
´
10 
，迎角 a
 
=
20.18 °；优化目标为：设计状态下的升力系数
最大。优化收敛之后得到的最优构型较之初始构型，设计状态下的升力系数由
3.81 
增加到 
3.89
。相对于初始襟翼，优化后的襟翼外形、缝道参数均有一定的变
化，但偏角只是由初始的 
25
°增加到了 
26.3
°，增量偏小。通常情况下，面向
大迎角下升力系数最大设计的典型三段翼型的襟翼偏角至少在 
30
°以上，有时
甚至能达到 
40
°。基于此，本文猜测文献
[113]
得到的优化结果仅仅是一个局部
最优解，应该还有进一步优化的潜力。为此，本文采用基于代理模型的全局型优
化系统对 
L1T2 
襟翼的外形、偏角及缝道参数进行了重新优化。
 
7.1.1  
优化对象及优化模型的建立
 
图 
7.1 
为 
L1T2 
三段翼型几何外形，图 
7.2 
为文献
[113]
中所使用的 
FFD 
参数
化方法的控制框。其中绿色的控制框在优化过程中保持外形不变，只改变框在水
平方向与竖直方向的位移以及偏角，用于对襟翼的缝道及偏角进行参数化；蓝色
的控制框上只有襟翼外侧除两端之外的控制点可以移动，移动方向仅限于襟翼内
外控制点的连线方向，以此来改变襟翼的几何形状。因此，优化过程中的参数个
数总共是 
12 
个，其中 
3 
个用于控制襟翼的位置与偏角，
9 
个用于控制襟翼的外
形。在本文的优化过程中也采用上述参数化方法。
 
 
 
图 
7.1 L1T2 
三段翼型
 西北工业大学博士学位论文
 
118 
 
 
图 
7.2  
控制襟翼几何外形及缝道参数、偏角的 
FFD 
控制框
 
构建初始 
Kriging 
代理模型的样本数设置为 
200 
个。在求解样本点对应构型
流场的过程中，采用基于初始流场预测的流场加速求解方法。其中求解前 
100
个样本构型流场时，采用基于几何相似的初始流场预测方法加速求解过程；求解
后 
100 
个样本构型流场时，采用基于代理模型与 
POD 
的初始流场预测方法加速
求解过程。图 
7.3 
展示了采用三种不同求解方法求解第 
101 
个样本构型流场时的
升力系数收敛过程示意图，其中第 
6 
个样本构型是前 
100 
个样本构型中按马氏距
离与第 
101 
个样本构型最相似的构型。从图中可以看出：若采用求解器直接求解
，则升力系数完全收敛需要 
8000 
个迭代步；如果采用基于几何相似的初始流场
预测方法在第 
6 
个样本构型流场的基础上进行求解，则升力系数完全收敛只需要
3000 
个迭代步；如果采用基于代理模型与 
POD 
的初始流场预测方法事先预测出
第 
101 
个样本构型的初始流场然后再进行求解，则升力系数完全收敛只需要 
1500
个迭代步。
 
初始代理模型构建完毕之后采用 
ADMPDE 
算法进行优化设计，算法参数设
置如下：种群规模为 
50
，优化代数为 
50
，交叉因子上限为 
0.1
、下限为 
0.9
，变
异因子上限为 
0.1
、下限为 
0.9
。优化过程中采用紧密式代理模型管理框架对
Kriging 
代理模型进行更新，具体操作为：从每代种群中挑选出适应度最大的个
体与预测方差最大的个体进行校核计算，然后将校核计算结果加入到样本集中，
最后对 
Kriging 
代理模型进行更新。即，优化过程中还将共计再调用 
100 
次 
RANS
方程求解器。
 第七章
  
设计算例及分析
 
 
119
 
 
 
图 
7.3  
采用三种不同求解方法求解第 
101 
个样本构型流场时的升力系数收敛曲线对比
 
7.1.2  
优化设计结果及分析
 
图 
7.4 
为优化前后襟翼外形、位置及偏角的对比。从图中可以看出，优化后
襟翼头部略微增厚，襟翼与主翼之间的重叠量与缝道宽度均略有减小，但襟翼偏
角显著增大—由原始构型的 
25.0
°增加到 
35.4
°，增加了 
10.4
°。
RANS 
方程求
解器的评估结果表明：初始构型在设计状态下的升力系数为 
3.94
，优化构型在设
计状态下的升力系数为 
4.28
，相对初始构型增加了 
8.63%
。而在文献
[113]
中，优
化构型相对初始构型设计状态下的升力系数仅仅增加了 
2.03%
，不及本文结果的
1/4
。文献
[113]
优化构型与本文优化构型的主要区别在于襟翼的偏角变化—文献
[113]
中优化构型襟翼偏角仅仅增加了 
1.3
°。这说明基于梯度信息的优化设计系
统比较适用于初始构型较为接近全局最优构型的情况，而不太适用于初始构型远
离全局最优构型的情况。
 
图 
7.5 
为优化前后构型的表面压力分布对比，可以看出优化后缝翼、主翼及
襟翼的头部负压峰值均显著升高。根据转储效应理论
[152,153]
，襟翼头部负压峰值
升高有利于加速前方主翼及缝翼上表面的气流流动，这对于升力系数的增加是有
利的。图 
7.6 
为优化前后构型的流场马赫数云图对比，显然优化后缝翼及主翼的
尾迹滞止区范围明显变大。这主要是由襟翼偏角增加以及前方主翼、缝翼上表面
气流速度增加共同引起的，而范围更大的尾迹滞止区对于失速迎角的提升是不利
的
[154]
。本文的优化目标为指定迎角下的升力系数最大，并没有考虑失速特性，
故综合来看本文的优化设计是非常成功的。
 
纵观整个优化设计过程，本文采用的基于初始流场预测的流场加速求解方法
相对于采用求解器直接进行流场求解的方法大约节省了 
75%
的流场求解时间，证西北工业大学博士学位论文
 
120 
 
明本文第五章提出的流场加速求解方法在气动外形优化设计中是非常实用的。
 
   
图 
7.4  
优化前后构型几何对比
             
图 
7.5  
优化前后构型的表面压力分布对比
 
   
(a)  
初始构型
                              (b)  
优化后构型
 
图 
7.6  
优化前后构型的流场马赫数云图对比
 
7.2  
远程宽体客机机翼优化设计
 
图 
7.7 
为某常规布局远程宽体客机翼身组合体的几何外形示意图，其巡航设
计状态为：马赫数 M
a 
=
0.85，雷诺数 
7
Re 
=
4.96 
´
10 
，升力系数 C
l 
=
0.515 ，本
节将对其机翼进行巡航状态下的减阻优化设计。为了保证气动外形的改变不会损
害机翼的结构性能及装载性能，要求最终设计结果在各个控制剖面处的前梁厚度
、最大厚度及后梁厚度相对原始构型不减小，用数学公式表述为：
 
new original
new original
new original
FBT FBT
BBT BBT
Max T Max T
ì ³
ï
í
³
ï
³
î
                      (7-1) 
式中， 
FBT 
、 
BBT 
、 
Max T 
分别代表前梁厚度、后梁厚度及最大厚度，下
标
new 
、
original 
分别代表新构型与原始构型。通常，以 
Boeing-737
、
A320 
为代第七章
  
设计算例及分析
 
 
121
 
 
表的窄体客机巡航马赫数在 
0.78 
左右，而这里的巡航马赫数高达 
0.85
，且几何
约束条件较为苛刻，所以机翼气动性能设计难度更大。为此，本节将采取如下的
优化设计策略：首先基于低精度的气动力求解器对初始构型进行全局性的初步优
化设计和反设计，然后采用 
RANS 
方程求解器对初步优化结果和反设计结果进
行校核评估，最后从两构型中挑选出综合性能较好的进行基于 
RANS 
方程求解
器的精细优化设计。
 
  
图 
7.7  
远程宽体客机翼身组合体外形
 
7.2.1  
基于全局型优化系统的粗略优化设计
 
7.2.1.1  
优化模型的建立
 
本小节将采用基于气动力直接求解的优化系统对图 
7.7 
中的构型进行巡航状
态下的初步减阻优化设计，优化过程中的气动力求解器为耦合求解全速势方程与
附面层方程的气动力快速评估程序。图 
7.8 
展示了机翼上沿展向选定的 
9 
个设计
剖面，其中第 
1 
个设计剖面已经没入到机身中。采用 
5 
阶 
CST 
参数化方法对选
定的设计剖面进行参数化，这样每个设计剖面上下表面分别有 
6 
个设计参数，整
个机翼共有 
108 
个设计参数。按照指定的约束条件，每个剖面上有 
3 
个约束条件
，优化过程中的几何约束数量共计有 
27 
个。
 
      
图 
7.8  
机翼设计剖面示意图
 西北工业大学博士学位论文
 
122 
 
为了减少几何约束对优化过程造成的不利影响，采用基于流形学习的设计空
间过滤与重构方法事先将设计空间中不满足几何约束的部分剔除，再基于剩余的
、满足所有几何约束的部分构建新的设计空间。具体操作过程为：首先，将每个
设计剖面需要满足的几何约束条件修改为
 
+0.2 %
new original
new original
original new original
FBT FBT
BBT BBT
Max T c Max T Max T
ì ³
ï
í
³
ï
³ ³
î
    (7-2) 
式中
c 
代表设计剖面的弦长。然后采用设置好的 
CST 
参数化方法对每个设计
剖面进行随机扰动，对扰动过程中生成的新剖面进行几何特性评估，将满足式
(7-2)  
所有约束条件的新剖面对应的几何参数记录下来作为流形学习算法的样本
。按照上述方法，在每个设计剖面处均产生 
4000 
个样本。采用基于最小覆盖子
集的邻域参数与本征维度估算方法对采集到的样本进行本征维度分析，分析结果
表明每个设计剖面上的 
4000 
个 
12 
维的样本点均分布在 
11 
维的流形空间上。最
后采用基于最小子集覆盖的 
L-ISOMAP 
方法将每个设计剖面上的样本点投影到
其所在的 
11 
维流形空间，并构建从流形空间返回高维空间的映射。这样，优化
过程不仅可以在基本满足式
(7-2)
约束条件的 
9 
个流形空间中进行，进而大幅减少
优化过程中生成的不满足几何约束条件个体的数量，并且设计参数也由原来的
108 
个减少到 
99 
个。
 
完成设计空间的过滤与重构之后，采用 
ADMPDE 
算法进行优化设计，算法
参数设置如下：种群规模为 
367
，优化代数为 
200
，交叉因子上限为 
0.1
、下限为
0.9
，变异因子上限为 
0.1
、下限为 
0.9
。
 
7.2.1.2  
优化设计结果及分析
 
初始构型在设计状态下的阻力系数为 
233.9counts
，优化构型在设计点的阻
力系数为 
225.6counts
，相对原始构型减少了 
8.3counts
。图 
7.9 
为沿展向截取剖面
翼型及表面压力分布的 
9 
个截面位置示意图。其中除了第 
1 
个、第 
9 
个截面与图
7.8 
中的第 
1 
个、第 
9 
截面位置略有差异外，其余截面与图 
7.8 
中对应编号的截
面位置相同。图 
7.10 
为这 
9 
个截面处优化前后翼型与表面压力分布的对比，图
7.11 
为优化前后机翼表面的压力云图对比。从图中可以看出：除了翼稍附近外，
优化后机翼上表面其它展向位置处的激波均有所减弱，尤其是外翼段减弱得最为
明显。图 
7.11 
为优化前后机翼上 
9 
个设计剖面的厚度特性的对比，除个别剖面
的某个厚度特征基本外保持不变之外，优化构型其余各个设计剖面的前梁厚度、
最大厚度及后梁厚度均有所增加。
 第七章
  
设计算例及分析
 
 
123
 
 
  
图 
7.9  
截取剖面翼型及表面压力分布的截面位置示意图
 
 
   
(a)  
截面 
1                   (b)  
截面 
2                   (c)  
截面 
3 
   
(d)  
截面 
4                   (e)  
截面 
5                    (f)  
截面 
6 西北工业大学博士学位论文
 
124 
 
   
(g)  
截面 
7                    (h)  
截面 
8                   (i)  
截面 
9 
图 
7.10  
优化构型与初始构型在 
9 
个截面处的翼型与表面压力分布对比
 
 
图 
7.11  
优化前后机翼表面压力云图对比
 
   
(a)  
前梁厚度
                 (b)  
最大厚度
                (c)  
后梁厚度
 
图 
7.12  
优化前后设计剖面厚度特性对比
 
从几何约束条件的满足情况及优化构型阻力的减小量来说，上述优化过程是
比较成功的，也说明本文提出的设计空间过滤与重构方法是适用的。但从图 
7.10
、
7.11 
中可看出优化构型存在以下两个问题：
 
1
、翼稍处激波不仅没有减弱反而还有所增强。这可能是由于设计变量太多
，优化算法的种群规模及寻优代数不足以使优化过程收敛所致；
 第七章
  
设计算例及分析
 
 
125
 
 
2
、优化构型机翼上表面等压线相对于原始构型更加混乱，这不符合机翼上
表面等压线沿展向应尽可能平直的设计准则
  [153]
。造成这种现象的部分原因可能
是设计参数太多，优化算法未收敛；另一部分原因可能是直接面向气动力的优化
过程不具备对表面压力分布形态加以考虑的能力。
 
7.2.2  
基于改进型 
Gappy POD 
反设计方法的反设计
 
7.2.2.1  
反设计过程
 
本节将采用改进的 
Gappy  POD 
反设计方法对上一节中的远程宽体客机机翼
进行初步地反设计。进行反设计首先需要给定目标压力分布，为此本文直接对初
始构型在图 
7.9 
中 
9 
个截面上的压力分布进行修改以给出能减小阻力的目标压力
分布。修改压力分布的原则如下：
1
、若存在激波则将激波抹平；
2
、除头部峰值
外，若压力分布起伏变化也将其抹平。图 
7.13 
为各个截面上初始构型的压力分
布与给定的目标压力分布之间的对比。根据 
4.3.1 
小节中的论述及设计过程可以
推断：设计出压力分布与图中目标压力分布完全吻合的气动外形是不可能的，但
图中的目标压力分布能引导设计过程向削弱激波、减小压力分布起伏的方向靠近
。
 
反设计中共使用了 
600 
个完整的快照，这些快照具体生成过程如下：采用 
5
阶 
CST 
参数化方法对图 
7.8 
中的 
9 
个控制剖面进行随机扰动，然后采用基于求解
全速势方程与附面层方程的气动力快速评估程序对随机生成的构型进行表面压
力分布求解，最后将 
9 
个控制剖面翼型离散点的纵坐标及图 
7.9 
中 
9 
个剖面翼型
离散点的压力系数值组装成一个完整快照。当所有完整快照生成之后即可进行反
设计，反设计的最大迭代步数为 
50 
步。
 
   
(a)  
截面 
1                   (b)  
截面 
2                   (c)  
截面 
3 西北工业大学博士学位论文
 
126 
 
   
(d)  
截面 
4                   (e)  
截面 
5                    (f)  
截面 
6 
   
(g)  
截面 
7                    (h)  
截面 
8                   (i)  
截面 
9 
图 
7.13 
反设计中给定的各个截面目标压力分布与初始构型各个截面压力分布的对比
 
7.2.2.2  
设计结果及分析
 
反设计最终结果在设计状态下的阻力系数为 
226.3counts
，较之初始构型减
小了 
7.6counts
，但比上一节优化构型的 
224.6counts 
大了 
1.7counts
。图 
7.14 
为反
设计构型与初始构型在图 
7.8 
中 
9 
个截面处的翼型及表面压力分布对比，图 
7.15
为反设计前后机翼表面的压力云图对比。从上述图中可以看出：较之初始构型，
反设计构型在各个剖面上的压力分布在一定程度上均向无激波的目标压力分布
靠近了，尤其是剖面 
5
、
6
、
7
、
8 
的激波明显有所减弱。较之初始构型与上一节
的优化构型，反设计构型机翼上表面的等压线沿展向也变得更加平直。图 
7.16
为反设计前后机翼上 
9 
个设计剖面的厚度特性的对比，与上一节的优化结果不同
的是，虽然反设计前后大部分设计剖面的前梁厚度、最大厚度及后梁厚度均有所
增加，但个别剖面的厚度约束条件没有得到满足。这是因为所用的反设计方法不
具备考虑几何约束的能力。不过，总体上反设计结果违反几何约束条件的情况不
严重。
 第七章
  
设计算例及分析
 
 
127
 
 
   
  (a)  
截面 
1                   (b)  
截面 
2                   (c)  
截面 
3 
   
(d)  
截面 
4                   (e)  
截面 
5                    (f)  
截面 
6 
   
(g)  
截面 
7                    (h)  
截面 
8                   (i)  
截面 
9 
图 
7.14  
反设计构型与初始构型在 
9 
个截面处的翼型与表面压力分布对比
 西北工业大学博士学位论文
 
128 
 
 
图 
7.15  
反设计前后机翼表面压力云图对比
 
   
(a)  
前梁厚度
                 (b)  
最大厚度
                (c)  
后梁厚度
 
图 
7.16  
反设计前后设计剖面厚度特性对比
 
7.2.3  
基于 
RANS 
方程求解器与梯度信息的精细优化设计
 
本节将首先采用 
RANS 
方程求解器对 
7.2 
节中的初步优化结果及 
7.3 
节中的
反设计结果进行设计状态下的性能评估，之后挑选其中性能较好且进一步设计潜
力更大者进行基于 
RANS 
方程的精细设计，优化设计工具为基于梯度信息的气
动优化系统。
 
7.2.3.1  
优化对象及优化模型的建立
 
设计状态下，
RANS 
方程求解器对初始构型、初步优化构型及反设计构型评
估的阻力系数分别为：
228.2counts
、
219.7counts
、
218.4counts
，显然，从阻力特
性来说，反设计构型在三个构型中是最优的。图 
7.17
、
7.18 
分别为初始构型与初
步优化构型及初始构型与反设计构型在设计状态下的机翼表面压力云图对比，从
图中可以看出：较之初始构型，初步优化构型与反设计构型的激波均明显减弱，
但初步优化构型机翼上表面等压线是三个构型中最为混乱的，这一点与耦合了附
面层方程的全速势方程求解器评估结果是一致的。综合 
RANS 
方程的评估结果
，反设计构型无论是阻力特性还是表面压力分布特性都是最好的，故将此构型作第七章
  
设计算例及分析
 
 
129
 
 
为进一步精细优化设计的对象。
 
 
图 
7.17   
初始构型与初始优化构型机翼表面压力云图对比
 
 
图 
7.18 
初始构型与反设计构型机翼表面压力云图对比
 
图 
7.19 
为对机翼几何外形进行参数化的 
FFD 
控制框及控制点，其中控制框
上、下表面最外围的一圈控制点在优化过程中保持不变，机翼的几何设计参数实
际为 
96 
个。因优化系统中的优化搜索算法不能处理几何约束，而优化设计任务
中又对机翼控制剖面的前、后梁及最大厚度均有下限要求，故在正式开始优化之
前先对设计空间进行过滤，然后重建一个基本处处满足几何约束的新设计空间。
具体操过程为：在设计空间中随机生成 
20000 
个满足式
(7-2)
所表达约束条件的几
何外形，然后采用本文开发的基于最小子集覆盖与 
SVD 
的邻域参数与本征维度
估计方法对满足约束的几何样本集合进行分析，最后根据分析结果采用
L-ISOMAP 
构建满足约束的新设计空间。需要特别指出的是：因图 
7.8 
中最内侧
的设计剖面不在 
FFD 
控制框之内，故在对随机生成的几何构型进行是否满足约
束条件的评估时实际只考虑了 
24 
个约束条件，其中 
8 
个为近似等式约束条件，
16 
个不等式约束条件。对 
20000 
个满足所有约束条件的几何构型的分析结果表西北工业大学博士学位论文
 
130 
 
明，其所在流形空间的本征维度为 
86
，与初始设计参数个数减去近似等式约束
个数的结果不相等，这可能与等式约束个数较多时满足部分约束条件的设计空间
与满足另一部分约束条件的设计空间有部分重合有关。
 
 
图 
7.19  
参数化机翼几何外形的 
FFD 
控制框及控制点
 
7.2.3.2  
设计结果及分析
 
精细优化设计的最终结果在设计条件下的阻力系数为 
214.1counts
，较之初
始构型的 
228.2 counts 
减小了 
14.1counts
，减小量为 
6.2%
，相对于反设计构型的
218.4counts 
也减小了 
4.3counts
。图 
7.20 
为优化构型与初始构型在图 
7.9 
中 
9 
个
截面处的翼型及表面压力分布对比，图 
7.21 
为两构型机翼上表面的压力云图对
比。从上述图中可以看出：优化构型机翼表面已基本不存在激波，且机翼上表面
的等压线沿展向也变得更加平直。图 
7.22 
为优化构型与初始构型在图 
7.8 
中 
9
个设计剖面处的厚度特性对比。从图中可以看出，除个别剖面的某些厚度特征基
本保持不变之外，优化构型其余各个设计剖面的前梁厚度、最大厚度及后梁厚度
均有所增加。说明本文提出的设计空间过滤与重构方法是实用的—尤其是这里的
优化算法完全不具备考虑几何约束的能力。
 
   
(a)  
截面 
1                   (b)  
截面 
2                   (c)  
截面 
3 第七章
  
设计算例及分析
 
 
131
 
 
   
(d)  
截面 
4                   (e)  
截面 
5                   (f)  
截面 
6 
   
(g)  
截面 
7                   (h)  
截面 
8                   (i)  
截面 
9
 
图 
7.20  
优化构型与初始构型在 
9 
个截面处的翼型与表面压力分布对比
 
 
图 
7.21  
优化构型与初始构型机翼表面压力云图对比
 
 西北工业大学博士学位论文
 
132 
 
   
(a)  
前梁厚度
                 (b)  
最大厚度
                (c)  
后梁厚度
 
图 
7.22  
优化前后设计剖面厚度特性对比
 
7.3  
设计算例总结
 
基于上述两个算例的完成过程及结果可以总结出以下几点对气动设计具有
指导和启发意义的结论。
 
1
、当设计变量与设计目标之间的关系较为复杂时，若初始构型与全局最优
构型性能相差很大，则基于梯度信息的气动外形优化设计系统陷入局部最优的可
能性非常大，并且其得到的局部最优构型与全局最优构型之间的性能差异也可能
会非常大；
 
2
、基于现代启发式算法的气动外形优化系统具有较强的全局寻优能力，但
这种全局寻优能力只有在设计参数不太多时才能发挥出来，当设计参数较多时算
法完全收敛所需的种群规模及优化代数在现实中难以得到满足，所以此时也只能
得到局部最优解；
 
3
、当设计参数较多时鲁棒性强的反设计方法较之基于现代启发式算法的优
化系统能更为快速、有效地改善初始构型的气动性能，在此基础上再进行基于梯
度信息的精细优化往往能得到较好的结果；
 
4
、将反设计方法与优化方法搭配使用的缺点在于：反设计过程本身是单目
标的，且设计过程中难以对几何约束加以考虑，这是反设计方法需要进一步改进
的方向。
 
  第八章
  
总结与展望
 
 
133
 
 
第八章
  
总结与展望
 
8.1  
研究总结
 
基于对已有气动外形设计方法优、缺点的分析，结合数据降维的思想，本文
分别对数据降维方法、气动外形反设计方法、气动优化过程中的流场求解加速方
法及气动优化过程中的几何约束处理方法开展了研究。以下分别对本文工作的创
新点及本文研究过程中得出的主要结论进行总结。
 
8.1.1  
论文创新点
 
1
、证明了 
POD 
方法与 
SVD 
方法在理论上的等价性
 
作为两种最常用的线性数据降维方法，虽然其推导过程迥异，但从几何学的
角度来说，两种方法的目的都是寻找线性空间的一组标准正交基，所以方法的目
的性已经决定了其在理论上的等价性。而本文则用严格的数学推导证明了这种理
论上的等价性。
 
2
、提出了一种估算数据集所在流形邻域参数范围与本征维度的新方法
 
针对流形学习算法需要事先确定数据集所在流形的恰当邻域参数及本征维
度的问题，提出了一种新型的邻域参数与本征维度估算方法。此方法采用 
SVD
对数据集不同邻域参数下最小子集覆盖中的每个子集进行本征维度分析，然后通
过统计本征维度随邻域参数的变化情况得到数据集所在流形的本征维度及适合
流形学习方法使用的邻域参数范围。
 
3
、对 
Gappy POD 
反设计方法的采样过程及迭代过程进行了改进
 
基于对原始 
Gappy   POD 
反设计方法的深入研究，本文提出了最优快照替
换采样法以取代原始 
Gappy  POD 
反设计方法中的随机采样法；此外，针对原始
Gappy  POD 
反设计方法迭代过程中产生的误差，本文还提出了一种设计过程中
实时修正目标压力分布的方法以提高反设计的精度。
 
4
、提出了将 
Gappy POD 
反设计方法与优化设计方法结合使用的设计策略
 
Gappy  POD 
反设计方法具有效率高、鲁棒性强的特点，而压力分布往往能
看出一个构型是否还有进一步改进的潜力。同时，低精度的流场求解器求解出的
压力分布往往与高精度求解器给出的结果相差不大。基于此，本文提出在优化设
计之前采用 
Gappy  POD 
反设计方法结合低精度的流场求解器先对初始构型进行
反设计，然后在反设计结果的基础上再进行精细优化设计的策略。
 
5
、提出了两种加快气动外形优化过程中流场求解速度的新方法
 
在基于现代启发式算法的气动外形优化设计过程中，即使使用代理模型也需西北工业大学博士学位论文
 
134 
 
要对大量气动外形较为相似的构型进行流场求解。针对这种情况，本文提出了两
种加速气动外形优化过程中流场求解的新方法。两种方法的基本原理都是在流场
正式求解之前先预测一个较为接近最终收敛结果的初始流场然后再进行流场求
解，但两种方法预测流场的具体方法不同。此外，根据两种方法各自的特点，本
文还提出了一种在优化设计中将两种方法搭配使用的策略，以最大限度地减少优
化设计中流场求解所需的时间。
 
6
、提出了一种针对几何约束的设计空间过滤与重构方法
 
在气动外形优化设计过程中各种几何约束往往是不可避免的，而几何约束的
存在会降低优化设计的效率，甚至有些高效的优化算法本身就不具备处理几何约
束的能力。为此，本文根据存在等式约束时设计空间的几何特点，提出了一种基
于 
L-ISOMAP 
的设计空间过滤与重构方法。理论上，此方法构建出的新设计空
间中的任何一个点都是满足所有几何约束条件的，同时新设计空间的维度也要低
于原始设计空间的维度，这两点对于优化算法来说是非常有利的。
 
8.1.2  
主要研究结论
  
1
、
POD 
方法与 
SVD 
方法在理论上是等价的，但两种方法的适用范围不同
。
POD 
方法适用于对大量超高维的数据集合进行分析，而 
SVD 
方法则适合对小
容量的数据集进行精细的分析；
 
2 
、 基于 最小子 集 覆盖 与 
SVD 
的 邻域参 数 与 本征维度 估 算 方法 搭配
L-ISOMAP 
方法使用能快速、准确的提取出蕴含在数据集中的流形结构；
 
3
、
Gappy POD 
反设计方法鲁棒性强，不论目标压力分布合理与否均能给出
压力分布尽可能接近目标压力分的气动外形。在引入本文提出的最优快照替换采
样法及目标压力分布实时修正方法后，
Gappy  POD 
反设计方法的设计精度提升
明显；
 
4
、反设计与优化设计结合使用的策略比单独使用优化设计的策略更有效。
此外，就初步设计而言，当设计参数较多时，反设计方法有可能比基于现代启发
式算法的优化系统更有效；
 
5
、本文提出的两种加快气动外形优化过程中流场求解速度的新方法均能有
效缩短流场求解的时间，且基于 
POD 
与代理模型的流场预测方法比基于几何相
似的流场预测方法效果更好。两种方法搭配使用可以最显著提升基于现代启发式
优化算法的优化设计效率；
 
6
、针对几何约束的设计空间过滤与重构方法构建出的设计空间基本是处处
满足所有几何约束条件的。此方法在基于现代启发式算法与直接气动力求解的优
化系统中是适用的，在基于梯度信息的优化系统中也是适用的，且使用此方法后第八章
  
总结与展望
 
 
135
 
 
两种优化系统均能得到更好的设计结果。但这种新方法在基于现代启发式算法与
代理模型的优化系统中不适用。
 
8.2  
研究展望
 
为了满足人们对飞行器性能越来越高的要求，飞行器设计方法正朝着多学科
、多目标的方向发展，而本文完成的研究工作还只是局限于飞行器设计中的气动
外形设计，且算例也是单目标的设计。从数据降维的思想及各种数据降维方法的
特点来说，本文开发的新技术、新方法是完全有潜力向多目标、多学科领域拓展
的。为实现上述目标，在本文已有研究基础上可继续开展的工作有如下几点：
 
1
、针对反设计方法不能面向多目标进行设计及设计过程中不能考虑几何约
束的缺点开展多目标且能考虑几何约束的高效反设计方法研究。从 
Gappy  POD
反设计方法的基本原理来说，此方法可以很容易地被改造为多目标反设计方法，
但如何在设计过程中对各种几何约束加以考虑还需深入地研究；
 
2
、将基于代理模型与 
POD 
的流场预测方法向其它学科推广。从基本原理来
说，此方法可以对任意物理场进行预测，所以可以很容易地推广到其它学科领域
。例如可以用来进行流固耦合问题中的表面载荷预测以及气动噪声问题中的噪声
频谱特性预测；
 
3
、开展基于流形的多目标优化方法研究。多目标优化问题的最优解集通常
被称为 
Pareto 
前沿，从几何学的角度来说，
Pareto 
前沿也是嵌入在高维空间中的
低维流形。因此，如果能用流形学习方法基于 
Pareto 
前沿上一定数量的离散点提
取出完整的 
Pareto 
前沿，则必然能大大提升多目标优化的效率。
 
  西北工业大学博士学位论文
 
136 
 
 
  参考文献
 
 
137
 
 
参考文献
 
[1]  Lighthill  J.  A  new  method  of  two-dimensional  aerodynamic  design.  Technical 
report A.R.C. R&M 2112, 1945: 105-157. 
[2]  华俊
.  
跨音速机翼和翼型的设计研究
.  
西安：西北工业大学，
1989. 
[3]  杨青真
.  
跨音速机翼设计方法改进与发展
.  
西安：西北工业大学，
1991. 
[4]  Carlson  L  A.  Transonic  Airfoil  Design  Using  Gartesian  Coordinates. 
NASA-GR-2578
，
1976. 
[5]  Sobieczky H, Yu N J, Fung K J, et. al. A New Method for Designing Shockface 
Transonic Configurations. AIAA-78-1114
，
1978
。
 
[6]  Henne  P  A,  Inverse  Transonic  Wing  Design  Method.  Journal  of  Aircraft, 
18:121-127, 1981. 
[7]  Mc Fadden G B. An Artificial Viscosity Method for the Design of Supercritical 
Airfoils. New York University, G00-3007-158
，
1979. 
[8]  Takanashi  S.  An  Iterative  Procedure  for  Three-Dimensional  Transonic  Wing 
Design by the Integral Equation Method. AIAA-84-2166
，
1984. 
[9]  Van  Egmond  J  A.  numerical  optimization  of  target  pressure  distribution  for 
subsonic and transonic airfoil design. AGARD CP No.463 Reference 17, 1990 
[10]  Van den Dam R F, Van Egmond J A, Sloof J W. Optimization of target pressure 
distributions. AGARD Report No.780, Reference 3, 1990 
[11]  Van  den  Dam  R  F.  Constrained  spanload  optimization  for  minimum  drag  of 
multi-lifting  surface  configuration.  AGARD  conference  proceeding  No.463 
reference 16, 1990. 
[12]  阎超
,  
谢磊
,
李云晓
,  
等
.  
翼型的气动最优化设计方法和反设计方法
.  
空气
动力学学报
. 1999, 17(1): 60-67. 
[13]  李秀娟
,  
廖文和
,  
刘浩
.  
基于翼型反设计的遗传算法
.  
南京航空航天大学 
学报
. 2007, 39(2):263-266. 
[14]  Bui-Thanh T, Damodaran M, Willcox K. Aerodynamic data reconstruction and 
inverse  design  using  proper  orthogonal  decomposition.  AIAA  JOURNAL, 
2004, 42(8): 1501-1516. 
[15]  袁亚湘，孙文瑜
.  
最优化理论与方法
.  
北京
:  
科学出版社，
1997. 
[16]  索永超
.  
求解非线性约束优化问题的一类 
Lagrange 
算法
.  
呼和浩特：内蒙
古工业大学，
2013. 
[17]  陈宝林
.  
最优化理论与算法
(
第二版
).  
北京：清华大学出版社，
2005. 西北工业大学博士学位论文
 
138 
 
[18]  Powell  M  J  D.  Fast  algorithms  for  nonlinear  constrained  optimization 
calculations. Berlin: Spring, 1977. 
[19]  Hooker  R,  Jeeves  T  A.  Direct  Search  Solution  of  Numerical  and  Statistical 
Problems.  Journal  of  the  Association  for  Computing  Machinery,  1961,  8: 
212-229. 
[20]  王振国
,  
陈小前
,  
罗文彩
,  
等
.  
飞行器多学科设计优化理论与应用研究
.  
北
京
:  
国防工业出版社
, 2006. 
[21]  Holland  J  H.  Adaptation  in  Natural  and  Artificial  Systems.  Cambridge:  MIT 
press, 1975. 
[22]  Kirkpatrick  S,  Gelatt  C  D.  Optimization  by  Simulated  Annealing.  Science, 
1983, 220:671-680. 
[23]  Storn R, Price K. Differential evolution: a simple and efficient adaptive scheme 
for global optimization over continuous spaces. Technical Report, International 
Computer Science Institute, 1995,(8):22-25. 
[24]  张德虎
.  
飞行器外形优化方法研究与应用
.  
西安：西北工业大学，
2013. 
[25]  Patrice  C,  Nadarajah  S  K.  Effect  of  Shape  Parameterization  on  Aerodynamic 
Shape Optimization. AIAA-2007-59-689, 2007. 
[26]  Sripawadkul  V,  Padulo  M,  Guenov  M.  A  Comparison  of  Airfoil  Shape 
Parameterization  Techniques  for  Early  Design  Optimization. 
AIAA-2010-9050-142, 2010. 
[27]  Kulfan  B  M,  Bussoletti  J  E.  
“
Fundamental
”
  Parametric  Geometry 
Representations for Aircraft Component Shapes. AIAA-2006-6948, 2006. 
[28]  Kulfan  B  M.  Universal  Parametric  Geometry  Representation  Method.  Journal 
of aircraft, 2008, 45(1): 142-158. 
[29]  Kulfan B M. A Universal Parametric Geometry Representation Method-
“
CST
”
. 
AIAA-2007-62, 2007. 
[30]  冯结青
,
叶修梓
.  
计算机辅助设计与制造中的外形分析
.  
北京
:  
机械工业出
版社
, 2005. 
[31]  孙玉娥
,  
林浒
,  
荣丽
.  
基于速度平滑控制的高效非均匀有理 
B 
样条曲线插
补算法
.  
计算机集成制造系统
, 2008, 14(11): 2248-2252. 
[32]  李际军
,  
方顾
.  
基于型值点拟合的非均匀有理 
B 
样条曲线曲面延拓算法
. 
计算机集成制造系统
, 2007, 13(8):1597-1602. 
[33]  Hicks R M, Henne P A. Wing Design by Numerical Optimization. Journal of 
Aircraft, 1978, 15:407-412. 参考文献
 
 
139
 
 
[34]  张扬
,  
白俊强
,  
朱军
,  
等
.  
改进 
Hicks-Henne 
型函数法在翼型参数化中的应
用
,  
飞行力学
, 2011, 29(5): 35-39. 
[35]  王丹
.  
跨音速翼型
/
机翼优化设计研究
.  
西安
:  
西北工业大学，
2011. 
[36]  Sederberg  T  W,  Parry  S  R.  Free-Form  Deform  of  Solid  Geometric  Models. 
Computer Graphics. 1986, 20(4): 151-160. 
[37]  Hsu  W  M,  Hughes  J  F,  Kaufman  H.  Direct  Manipulation  of  Free-Form 
Deformations. Computer Graphics. 1992, 26(2):177-184. 
[38]  白俊强，陈颂，华俊，等
.  
基于直接操作 
FFD 
技术的翼型气动优化设计
.  
航
空计算技术，
2013,43(1):40-43. 
[39]  Economon  T  D,  Palacios  F.  Optimal  Shape  Design  for  Open  Rotor  Blades. 
AIAA 2012-3018. 
[40]  巨龙，白俊强，孙智伟，等
.  
客机机翼环量分布的气动
/
结构一体化设计
.  
航
空学报，
2013, 34(12):2725-2732. 
[41]  张科施
.  
飞机设计的多学科优化方法研究
.  
西安：西北工业大学，
2006. 
[42]  Raymer D P. Aircraft Design: A conceptual approach. AIAA press, 2006. 
[43]  Whitfield D L. Computation of Transonic Viscous-Inviscid Interacting. NASA 
TM-85203, 1982. 
[44]  白俊强，华俊，张仲寅
.  
基于欧拉方程的跨音声速翼型设计
.  
空气动力学
学报，
1997,4
：
458-461. 
[45]  Spalart P R. Detached-Eddy Simulation. Fluid Mech. 2009. 41:181-202. 
[46]  黄江涛
.  
飞行器气动外形优化设计方法及应用研究
.  
西安：西北工业大学
，
  2012. 
[47]  Myers  R,  Montgomery  D.  Response  Surface  Methodology.  New  York:  John 
Wiley & Sons, Inc., 1995. 
[48]  阎平凡，张长水
.  
人工神经网络与模拟进化计算
.  
北京：清华大学出版社
，
2005. 
[49]  王波
. Stochastic Kriging 
建模方法及其在飞行器气动设计中的应用
.  
西安：
西北工业大学，
2013. 
[50]  Gibbs  M  N.  Bayesian  Gaussian  Processes  for  Regression  and  Classification. 
Cambridge: University of Cambridge, 1997. 
[51]  Lin  C  F,  Wang  S  D.  Fuzzy  support  vector  machines.  IEEE  Transection  on 
Neural Network, 2002, 13(2): 646-471. 
[52]  苏伟
.  
基于 
CFD 
技术和代理模型的气动外形优化设计方法研究
.  
西安：西
北工业大学，
2008. 西北工业大学博士学位论文
 
140 
 
[53]  白俊强
,  
王波
,  
孙智伟
,  
等
.  
基于松散式代理模型管理框架的亚音速机翼
优化设计方法研究
.  
空气动力学学报
, 2011,29(4): 515-519.  
[54]  Giunta  A  A,  Narducci  R,  Burgee  S,  Grossman  B,  et  al.  Variable-Complexity 
Response  Surface  Aerodynamic  Design  of  an  HSCT  Wing.  AIAA  Paper 
95-1886, 1995. 
[55]  Booker  A  J,  Frank  P  D,  Dennis  J  E,  et  al.  Managing  Surrogate  Objectives  to 
Optimize  a  Helicopter  Rotor  Design-Further  Experiment.  AIAA  98-4717, 
1998. 
[56]  Jin  Y,  Olhofer  M,  Sendhoff  B.  A  Framework  for  Evolutionary  Optimization 
with  Approximate  Fitness  Functions.  IEEE  Transactions  on  Evolutionary 
Computation, 2002, 6(5):481-94. 
[57]  江奕廷，白俊强，孙智伟
.  
基于参数敏感性分析的反设计方法
.  
航空计算
技术，
2012, 42(6):65-69. 
[58]  陈颂，白俊强，朱军，等
.  
基于自由变形技术和连续伴随方法的跨音速机
翼气动优化设计
. CSTAM2012-B03-0190, 2012. 
[59]  张朝磊
,  
厉海涛
,  
丰镇平
.  
基于离散伴随方法的透平叶栅气动优化设计
. 
工程热物理学报
, 2012, 33(1): 47-50. 
[60]  Bellmann R. Adaptive Control Processes: A Guided Tour. Princeton: Princeton 
University Press, 1961. 
[61]  谭璐
.  
高维数据的降维理论及应用
.  
长沙：国防科技大学，
2005. 
[62]  Holmes  P,  Lumley  J  L,  Berkooz  G.  Turbulence,  Coherent  Structures, 
Dynamical  Systems  and  Symmetry.  New  York:  Cambridge  University  Press, 
1996. 
[63]  Sirovich L. Turbulence and the dynamics of coherent structures, parts I-III. Q 
Appl Math 1987;45(3):561-571,573
–
590. 
[64]  Aubry N, Holmes P, Lumley J L, et, al. The dynamics of coherent structures in 
the wall region of a turbulent boundary layer. J Fluid Mech 1988:115
–
173. 
[65]  张贤达
.  
矩阵分析与应用
.  
北京，清华大学出版社，
2004. 
[66]  郭文彬
.  
奇异值分解及其在广义逆理论中的应用
.  
上海：华东师范大学，
2004. 
[67]  蒋明
,  
张桂林
,  
胡若澜
,  
等
.  
基于主成分分析的图像匹配方法研究
.  
红外与
激光工程
, 2000, 29(4): 17-21. 
[68]  高照锋
,  
冯慧
.  
基于主成分分析的图像匹配方法
.  
武汉大学学报
(  
理学版
), 
2002, 48(5): 558-560. 参考文献
 
 
141
 
 
[69]  Arnold  B.  An  investigation  in  to  using  singular  value  decomposition  as  a 
method of image compression. Christchurch: University of Canterbury, 2000.  
[70]  ANDREWS H C, Patterson C I. Singular Value Decomposition image coding. 
IEEE Transactions on Communications. 1976, 24(4): 425-432. 
[71]  郭新辰
,  
李成龙
,  
樊秀玲
.  
基于主成分分析和 
KNN 
混合方法的文本分类研
究
.  
东北电力大学学报
. 2013, 33(6): 60-63. 
[72]  杨俊
.  
基于核主成分分析和径向基神经网络的文本分类研究
.  
合肥：中国
科学技术大学
, 2009. 
[73]  孟晓倩
.  
基于 
PCA 
与多视图学习的中文文本分类研究
.  
保定：河北大学，
2010. 
[74]  刘贵龙
,  
王慧玲
,  
宋柔
.  
矩阵的奇异值分解在文本分类研究中的应用
.  
计 
算机工程
, 2002, 28(12): 17-19. 
[75]  赵学智
,  
叶邦彦
,  
陈统坚
.  
基于 
SVD 
的奇异性信号检测原理及其应用
.  
振
动与冲击，
2008, 27(6): 11-14. 
[76]  张蕾
.  
奇异值分解技术在卫星资料反演和同化中的应用研究
.  
兰州
:  
兰州
大学
, 2008. 
[77]  从飞云
.  
基于滑移向量序列奇异值分解的滚动轴承故障诊断研究
.  
上海
: 
上海交通大学，
2012 
年
. 
[78]  Lin W Z, Zhang Y J, Li E P. Proper orthogonal decomposition in the generation 
of  reduced  models  for  interconnects.  IEEE  Transactions  on  Advaned 
Packaging, 2008, 31(3): 627-636. 
[79]  Quinlan J R. Induction of decision trees. Machine Learning, 1986, 1: 81-106. 
[80]  Carroll J D, Chang J J. Analysis of individual differences in multidimensional 
scaling  via  an  N-way  generalization  of  
“
Eckart-Young
”
  decomposition, 
psychometrika, 1970, 35: 283-319. 
[81]  周祖德
,  
胡鹏
,  
刘泉
.  
一种基于 
MDS  
的无线传感器网络快速定位算法
.  
传
感技术学报
, 2007, 20(10): 2303-2307. 
[82]  陈岁生
,  
卢建刚
,
楼晓春
.  
基于 
MDS-MAP  
和非线性滤波的 
WSN  
定位算法
.  
浙江大学学报
(
工学版
), 2012, 46(5): 866-872. 
[83]  Scholkopf,  B.,  Nonlinear  Component  Analysis  as  a  Kernel  Eigenvalue 
Problem. Neural Computation, 1998, 10: 1299-1319. 
[84]  赵丽红
,  
孙宇舸
,  
蔡玉
.  
基于核主成分分析的人脸识别
.  
东北大学学报
(  
自
然科学版
), 2006, 27(8): 847-850. 
[85]  Hastie  T.  Principal  curves  and  surfaces.  Laboratory  f  or  Computational 西北工业大学博士学位论文
 
142 
 
Statistics, Stanford University, Department of Statistics: Technical Report 11, 
1984. 
[86]  Kohonen T. The self-organizing map. Proceedings of the IEEE, 1990, 78(9): 1 
464-1480. 
[87]  刘小明
.  
数据降维及分类中的流形学习研究
.  
杭州：浙江大学，
2007. 
[88]  Tenenbaum  J  B,  De  Silva  V.  A  Global  Geometric  Framework  for  Nonlinear 
Dimensionality Reduction. Science, 2000, 290(5500): 2319-2323. 
[89]  Roweis S T, Saul L K. Nonlinear Dimensionality Reduction by Locally Linear 
Embedding. Science, 2000, 290(5500): 2323-2326. 
[90]  Nadler  B,  Lafon  S,  Coifman  R  R.  Diffusion  maps,  spectral  clustering  and 
eigenfunctions of Fokker-Planck operators. In Advances in NIPS. Cambridge, 
MIT Press, 2006. 
[91]  Belkin  M,  Niyogi  P.  Laplacian  eigenmaps  for  dimensionality  reduction  and 
data representation. Neural Computation, 2003, 15(6): 1373-1396. 
[92]  Donoho  D,  Grimes  G.  Hessian  eigenmaps:  New  Locally  linear  embedding 
techniques  for  high-dimensional  data.  In  proceeding  of  National  Academy  of 
Sciences, 2003, 102(10): 5591-5596. 
[93]  詹曙
,  
张芝华
,  
叶长明
,  
等
.  
三维人脸深度图的流形学习
-LOGMAP 
识别方
法
.  
电子测量与仪器学报
, 2012, 26(2): 138-143. 
[94]  Zhang Z, Zha H. Principal Manifolds and Nonlinear Dimensionality Reduction 
via  Tangent  Space  Alignment.  SIAM  Journal  on  Scientific  Computing,  2004, 
26(1): 313-338. 
[95]  Weinberger  K  Q,  Saul  L  K.  An  introduction  to  nonlinear  dimensionality 
reduction by maximum variance unfolding. American Association for Artificial 
Intelligence, 2006. 
[96]  黄东
,  
基于流形的降维方法及其在计算机视觉中的应用
.  
成都：电子科技
大学，
2009. 
[97]  Fang  C,  Chen  J.  Human  Action  Recognition  Using  Spatio-Temporal 
Classification. Asian Conference on Computer Vision, 2009. 
[98]  魏艳涛
.  
基于流形学习的数据降维方法研究
.  
武汉
:  
华中科技大学
, 2008.  
[99]  孙伟伟
,  
刘春
,  
施蓓琦
,  
等
.  
面向高光谱影像分类的改进局部切空间排列
降维
.  
同济大学学报（自然科学版）
, 2014, 42(1): 15-27. 
[100]  雷迎科
.  
流形学习算法及其应用研究
.  
合肥：中国科学技术大学
, 2011. 
[101]  Lucia D J，
Beran P S
，
Silva W A
．
Reduced-order modeling
：
new approaches 参考文献
 
 
143
 
 
for computational physics
．
Progress in Aerospace Science
，
2004
，
40(1-2)
：
51-117
．
 
[102]  Romanowski  M  C,  Dowell  E  H.  Reduce  order  unsteady  aerodynamic  and 
aeroelastic  models  using  karhunen-Loeve  eigenmodes.  6
th
 
AIAA/USAF/NASA/ISSMO  Symposium  on  Multidisciplinary  Analysis  and 
Optimizaiton, 7-13, 1996. 
[103]  Thomas J P, Dowell E H, Hall K C. Three-Dimensional transonic aeroelasticity 
using proper orthogonal decomposition based reduced order models. Journal of 
Aircraft, 2003, 40(3): 544-551. 
[104]  Lieu  T,  Farhat  C.  Adaptation  of  POD-based  aeroelastic  ROMs  for  varying 
mach number and angle of attack: application to complete F-16 configuration. 
AIAA-2005-7666, 2005 
[105]  Willcox  K,  Peraire  J,  Paduano  J.  Application  of  model  order  reduction  to 
compressor aeroelastic models. J Eng Gas Turb Power 2002, 124(2):332
–
339. 
[106]  Everson R, Sirovich L. The karhunen
–
loeve procedure for gappy data. Journal 
of the Optical Society of American, 1995, 12: 1657-1664. 
[107]  白俊强，邱亚松，华俊
.  
改进型 
Gappy POD  
翼型反设计方法
.  
航空学报，
2013
，
34(4):762-771. 
[108]  Toal  D  J  J,  Bressloff  N  W,  Keane  A  J.  Geometric  Filtration  Using  Proper 
Orthogonal  Decomposition  for  Aerodynamic  Design  Optimization.  AIAA 
Journal, 2010, 48(5):916-928. 
[109]  Robinson  G,  Keane  A  J.  Concise  Orthogonal  Representation  of  Supercritical 
Aerofoils. Journal of Aircraft, 2001, 38(3):580-583. 
[110]  赵光权
.  
基于贪婪策略的微分进化算法及其应用研究
.  
哈尔滨
:  
哈尔滨工
业大学，
2007. 
[111]  黄仁全
,  
靳聪
,  
贺筱军
,  
等
.  
自适应局部增强微分进化改进算法
.  
空军工程
大学学报
(
自然科学版
)
，
2011,12(3):84-89. 
[112]  Srinivas M, Patnak L M. Adaptive probabilities of cross over and mutation in 
genetic algorithm. IEEE transactions on SMC, 1994, 24(4): 413-419. 
[113]  张晓亮
.  
基于伴随方程的气动优化设计方法研究
.  
西安：西北工业大学，
2014. 
[114]  Drela  M.  Xfoil:  an  analysis  and  design  system  for  low  Reynolds  number 
airfoils. New York: Springer, 1989. 
[115]  Drela  M,  Giles  M  B.  Viscous-Inviscid  Analysis  of  Transonic  and  Low 西北工业大学博士学位论文
 
144 
 
Reynolds Number Airfoils. AIAA Journal, 1987, 25(10): 1347-1355. 
[116]  Gregory, N. and O'Reilly, C. L., "Low-Speed Aerodynamic Characteristics of 
NACA  0012  Aerofoil  Sections,  including  the  Effects  of  Upper-Surface 
Roughness Simulation Hoar Frost," NASA R&M 3726, 1970. 
[117]  詹荡
,  
华俊
,  
张仲寅
.
多段翼型的一种分析方法
.
西北工业大学学报，
2000,18(3):438-441. 
[118]  Cook  P  H,  Mc Donald  M  A,  Firmin  M  C  P,  AEROFOIL  RAE  2822 
PRESSURE  DISTRIBUTIONS,  AND  BOUNDARY  LAYER  AND  WAKE 
MEASUREMENTS. AGARD-AR-138, 1979. 
[119]  Osher  S,  Hafes  M,  Whitlow  W,  Entropy  condition  satisfying  approximations 
for  the  full  potential  equation  of  transonic  flow.  Mathem.  of  Computation, 
1985,44(169):1-29. 
[120]  徐萃薇，孙绳武
.  
计算方法引论（第三版）
.  
北京：高等教育出版社，
2007.  
[121]  Kovalev V E, Karas O V. Computation of a transonic airfoil flow considering 
viscous effects and thin seperated regions. Rech. Aerosp. N1991-1. 
[122]  Keller  H  B.  Numerical  methods  in  boundary  layer  theory.  Annual  Review  of 
Fluid Mech., 1978, 10: 417-433. 
[123]  Cross A G T. Boundary layer calculations and viscous-invicsid coupling. ICAS 
86,2.4.1, 1986. 
[124]  Tinoco E, Levy D, Brodersen O. DPW 5 Summary of Participant Data. 5
th
 CFD 
Drag Prediction Workshop, 2012. 
[125]  朱军
.  
应用 
CFD 
的优化设计方法及复杂构型设计研究
.  
西安：西北工业大
学
, 2009. 
[126]  Spalart  P  R,  Allmaras  S  R.  A  One-Equation  Turbulence  Model  for 
Aerodynamic Flows. AIAA 92-0439, 1992. 
[127]  Anderson W K, Bonhaus D L. Navier-Stokes Computations and Experimental 
Comparisons for Multielement Airfoil Configurations. AIAA- 93-0645, 1993. 
[128]  Roe  P.  Approximate  Riemann  Solvers,  Parameter  Vectors,  and  Difference 
Schemes. J. of Comp. Phys., 1981, 43:357
–
372. 
[129]  朱自强
.  
应用计算流体力学
.
北京
,  
北京航空航天大学出版社
, 1998. 
[130]  杨旭东
.  
基于控制理论的气动优化技术研究
.  
西安：西北工业大学，
2002. 
[131]  陈维恒
.  
微分几何初步
.  
北京：北京大学出版社，
1990. 
[132]  Bruske  J,  Sommer  G.  Intrinsic  dimensionality  estimaziton  with  optimally 
topology preserving maps. IEEE Transactions on Pattern Analysis and Machine 参考文献
 
 
145
 
 
Intelligence. 1998, 20(5): 572-575. 
[133]  刘健
.  
高维数据的本征维度估计方法研究
.  
长沙：国防科技大学，
2005. 
[134]  Hotelling  H.  Analysis  of  a  complex  of  statistical  variables  into  principal 
components. Journal of Educational Psychology, 1933, 24:417-441, 498-520. 
[135]  Pentland  A,  Moghaddam  B,  Starner  T,  et  al.  View-based  and  modular 
eigenspaces for face recognition. Proc IEEE Computer Society Conference on 
Computer Vision and Pattern Recognit ion, 1994. 
[136]  Lo
è
ve M. Probability theory. Vol. II, 4th ed. Verlag:Springer, 1978. 
[137]  赵松原
,  
黄明恪
.  POD 
降阶算法中对基模态表达的改进
.  
南京航空航天大
学学报，
38(2): 131-135. 
[138]  吴学红，陶文铨，吕彦力，等
.
不可压缩流动问题快速计算的降阶模型
.  
中
国电机工程学报，
  2010, 30(26)
：
69-74. 
[139]  Ly H V, Tran H T. Proper orthogonal decomposition for flow calculations and 
optimal  control  in  a  horizontal  CVD  reactor.  Quarterly  of  Applied 
Mathematics. 2002, 60(4):631-656. 
[140]  Braconnier T, Ferrier M, Jouhaud J C, et, al. Towards an adaptive POD/SVD 
surrogate  model  for  aeronautic  design.  Computers  &  Fluids,  2011, 
(40):195-209. 
[141]  Miks S, Batsch G, Weston J. Fisher Discriminat Analysis with Kernals. IEEE 
Neural Networks for Signal Processing, 1999, 41-48. 
[142]  De  Silva  V,  Tenenbaum  J  B.  Global  versus  local  methods  in  nonlinear 
dimensionality  reduction  .  Neural  Information  Processing  Systems 
(NIPS'2002), 2003. 
[143]  Dijkstra  E  W. A  note  on  two  problems  in  connexion  with  graphs
. 
In: Numerische Mathematik. 1959,1: 269-271 
[144]  张大巧
,  
鲜勇
,  
王明海
,  
等
.  
基于 
Floyd 
算法的灵活航迹规划方法
.  
弹箭与
制导学报
, 2011, 31(6): 55-58. 
[145]  De Silva V, Tenenbaum J B. Sparse multidimensional scaling using landmark 
points. Technical report, Dept. Math., Stanford University, 2004. 
[146]  Marian  N,  Michael  J  A.  Parallel  Adjoint  Framework  for  Aerodynamic  Shape 
Optimization of Component-Based Geometry. AIAA-2011-1249, 2011. 
[147]  Rhea  P  L,  Gaetan  K  W  K,  Martins  J  R  R  A,  Multi-point,  multi-mission, 
high-
ﬁ
delity aerostructural optimization of a long-range aircraft con
ﬁ
guration. 
In:  AIAA/ISSMO,  14th  Multidisciplinary  Analysis  and  Optimization 西北工业大学博士学位论文
 
146 
 
Conference, 2012. 
[148]  钱翼稷
.  
空气动力学
.  
北京：北京航空航天大学出版社，
2005. 
[149]  Hardle W, Simar L. Applied Multivariate Statistical Analysis (second edition). 
Heidelberg: Springer, 2007. 
[150]  Colonius  T,  Rowley  C  W,  Freund  J  B,  et,  al.  On  the  Choice  of  Norm  for 
Modeling  Compressible  Flow  Dynamics  at  Reduced-Order  using  the  POD. 
IEEE 2002 Conference on Decision and Control, Las Vegas, NV, 2002. 
[151]  孟德宇
,  
徐晨
,  
徐宗本
.  
基于 
ISOMAP 
的流形结构重建方法
.  
计算机学报
, 
2010, 33(3):545-555. 
[152]  Smith A M O. High-Lift Aerodynamics. J. Aircraft, 1975, 12(6):501-30. 
[153]  张锡金主编
.
飞机设计手册第 
6 
册
.  
北京：航空工业出版社
, 2002. 
[154]  邱亚松
.  
复杂构型增升装置气动设计
.  
西安：西北工业大学，
2011. 
  攻读博士学位期间发表的论文及参与的科研项目
 
 
147
 
 
攻读博士学位期间发表的论文及参与的科研项目
 
发表的学术论文：
 
[1]  邱亚松，白俊强，黄琳，等
.  
翼吊发动机短舱对三维增升装置的影响及改
善措施研究
.  
空气动力学学报，
2012, 30(1):7-13. (EI:20121314899797) 
[2]  邱亚松，白俊强，李亚林，等
.  
复杂几何细节对增升装置气动性能影响研
究
.  
航空学报，
2012
，
33(3):421-429. (EI: 20121814985571) 
[3]  白俊强，邱亚松，陈迎春，等
.  
连接机构对增升装置气动性能影响研究
.  
空
气动力学学报，
2012, 30(6):798-804. (EI: 20130415931762) 
[4]  白俊强，邱亚松，华俊
.  
改进型 
Gappy POD  
翼型反设计方法
.  
航空学报，
2013
，
34(4):762-771. (EI: 20132016340410) 
[5]  邱亚松，白俊强，华俊
.  
基于本征正交分解和代理模型的流场预测方法
.  
航
空学报，
2013
，
34(6):1249-1260. (EI: 20133016533814) 
[6]  Bai  Jun  Qiang,  Qiu  Ya  Song,  Qiao  Lei.  An  efficient  surrogate  model 
construction  strategy  for  large-scale  output  problems.  2nd  International 
Conference  on  Advances  in  Computational  Modeling  and  Simulation, 
Kunming, China, Jul. 2013. (EI: 20134616987182) 
[7]  Qiu  Yasong,  Bai  Junqiang.  Stationary  flow  fields  prediction  of  variable 
physical  domain  based  on  proper  orthogonal  decomposition  and  kriging 
surrogate model. Chinese Journal of Aeronautics,  
已录用
,  
待发表
. (SCI 
收录
) 
[8]  白俊强
,  
刘南
,  
邱亚松
.  
大型民用运输机短舱涡流片增升效率以及参数影
响研究
.  
西北工业大学学报
, 2013, 31:(4): 522-529. (EI: 20134416914798) 
[9]  白俊强
,  
刘南
,  
邱亚松
.  
基于 
RBF 
动网格方法和改进粒子群优化算法的多
段翼型优化
.  
航空学报，
2013, 34:(12): 2701-2715. (EI:20140417230810) 
[10]  白俊强
,  
刘南
,  
邱亚松
,  
等
.  
民用运输机短舱涡流片设计研究
.  
空气动力学
学报，
2014, 32(2):190-196. 
主要参与的科研项目：
 
[1]  C919 大型客机增升装置气动设计；
 
[2]  MA-700 支线客机气动布局参数研究及考虑发动机短舱、螺旋桨滑流的机
翼设计；
 
[3]  ARJ21-700 飞机增升装置气动性能改善研究；
 
[4]  某型高空长航时无人机全机气动布局及外形优化设计；
 
[5]  运 
20 
大型运输机复杂构型气动分析；
 
[6]  某型运输机高升力构型气动设计及评估。
 西北工业大学博士学位论文
 
148 
 
  
 致谢
 
 
149
 
 
致
  
谢
 
本文的研究与撰写是在导师白俊强教授的认真指导下完成的，从查找资料到
论文中的每一个细节白老师均给予了细致的指导，并在本文遇到技术困难时指明
正确的研究方向。白老师不仅在学习上给予作者精心的指导，同时在生活方面对
作者给予无私的帮助，使本文作者能专心于学业而不受生活琐事困扰。在此本文
作者向白老师表达最衷心的感谢！
 
特别感谢 
University of Toronto Institute for Aerospace Studies 
的
  Prasanth B. 
Nair 
教授，跟随他访问学习的一年的经历极大地开拓了我的研究思路。同时感谢
中国航空研究院常务副院长华俊教授为我出国访学所做的引荐工作以及西北工
业大学研究生院给予我的资助。
 
衷心感谢西安建筑科技大学的朱军讲师在我研究生成长阶段给予的各种指
导，这些指导使我打下了完成博士论文所必须的坚实基础。
 
感谢课题团队中各个成员营造的活跃的学术氛围，大家学习上共同勉励，生
活上亲如一家，与大家共同成长与进步的时光使我终生难忘。特别感谢王波、李
鑫、孙智伟、王丹、张扬博士，与大家平时的讨论使我受益良多。感谢刘南、张
晓亮、杨体浩、史亚云、秦飞飞、沈广琛、李国俊、雷锐午等在论文写作中对我
热心的帮助。
 
感谢妻子吴应红、女儿邱汭涵的陪伴，特别感谢妻子对我学业上的理解与支
持，妻子与女儿的陪伴使我原本单调的生活变得丰富多彩。
 
谨以此文献给生我、养我的父母，十年异地求学的生活使我很少陪伴他们左
右，为此我深感愧疚，但他们对我的殷切希望和谆谆教诲无时无刻不在激励着我
进步。谨以此文的完成作为对他们养育教诲之恩的一份报答！
 
最后，向所有评阅老师表示真诚的感谢，您们宝贵意见是本文得以最终完成
的坚实保障。
 
  西北工业大学博士学位论文
 
150 
 
 
  
 