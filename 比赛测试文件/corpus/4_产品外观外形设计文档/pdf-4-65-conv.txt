 20∞年 工程图学学报 2∞6 第5期 JouRNALoFENGINEERINGGRA唧CS No.5镜片的焦距调整算法及其在 眼镜外形设计中的应用胡金华, 匡宇国 (浙江工贸职业技术学院,浙江温州325003)摘 要:在简要介绍了当前眼镜机械数控加工系统基本原理的基础上,阐述了镜片 焦距调整设计在镜片设计与编辑应用中的必要性,并针对眼镜片外形编辑臌计中焦点调整 的要求,提出了采用逆向思维法进行镜片焦距调整的算法。通过比较直线插补与圆弧插补两 种插补方式的焦距调整效果,证实了运用圆弧插补进行焦距调整具有较好的镜片外形平滑性,是一种切实可行的方案。·关键词:计算机应用:镜片外形设计;镜片焦距调整;曲线平滑度 中图分类号:TP391.72文献标识码:A 文章编号:1003,0158(2006)05.0149-05Eyeglass C帅tour Fitting for Ali驴_iIIg Fo眦砸删Jill—hua, KUANGYu-gllo (zb司ia工Igin“s时&1hde P0ly眦h山c,wen出。uzh自i扪g 325003,c吣na)Abstract:11le nu勰ricaI con删ing system of gIasses mcllinery is introduced i11 bricf锄d山e sigllific粕ce锄d∞cess姆0ffocus adjustiIIg iIl eyeglass contollr design is analyzed.Precision and sm00血n船s arc interpol撕on粕d H眦ar interp01ation are compared.C0mputaIIonal results show t11at arc intel_pol州on gives a higlle。quality of eyeglass edge.Key words:computcr applica廿on:eye91ass contoIlr design;eyeglass focus adjustiIlg;curve sIIloO(hI圯ss随着计算机及先进制造技术的发展,眼镜机 采用仿形模板,将采样后的数据传输到电脑,并 械行业也不断朝高精度、自动化、智能化发展, 通过编写计算机图形编辑软件进行计算机图形 国内外出现了少数以全自动或半自动加工的眼 处理,最后将数据传送到微处理控制器中,微处 镜数控机械设备‘”,如自动磨边机、自动绕框机、 理控制系统再根据眼镜数据,有机地控制各伺服自动割片机等。它们主要利用计算机控制技术, 电机,从而加工出相应形状的眼镜产品。收稿日期:2∞5 O卜21 作者简介:胡金华(1979_).女,湖南益阳人。硕士研究生.主要研究方向为计算机图形学、数字化人机工程、机器视觉和人工智能等万方数据
 采样后获取的镜片外形数据点相对于焦点是角 度均匀分布的,而焦点发生改变后,各数据点相 对于镜片焦点的极坐标也发生相应改变,角度不 再均匀,故必须对镜片外形数据进行重新分配。,隧 —+1镜片外形编辑,设计卜_一图1眼镜镜片设计框图镜片焦距调整的逆向思维法也包含有直线 插补和圆弧插补两种,其基本步骤”】'【41为:1求 移动焦点后,各原数据点所对虑的极坐标角度 值,并判断各数据点D.与皿。之问是否包含有 需要插补的数据点;2若有需插补的点,则求I程图学学报2006卑一般说束,这些专用的计算机图形编辑或设 y=女2×【石一Df(曲]+曩(y)计软件,或采用逐点修正采样数据的方法,或直 其中接采用直线,圆弧插补、曲线拟合的方法”】,能相 对快速地处理眼镜外形的形状变化,但对于镜片 焦距的调整设计欠缺考虑。而由于人的两瞳孔间 距各异,因此在镜片外形编辑或设计过程中,镜 片焦距的可调整设计显得尤为必要。1镜片焦距调整的基本概念镜片的焦距移动是指在眼镜片外形保持不 变的前提下,使焦点位置发生改变,即镜片外形 的绝对直角坐标保持不变,而焦点的坐标发生改变。镜片焦足巨调整设计的框图如图1所示,由于口(工),D。(y)分别为第i个数据点相对于 移动后的焦点的坐标值。直线插补法是指假定镜片外形的各数据点 之间是直线连接,求角度均匀直线与镜片外形直 线交点的方法,故各分配后的插补值为直线上的 点;而圆弧插补法是指假定各数据点之间是圆弧 连接的,求该圆弧与角度均匀直线交点的方法, 故各分配后的插补值为圆弧上的点。顺向思维法是用角度均匀直线循环测试所 有的镜片外形直线段(即与各直线段相交),判 断交点存在于哪个直线段,并求出其交点值的方 法;而逆向思维法是指对每一条镜片外形直线段的端点进行判断,看是否包含有所需要的角度, 以此来判断是否存在交点及几个交点,并求出各交点值的方法。 从上述顺向思维和逆向思维的方法可知,顺向思维具有思路简单清晰,易于编程实现的特 点,但计算循环的次数太多有360+360次,因而 速度大大下降;而采用逆向思维方法虽然编程难 度相对较高,但只需要判断360次,大大提高了 运行速度。因此,下面重点介绍焦距调整的逆向 思维法。2镜片焦距调整的逆向思维法焦距调整的设计是指在已知焦点位置的改变量的前提下,求各角度均匀分配后的数据点相 由此两点Di与D。组成的直线段与角度均匀直对于新焦点的极坐标值。 焦距调整设计的方法按重新分配数据点的连接方式主要可分为直线插补法和圆弧插补法 两种,按分配数据点求取的方法可分为顺向思维法和逆向思维法。 角度均匀直线:y=tan(舅)×上,其中,只为分配均匀后的第f个数据点的极坐标角度。镜 片外形直线段L—q(y)一D。(y) ‘Di(z)一D⋯(x)线y=tan(谚)×x的交点(直线插补法),或求由3点口v D。与皿。组成的圆弧与角度均匀直线 的交点(圆弧插补法),并求出其相席的极坐标值。(1)判断线段D。D。是否需要插补令采样分辨率为1,360,即每转1度采样一 个数据,则镜片外形上的任意点的坐标为D。(工)=Df×cos(f),Df(y)=Dj×sin(i) 如图2所示,镜片外形上的任意两点万方数据
 第5期 胡金华等:镜片的焦距调整算法及其在眼镜外形设计中的应用 ·151B(D,(x),D;(y)),c(D。O),D『十1(y))的坐标 已知,中心移动到日(‰,虬)以后,两点坐标分别为B(最,口,),c(e,q),且 最=D。(x卜‰,吼=Df(y)一%e=p+.(曲一‰,G=口+,(y)一甄 则有么占:arctan墨 其整数部分为口 占,么c:盯ct觚旦 其整数部分为口 C.若玳=芦一甜≥1,则镜片外形线段丑C中包含 有珊个需插补的点。(3)由上述分析可知,此两直线的交点爿(4,爿,)即为焦距调整后得到的第噼+七)个 数据点的直角坐标。故分配后镜片外形的第数据,实现镜片焦距的调整。 ◆ (3)圆弧插补图2镜片焦距调整示意图(2)直线插补 镜片外形线段Bc的直线方程为七:生量 jBx—C。 y=毛×(x一芝)+占。角度均匀直线0j爿的直线方程为吒=恤((a州x舞 y=七,×并( ̈(2)其中七=1,2,⋯,m 结合式(1)和式(2),可得两直线的交点一的坐标为q一口 + 一6 =r (5)万方数据卜’?圆弧插补的关键是求圆弧的圆心和半径,最 简单的办法就是过圆弧上的3点来求。但是,如 果对采样的数据直接迸行焦距调整,由于各种高 热的存在,可能会导致出现噪声数据,因此只有 3个点不一定能代表此段外形的真实变化情况, 因此可能要用到各种复杂的圆弧拟合、多项式拟 合或B样条拟合方法等。由于设计镜片的步骤是先设计好镜片的外 形,然后再进行焦距调整,因此,这里只介绍最简单的3点圆弧插补方法。 根据图2所示,过圆弧上面相邻的3点,口(DJ(z),毋(y)), c(DJ+。(x)’2+,(y)), E(Df一。(x),q—l(y)),则镜片中心移动到 日(知,%)后,有盈=B(x)一%,占。=毋(y)一‰e:DM(x)一‰,q:Df+。(y)一y。E=Df一。(互)一‰,B=口一t(y)一虬 且满足B~口 + 一611r位+lj})个点的值为r—:———。● data(口+.i})=√42+一,2(4)此外,还必须考虑直线0n爿或Bc的斜率不存在的特殊情况。 结合上述步骤(1),遍历完所有的镜片外形数据点,即可获得角度均匀分布的完整镜片外形E~ ,L,L,L,●,、●,●lii!一 6、i II , 通过求解该三元二阶的方程组可以得出该口 ^+,L,L,L彤q髟
 :!!!: 三兰曼兰兰兰 = :!!!兰圆弧的圆心01∞,西)及半径r的值。故该圆弧的 方程为在图3一图5中,镜片外形框下的曲线计算的 是各点的平滑度。比较三图中的平滑度曲线可 知:图3与图5具有较相似的变化趋势,曲线的 变化也相对平滑,而图4的变化则较大,平滑性 较差。因此,采用圆弧插补的方式进行焦距调整 具有更好的甲滑性,是一种切实可靠的方案。图3焦距调整前的镜片外形图图4直线插补的焦距调整图图5 圆弧插补的焦距调整图(z一II)2+(y一6)2=,2(6)由式(2)和式(6)可得圆弧插补的交点 A(A。,A。)的坐标为A=掣A=屯×A(7) 其中 △=2^r以扫一62+r2一七2口2+七2r2,±号 由该段圆弧的凹凸性及圆弧所在象限确定。与直线插补类似,此交点A(A,,A。)即为焦 距调整后得到的第位+七)个数据点的直角坐 标。故分配后镜片外形的第∽+七)个点的值为r—??—: data(d+足)=√A2+A2 (8’结合步骤(1),遍历完所有的镜片外形数据点, 即可获得角度均匀分布的完整镜片外形数据,实 现镜片焦距的调整。3运行效果比较焦距调整前的镜片外形如图3所示,把该镜 片的焦点向右移动5mm,向下移动4Im,即新 的中心为0.(5,4),采用直线插补方式的焦距调 整如图4所示,圆弧插补方式的焦距调整如图5 所示。部分数据如表1所示。从表l中的数据可以看出,焦距发生移动后, 各数据点的值也随之发生变化。但比较直线插补 与圆弧插补获得的数据可知,采用直线插补和圆 弧插补法进行焦距调整的差别并不十分显著,基 本上都在O.011m以下,最大的差距也小于 0.03咖,因此,在图4和图5的镜片外形曲线中 体现为放大倍数较小时根本就看不出二者的差 别。但考虑到镜片加工的高精度及高平滑性的 要求,这里计算任意点到由该点的前3个点所组 成的圆弧的距离,即把该点与此圆弧的偏离程度 来表征镜片外形的平滑程度。并以此来评价镜片 设计的质量。  万方数据
 第5期 胡金华等:镜片的焦距调整算法及其在眼镜外形设计中的应用 表l移动前的原始数据表·1 534结论作者简要介绍了当前眼镜机械数控加工系 统的基本原理,阐述了镜片焦距调整设计在镜片 设计与编辑应用中的必要性,提出了采用逆向思 维法进行镜片焦距调整的算法。通过比较直线插 补与圆弧插补两种插补方式的焦距调整效果,证 实了运用圆弧插补进行焦距调整具有较好的镜片外形平滑性,是一种切实可行的方案。参考文献万方数据【l】原勇,王晴.眼镜业国产仪器产业升级之路叨. 中国眼镜科技杂志,2005,(7):57—59.【2】薛 伟,周宏明,等.眼镜镜片样式的参数化模型 和算法叨.江苏大学学报,2004'll(6):473—476 【3]Qin Yuex试HuDejill.Research 0n me arcill唧。枷伽for the noIIstaIIdard sec60n cu“e of me piston【J】. Jo岫al ofD皿曲ua uIIiverSity’2004,(4):96—98.【4]李东,孙长嵩.计算机图形学实用教程【M】北京: 人民邮电出版社,2004 84—86