单 位 代 码

１
０ 
１
４ ４
货 类 
号 １
阿
ｉ
、
ｒ

编 号
＿＿
＿
＿
＿
＇

—


：
Ｖ
４
．
＇ －
Ｈ
ｉ
ＭＭ
ｌ
Ｂ—

Ｉ
Ｍ
Ｍ
Ｏ —
—
Ｂ
Ｌ
Ｍ
ｉ
Ｍ
ｉ
Ｈ
ｉ
Ｍ—
ＫＳ
硕± 学位论文
题
目
，
Ｕ

ｕ 
糸 
诚
Ｉ
洋
靖
ｆ
Ａ

ｒ
聲 巧
Ｖ
ｔ
＞
＾
杂 
論


妍 究 生 姓 名
＜

（
７
〇
ｌ
ｆ
ｐ
届 
＾搞
、
设
种义獲患 
专 业
）
营 师 姓 名 ＾
１
＾
十
＿
４


论 支 完 成 
日 
期
＇
＾
八
／
應 
Ｗ

键 
ｉ 
化 
少 
欠 
參
Ｓ ｈ 
ｅ
ｎ
ｙ
ａ
ｎ
ｇ
Ｌ
ｉ
ｇ
ｏｎ
ｇ

Ｕ
ｎ
ｉ
ｖ
ｅ 
ｒ ｓ 
ｉ
ｔ
ｙ 
 
分类号：TP311.5 
                                       
密级：
 
U D C ：621 
                                           
编号：
 
 
工学硕士学位论文
 
 
 
 
小口径炮弹智能工艺设计及集成
 
 
 
 
 
 
 
 
 
 
 
硕士研究生：秦冉
 
指导教师
   
：郝博
  
教授
 
学科、专业：机械设计及理论
  
 
 
 
 
 
沈阳理工大学
 
2016 年 3 月
 
  
 
分类号：
TP311.5                                         
密级：
 
U D C  
：
621                                            
编号：
 
 
 
工学硕士学位论文
 
 
 
 
小口径炮弹智能工艺设计及集成
 
 
 
 
 
 
 
 
 
              
硕士研究生
   
：秦冉
   
              
指导教师
     
：郝博
  
教授
 
              
学位级别
     
：工学硕士
 
              
学科、专业
   
：机械设计及理论
 
              
所在单位
     
：机械工程学院
 
              
论文提交日期：
2015 
年 
12 
月 
10 
日
 
              
论文答辩日期：
2016 
年 
3 
月 
12 
日
 
              
学位授予单位：沈阳理工大学
   
 
Classification Index: TP311.5 
U.D.C:621 
 
 
A Thesis for the Master Degree of Engineering 
 
 
Small-bore Shell’s Intelligent Process Design 
and Integration
 
 
 
 
 
 
 
 
 
 
Candidate : Qin Ran 
Supervisor : Prof.Hao Bo 
Academic Degree Applied for  : Master of Engineering 
Specialty : Mechanical Design and Theory
Date of Submission : December ,2015 
Date of Examination : March ,2016 
University : Shenyang Ligong University 
 沈 阳 理
工
大 学
硕± 学位论文原
 创 性声 
明
本 人 郑重 声
 
明
：
本 论 文 
的 
所有 
工 
作
，
是在 
导师 的指
导 下
，
由 
作者 本
人 独 
立
完 成 
的
。
有关 观 
点
、
方 法
、
数 据 和 文献 
的 引 用 
已 
在文 
中 
指 
出
，
并 与 参考 文 献相 对应
。
除文 
中 已
注 
明 引 
用 的 
内 
容 外
，
本 论文 不 包 含任
何 其 他个 人 或 集体 
已
经 公开 发 表
的 作 
品 
成 果
。
对本 文 
的
研 究做 
出 
重 要
贡 献
的 个 人 和 集体
，
均 
己在 文 
中 明 确 方 式 标 
明
。
本 人完 全意 识 
到 本
声 
明 
的 法律 
结果 
由 
本 人承 担
。
作者
（
签字
）
：
；
＾
＾
日 
期
：
（
年
；
＾
月
学 位 论 
文 版 权 使 
用 
授 权 书
？
本 学位 论
 文 作 者完 全 
了 
解化
阳 理 王大 学 有 关保 
留
、
使用
 学位 论 文
的 
规 定
，
目
Ｐ
：
沈 
阳 理 
工 
大学 有权 保
留 
并 
向 国 家 有关部 
口 
或 机构
 送交 学
位 论 文 
的 复 
印
件 和磁 盘
，
允 许 论文 被 查 
綺 和借 
阅
。
本 人授权沈 
阳 理 
王
大 学 可 将 学位 论文 
的 全 部
 或 部 分 
内 
容 编 入有关 数 据 库进行检 
索
，
可
１
＾
采 
用 影 
印
、
缩 
印 
或其 它 
复制 手 段保存
、
汇 编 学位论
文
。
（
保密 
的 
学 位论 
文 在 解密 后 适 
用 本 授 权 书
）
学位 论 文作 者签 
名
：
指 
导 
教师签 
名
：
＾
：
＾
／
＾
＾
曰
期
：
５
《
年
術护
期
：
為繳
 
 
 
摘
     
要
 
 
随着企业信息化建设的不断发展，将 
CAD/CAM/CAPP 
系统集成到 
PDM 
平台
已经成为企业工艺设计的迫切需求。
CAD/CAM/CAPP 
系统与 
PDM 
系统的集成，
不仅可以统一数据信息，实现数据共享，而且利用 
PDM 
强大的流程管理功能，可
以规范企业的工艺设计流程，提高工艺设计的效率，缩短开发周期。本文根据某
企业对小口径炮弹工艺设计要求，在 
Windchill 
环境下，针对 
CAD/CAM/CAPP 
系
统，应用接口交换和紧密集成交互的方法，开展了小口径炮弹智能工艺设计及集
成技术的研究，提高了小口径炮弹设计生产效率。主要研究工作有：
 
（
1
）提出了小口径炮弹智能工艺设计及集成的总体方案，并详细进行了集成
分析，通过三种集成方法对比，选择了适合该企业要求的集成方法，建立了有效
的集成方案。
 
（
2
）总结归纳出小口径炮弹领域的专家知识，利用专家系统的开发工具 
ESDK
建立工艺路线知识工程，通过知识的推理，实现智能式工艺路线的自动生成，为
小口径炮弹智能工艺路线设计专家系统与三维工艺规划系统的集成提供了依据，
以便于小口径炮弹工艺路线的定制、编辑与管理。
 
（
3
）利用三维建模系统对小口径炮弹进行基于 
MBD 
模型的全三维参数化建
模，并根据这些参数在 
Pro/E 
中进行数控加工，经过后置处理后将数控程序导入到
Vericut 
中进行数控加工仿真，对其工序进行故障检测，对工艺路线进行优化。
 
（
4
）通过对小口径炮弹智能工艺路线设计专家系统、三维建模系统、数控加
工仿真系统、三维工艺规划系统及产品数据管理系统进行二次开发，实现
CAD/CAM/CAPP/PDM 
的有效集成，实现了小口径炮弹全生命周期的管理。
 
本文的研究内容反映了企业的实际需求，丰富了 
CAD/CAM/CAPP 
与 
Windchill
的集成应用技术，为 
CAD/CAM/CAPP 
在企业中的集成应用提供了一些新的思路
和实现技术，有较高的实用价值和推广价值。
 
 
关键词：小口径炮弹；
CAD/CAM/CAPP
；工艺设计；产品数据管理；集成
  
 
Abstract 
 
With  the  continuous  development  of  enterprise  information  construction,  it  has 
become  the  urgent  needs  of  business  process  design  that  the  CAD  /  CAM  /  CAPP 
systems  are  integrated  into  PDM  platform.  CAD  /  CAM  /  CAPP  system  and  the  PDM 
system integration not only unifies data, but also achieves data sharing. And the use of 
powerful PDM process management function can standardize business’s process design 
processes  to  improve  efficiency  of  process  design  and  shorten  the  development  cycle. 
Based  on  an  enterprise  process  design  requirements  for  the  Small-bore  shells,  in  the 
Windchill  environment
，
for  CAD  /  CAM  /  CAPP  systems,  the  paper  carries  out  the 
intelligent process design and integration technology of the Small-bore shells applying 
the  interactive  way  of  the  interface  exchange  and  close  integration.  It  improves  the 
Small-bore  shells’  efficiency  of  design  and  production.  The  main  research  work 
includes following several:  
(1)  To  propose  the  overall  program  of  the  Small-bore  shells’  intelligent  process 
design and integration, and carry out integrated analysis carefully. Comparison by three 
integration methods, the paper chooses a integrated method meeting the requirements of 
the enterprise, and establishes an effective integrated solutions. 
(2) To summarize the expert knowledge in the field of the Small-bore shells, then 
to  establish  routing  knowledge  engineering  by  using  expert  system  development  tool 
DEST.  Through  knowledge’s  reasoning,  the  paper  achieves  automatic  generation  of 
intelligent  process  route,  and  it  provides  a  basis  for  the  integration  of  small  caliber 
artillery intelligent routing design experts Systems and 3D process planning system and 
makes convenient for the editing and management in small-caliber shells routings. 
(3) To conduct three-dimensional parametric modeling of small caliber shells based 
on  MBD  model  by  using  three-dimensional  modeling  system,  and  according  to  these 
parameters to proceed NC machining in Pro / E. After post-processing
，
the NC program 
will  be  imported  into  VERICUT  for  CNC  machining  simulation  and  its  process  fault 
detection, which will realize optimization of process routes. 
(4)  small-caliber  shells  intelligent  routing  design  expert  systems,  3D  modeling 
systems, CNC machining simulation system, 3D process planning systems and product 
data management system for secondary development, it achieves effective integration of 
CAD / CAM / CAPP / PDM's to realize the management of small-caliber shells full life  
 
cycle. 
Contents of this paper reflect the actual needs of enterprises, enriching the CAD / 
CAM / CAPP integration with Windchill application technology, providing a number of 
new  ideas  and  implementation  techniques  for  CAD  /  CAM  /  CAPP  integrated 
application in the enterprise, and having a higher practical value and promotional value. 
 
Keywords:  Small-bore  shells
;  
CAD  /  CAM  /  CAPP
;  
Process  design
;  Products’  data 
management; Integration 
 
 
目   录 
 
第 
1 
章
   
绪论
 .................................................................................................................. 1 
1.1 CAPP 
与 
PDM 
概述
 ............................................................................................ 1 
1.1.1 CAPP 
概述
 ................................................................................................ 1 
1.1.2 PDM 
概述
 .................................................................................................. 3 
1.1.3 PDM 
和 
CAPP 
研究动态
 .......................................................................... 4 
1.2 
课题来源与研究意义
 ......................................................................................... 6 
1.2.1  
课题研究背景
 .......................................................................................... 6 
1.2.2  
课题来源与研究意义
 .............................................................................. 7 
1.3 
论文的主要研究内容
 ......................................................................................... 7 
1.4  
本章小结
 ............................................................................................................ 9 
第 
2 
章
  
小口径炮弹智能工艺设计集成总体方案
 ...................................................... 10 
2.1  
智能专家系统
 .................................................................................................. 10 
2.2 
基于 
Pro/E 
与 
Vericut 
数控加工仿真系统
 ....................................................... 11 
2.3 
基于 
XTCAPP 
的三维产品工艺系统
 .............................................................. 13 
2.4 
基于 
Windchill 
的产品信息管理系统
 .............................................................. 14 
2.5 
小口径炮弹智能工艺设计集成总体方案
 ....................................................... 15 
2.5.1 
集成概述
 ................................................................................................. 15 
2.5.2 
系统集成分析
 ......................................................................................... 16 
2.5.3  
已有的集成方法
[48]
 ................................................................................ 18 
2.5.4  
集成方案的确立
 .................................................................................... 19 
2.5.5 
系统集成的体系结构
 ............................................................................. 21 
2.6  
本章小结
 .......................................................................................................... 23 
第 
3 
章
   
智能工艺路线设计
 ........................................................................................ 24 
3.1  
工艺路线设计方案
 .......................................................................................... 24 
3.2  
工艺路线设计专家系统体系架构
 .................................................................. 25 
3.2.1 
总体思想
 ................................................................................................. 25  
 
3.2.2 
智能专家系统结构
 .................................................................................. 26 
3.3  
智能工艺路线设计专家系统的实现
 ............................................................... 28 
3.3.1 
小口径炮弹工艺路线设计方案的选择
 .................................................. 28 
3.3.2 
智能工艺路线设计专家系统的实施
 ...................................................... 29 
3.4  
本章小结
 ........................................................................................................... 30 
第 
4 
章
  
小口径炮弹数控加工仿真
 ............................................................................... 31 
4.1  
数控加工仿真原理
 ........................................................................................... 31 
4.2 Pro/E 
零件建模与数控加工
 .............................................................................. 32 
4.2.1  
建模思想
 ................................................................................................. 32 
4.2.2  
建立制造模型
 ......................................................................................... 34 
4.2.3  
制造设置
 ................................................................................................. 36 
4.2.4 
加工设置
 .................................................................................................. 38 
4.2.5 
刀具路径模拟及 
NC 
检测
 ...................................................................... 39 
4.2.6 Pro/E 
后置处理
 ........................................................................................ 40 
4.3 VERICUT 
数控加工仿真
 .................................................................................. 41 
4.3.1  
数控机床建模及控制文件
 ..................................................................... 41 
4.3.2 
毛坯、夹具建模
 ...................................................................................... 43 
4.3.3 
刀具建模
 .................................................................................................. 43 
4.3.4 
工件坐标系设置
 ...................................................................................... 44 
4.3.5 
加工仿真结果
 .......................................................................................... 44 
4.3.6 
虚拟检验及刀具轨迹优化
 ...................................................................... 45 
4.4  
本章小结
 ........................................................................................................... 47 
第 
5 
章
   
三维工艺设计集成
 ......................................................................................... 48 
5.1 Windchill 
相关技术
 ........................................................................................... 48 
5.2  
小口径炮弹三维工艺设计系统集成思想和架构
 ........................................... 49 
5.3 
三维工艺规划系统
 ............................................................................................ 52 
5.3.1  
智能工艺路线设计模块
 ......................................................................... 52 
5.3.2  
参数化设计与数控加工仿真模块
 ......................................................... 53 
5.3.3  
三维工艺编辑模块
 ................................................................................. 55  
 
5.3.4  
工艺文件输出模块
 ................................................................................ 56 
5.4 Windchill 
与三维建模系统集成
 ....................................................................... 56 
5.4.1  
集成的实现
 ............................................................................................ 56 
5.4.2 MBD 
模型上传
 ....................................................................................... 57 
5.5 Windchill 
与三维工艺规划系统集成
 ............................................................... 59 
5.5.1  
集成的实现
 ............................................................................................ 59 
5.5.2  
三维工艺设计信息的上传
 .................................................................... 61 
5.6 
小口径炮弹全生命周期管理
 ........................................................................... 64 
5.7  
本章小结
 .......................................................................................................... 65 
结
     
论
 ........................................................................................................................ 66 
参考文献
 ........................................................................................................................ 68 
攻读硕士学位期间发表的论文和获得的科研成果
 .................................................... 72 
致
     
谢
 ........................................................................................................................ 73 
  
 - 1 -
 
第 
1 
章
  
绪论
 
 
1.1 CAPP 与 PDM 概述 
1.1.1 CAPP 概述 
CAPP 是以计算机为辅助工具，针对某产品的加工制造规范制定相对应的零件
的机械加工工艺规划的一种方法，是一种能将企业的产品设计数据转变成为具体
的产品制造数据的技术
[1]
。一般来说，只有工艺知识丰富和设计经验熟练的工艺人
员才能做好产品的工艺规程编辑定制工作。但是一个人的工艺设计知识和经验毕
竟是有限的，使得传统的经验性工艺设计规程编制方式存在许多有待解决的问题。
随着 CAPP 的出现与发展，不仅使得传统的手工编制工艺方式发生了彻底的改变，
降低了工艺规划对工艺人员设计经验的依赖程度，而且很大程度上提高了产品工
艺设计的效率。 
CAPP 是指将产品的设计过程转变成用毛坯制造成品的资源要求和所要经过的
一系列操作的描述。如产品结构树设计、毛坯设计、产品零件加工方法确定、机
械加工的工序设计优化、定制编辑与管理机械加工工艺路线等。在三维建模系统
中所建立的产品的几何和工艺信息由CAPP获取，通过计算机辅助技术产生用于CAM
的产品从毛坯到成品的工艺规划和步骤。根据设计方法的不同，CAPP 系统可分为
以下三类： 
检索式 CAPP 系统：此系统在建立时，通过编码将各种产品零件的工艺规程储
存于计算机中，形成了标准工艺库。检索式 CAPP 系统对于产品零件种类变化小、
工艺要求相似度高的大批量生产比较适用。通过对比手工工艺设计，检索式 CAPP
系统虽是初级 CAPP 系统，但仍能明显地减少了工艺设计员反反复复的修改编制工
作，并大大提高了零件的工艺文件质量。 
派生和创成联合式 CAPP 系统：派生式 CAPP 系统的应用范围非常广泛，但在
工艺设计过程中仍然需要人的介入。创成式 CAPP 系统虽能自动生成零件的工序设
计信息，但还不能够实现工艺链的自动生成。混合式 CAPP 系统将成组技术、决策
规则作为零件工艺生成的基础，经过工艺知识和经验丰富的工艺工程师对产品零
件工艺进行标准化设计，并将生成的零件工艺决策规则以及各种零件加工参数存 
  - 2 -
入零件标准工艺库，然后将这些工艺信息数据作为依据进行产品零件的工艺设计。
该系统生成的零件工艺规程聚集了工艺专家的工艺知识与经验，使用的客户具不
需要有丰富的工艺知识与经验。 
智能 CAPP 系统：它可以按照企业产品研发需要有目的地实现 CAD/CAPP/CAM
的集成。该系统的实现主要是将零件的设计信息和表达工艺决策的规则储存于知
识库中，使得知识库具有大量的权威性工艺知识，以便于推理机根据所研究的零
件的工艺要求得到适合的工艺设计结果。智能 CAPP 系统的研究在机械设计制造中
有着非常重要的意义，也是近几年来正在研究的一个热点课题。 
CAPP 系统的发展已经越来越成熟。从手工编制到今天的人工辅助智能 CAPP 系
统的发展过程中，计算机现代化信息技术起着非常重要的作用。如图 1.1 所示，
为 CAPP 近几十年来的研究和发展历程
[2-6]
。 
 
图 1.1 CAPP 系统研究和发展历程 
Fig1.1 CAPP system research and development 
企业产品零件以多品种少批量的生产方式为主，依赖知识经验丰富的工艺人
员已经不能适应国内外制造业市场的要求。为了适应制造业市场的发展变化，企
业能否找到缩短产品设计和生产准备周期在很大程度上决定了企业在行业中的生
产制造竞争力。在竞争激烈的当前形势下，CAPP 技术正朝着集成化、工具化、智
能化和网络化四个方向发展。  
  - 3 -
1.1.2 PDM 概述 
产品数据管理（PDM，Product Data Management）实质上是基于分布式网络
的一种软件框架。它是通过分布式网络、主从结构、图形化用户接口和数据库管
理技术协作管理与产品相关的全部信息和整体过程的一种集成管理技术。它为产
品全生命周期的信息管理提供了一个基于分布式网络的平台，并为企业内部产品
的设计和制造建立一个并行协作的集成工作环境。 
通过对 PDM 的各种定义进行总结，对 PDM 定义的理解可以从以下角度进行分
类思考。从软件系统的角度来说，PDM 是一种为产品工程师以及其他管理人员提供
帮助，便于管理与产品有关的所有信息和产品研发设计生产制造过程的管理软件。
从技术的角度来看， PDM 又是一种管理企业范围内与产品相关的所有设计与制造
信息和过程的技术。从工具的方面来看，PDM 是建立在数据库基础上的一种工具，
是可以集成或封装多种开发环境和工具的介于数据库和应用软件之间的软件开发
平台。 
Web 技术的发展应用在很大程度上推动了 PDM 系统的发展，由于现代化制造业
对 PDM 的应用范围及能力需要提出更高的要求，以 Internet 为基础的 PDM 系统已
经成为一种发展潮流，是分布式产品数据管理的自然拓展。PDM 系统实现了从产品
规划到产品报废的整个处理过程中的各种复杂数字化信息的有效性、实时性和完
整性。作为标准的黑盒解决方案是 PDM 系统的优势，使得大多数制造企业偏重于
使用 PDM 系统。通常情况下，PDM 系统按体系结构可以分为用户界面层、功能模块
层、框架核心层以及系统支持层四层
[7-8]
。 
1、用户界面层：将数据呈现给用户或处理用户输入的应用程序或系统一部分，
也叫客户端层。用户界面层是向用户提供各种浏览器、对话框、菜单等交互化的
操作和信息输入输出等交互式的图形界面，实现企业级应用系统的操作显示界面。
目前为止，PDM 系统有普通窗口（经典端）和 Web 浏览器（WEB 端）两种图形界面。
相比之下，普通窗口式的客户端功能比较强大，但为适应制造网络化技术的飞速
发展，满足企业系统管理产品的便利，Web 浏览器的发展应用越来越受到世界制造
行业企业的广泛关注。 
2、核心功能层：涉及 PDM 的核心功能。它主要是为企业产品工程提供产品设
计和制造信息与过程的集成管理。  
  - 4 -
3、框架核心层：PDM 的核心结构与框架。PDM 系统对象操作框架的主要特性
是具有屏蔽异构操作系统、网络、数据库等。 
4、系统支撑层： PDM 系统的支持平台一般是比较广泛应用的关系型数据库。
通过关系型数据库具有的数据操作功能在底层数据库中进行 PDM 系统对象的管理。 
基于 PDM 产品的应用，通过分析对比本文在选择 Windchill 系统软件的基础
上，采用了 PTC PLM 解决方案。该解决方案的核心产品是 Windchill PDMLink。它
对数字化产品信息的定义具有供单一、完整的特点，并且能够集中控制和管理产
品整个研发过程中的设计与制造信息以及过程信息
[18]
。如图 1.2 所示，PDMLink
基本体系结构。
 
 
图 1.2 PDMLink 基本体系结构 
Fig1.2 PDMLink’s basic architecture 
PDM 系统在产品的研发过程中，目前看来，所有可知的 PDM 功能还没能够应用
于一个商用 PDM 软件。不同的阶段有不同的作用，其中有些功能正在研究进程中。 
1.1.3 PDM 和 CAPP 研究动态 
20 世纪 80 年代初，机械制造企业在生产制造过程中遇到了如何管理大量工程
图样，如何处理技术文档与 CAD 文件之间关系等复杂问题。很多企业凭借其对计
算机工程应用领域的深入了解，发现制造企业因为纸张形式的产品数据受限，需
要进行新的研究开发。为解决以上问题，PDM 技术随之出现并迅速发展起来。早期
的 PDM 系统虽然种类很多但因为发展不成熟，不同的 PDM 系统所具有的功能都比
较单一，只能针对性的解决某些有限的问题。随着计算机技术和先进制造技术的 
  - 5 -
快速发展与应用，PDM 系统从初步发展也逐渐走向成熟，基于 PDM 基础上的产品生
命周期管理（Product Lifecycle Management，PLM）理念也应运而生。现在，国
外典型的 PDM 软件主要有 Simen 公司的 Team Center 和 Express、PTC 公司的
Windchill PDMLink 和 Product Link、DASSAULT 公司的 Enovia 系列 Matrix One 和
Smar Team、SAP 公司的 MYSAP 和 Think Design 公司的 TDPLM 等。这些国外的 PDM 产
品几乎都达到了现今 PDM 技术的顶尖水平。与国外大型的 PDM 相比，我国 PDM 系
统的研发和实施也获得了不错的成就。比如原华中理工大学的华中软件公司的
inel PDM、北京清软英泰公司的 Ti PDM 系统、浙江大天公司的 GS-PDM 系统等，其
中南京新模式软件集成公司开发的 PDM 是国内 PDM 系统的优秀代表
[7-8]
。 
CAPP 技术从萌芽到至今已经有 50 多年的历史。与 PDM 技术相比，CAPP 技术
的发展要早，目前国内外对它的开发和研制已经取得了非常惊人的成果，但是我
国制造业在对 CAPP 的应用上还没有达到应有的水平。1969 年，挪威正式推出了世
界上第一个 CAPP 系统 AUTOPROS。经过四年的努力研究，并于 1973 年正式研发出
了商品化的 AUTOPROS 系统。在 CAPP 发展史上具有里程碑意义的是 CAM-I 于 1976
年推出的 CAM-I'S Automated Process Planning 系统
[9]
。自 20 世纪 80 年代以来，
我国也陆续研制了清华天河 CAPP、金叶西工大的 CAPPFramework、武汉开目 CAPP、
艾克斯特 CAPP、大天 CAPP、天喻 CAPP 等很多具有影响力的 CAPP 产品。这些产品
都是根据本土企业的发展需求进行研发，所以适应性也相对比较好。 
目前，CAPP 系统在国内外的实际应用情况分析来看，国外的 CAPP 产品的应用
无论在深度上还是广度上都还并不如国内 CAPP 的应用，并且国内外企业对 CAPP
与 PDM 系统集成的要求也存在较大的差异。根据自己所阅读的国外文献发现国外
对CAPP与PDM系统集成的研究很少，有少数国外的高端PDM系统中直接附带了CAPP
子系统，如 Siemens 公司的 Teamcenter Engineering 系统的 MPP。MPP 子系统实
现了与 Teamcenter 的紧密集成，并且与 CAD/CAM 的数据交流也非常方便。然而 MPP
并不符合我国企业的实际情况，很难在国内企业投入使用。20 世纪八十年代初，
我国国内很多公司也相继研发出了众多品牌的 CAPP 产品。因为这些产品都是根据
国内企业发展情况进行研发的，再加上地理位置和文化交流的方便性，所以这些
CAPP 产品在国内企业应用起来比较方便。 
系统集成的关键是实现系统之间信息的有序管理及集成。首先需要一个集成 
  - 6 -
平台，在此平台环境下将各种与产品研发有关的应用软件进行集成，同时通过集
成平台的管理功能对集成后产生的与产品有关的所有数据信息进行统一管理，并
保证各系统间的数据能够实现信息共享和同步更新。通过查阅相关资料文献，很
多企业为满足自身项目产品的研发将PDM系统作为集成平台与相应的 CAPP系统进
行集成应用。 
随着企业计算机信息化技术与现代化先进制造技术的发展，国内制造业企业
越来越重视 CAPP 系统与 PDM 系统的集成的研究应用。我国在 PDM 与 CAPP 系统集
成方面的研究还处于发展阶段，面临激烈的国际竞争，当前企业对系统集成的研
究应集中于怎样实现一种既能满足企业应用要求，又能经济实用，并且集成系统
具有较高开发效率的集成方式，这将极其重要。 
1.2 课题来源与研究意义 
1.2.1 课题研究背景 
武器装备数字化快速制造技术是现代战争的需要。我国武器装备制造业正处
于一个全新的发展阶段。作为现代高科技技术战争的伊拉克战争，给了我们很多
值得深思的启示。从 2003 年 3 月到 4 月 11 日的 21 天时间里，联军共发射了约 800
枚“站斧”式巡航导弹和 100 枚 CALM 空射巡航导弹、17000 枚精确制导弹药和 8500
枚非精确制导弹药
[10]
。如果军工制造业不足够强大且数字化快速制造技术不足够
先进，如此庞大的战争就没有了保障，我们将没有能力应对武器装备的巨大投入
和大量消耗。炮弹是变化最快、需求量最大、样式最多、用处最广、消耗数目最
多的武器装备。不论现代战争或未来战争、区域战争或局部战争、进攻战或防御
战，炮弹始终都扮演重要角色。随着高新技术的发展，结合未来战争的特点，炮
弹正在朝着远射程、精确命中、大威力、低成本、多用途方向发展。因此，我国
炮弹制造技术需要进一步研发并提高其发展水平。我国炮弹制造技术手段比较落
后，而且具有种类多、型号多、变批量的特点，即单件、小批量、大批量生产特
点；研制时单件，试制时小批量，平时装备部队小批量，战时大批量。产品型号
不同、生产批量不同，相应的制造工艺、加工方式、制造资源利用等也不同。 
目前我国炮弹生产企业在小口径炮弹研发过程中存在二维瓶颈和数据模型不
一致的问题，导致工艺设计效率极其低下。结合我国现有炮弹制造技术实际情况
和我国的军工需求，提出“小口径炮弹智能工艺设计及集成”的研究课题，以全 
  - 7 -
三维数字化模型为基础，实现小口径炮弹产品的全三维工艺设计及集成，缩短工
艺设计周期，保证产品数据模型一致性。 
1.2.2 课题来源与研究意义 
本课题“小口径炮弹智能工艺设计及集成”来源于某“十二五”项目“基于
全三维模型的 XXXX 工艺设计及快速制造技术”。 
本课题结合企业需求，以小口径炮弹为研究对象，产品生产车间为实际应用
平台开发一套集建模、工艺、仿真和集成为一体的解决方案。本课题为满足企业
内部不同部门及企业级异地办公协同工作的要求，将利用计算机协作并行设计技
术，实现对企业产品三维模型、产品工艺设计信息与过程、工艺数控加工仿真、
及产品全生命周期管理等实现系统集成管理。小口径炮弹智能工艺设计集成系统
的实现，将有效地缩短企业产品的研制周期，提高产品的设计效率，实现小口径
炮弹的全三维数字化集成制造
[11-18]
。 
本课题研究内容将实现 CAD/CAM/CAPP/PDM 各应用系统之间的集成，使得各系
统内的数据共享，显著提高了企业的先进制造水平和企业产能。该系统集成的实
现同时为现代化制造理念提供了能够投入应用的实验平台，这将有利于我国企业
信息化的快速发展。因此，面临我国目前整体制造企业市场的激烈竞争，对
CAD/CAE/CAPP/PDM 系统集成技术的深入研究将有着非常重要的意义。 
1.3 论文的主要研究内容 
本课主要针对小口径炮弹的生产制造需求进行小口径炮弹智能工艺设计集成
平台的研究开发，支持与 PRO/E 等商品化三维 CAD 软件、Windchill 等商业化 PDM
系统的集成。具体研究内容如下： 
（1）PDM 系统集成总体方案的确定 
为有方向地开展课题，本人亲自到某企业进行项目产品的充分调查研究。在
该企业，他们的工作过程中主要是使用 XTCAPP 系统和三维建模软件（Pro/E）。本
课题在该企业软件环境基础上，提出使用自身研发的专家系统开发工具开发了小
口径炮弹智能式工艺路线设计专家系统，建立了基于 Pro/E 与 Vericut 的数控加
工仿真系统，实现了小口径炮弹三维工艺规划系统的智能工艺设计。此外，将把
Windchill 作为小口径炮弹工艺设计的系统集成平台，提出了小口径炮弹智能工艺
设计集成方案。在 PDM 集成思想下，通过三种集成方法对比，选择了适合该企业 
  - 8 -
要求的集成方法，建立了有效的集成方案。
 
（2）智能工艺路线设计 
通过企业实地调研和查阅相关资料，记录了企业小口径炮弹产品的相关信息
数据，尽可能多地总结归纳出小口径炮弹领域的专家知识。对专家系统开发工具
DEST 进一步研究开发，将小口径炮弹领域内的专家知识通过数据结构添加进知识
库中，成功开发了智能工艺路线设计专家系统。 
（3）基于 Pro/E 与 Vericut 的小口径炮弹的数控加工仿真 
本文在 Pro/E 和 Veri Cut 软件环境下，结合 Pro/E 的参数化建模功能、Pro/NC
模块的数控加工功能和 Veri Cut 数控加工仿真功能的特点，对小口径炮弹零部件
进行三维参数化建模、数控加工和数控加工仿真与优化，提出一种零件参数化建
模和数控加工、仿真及优化相互结合的快捷方法。 
（4）三维工艺规划系统功能 
对工艺规划系统原有功能的研究发现，通过二次开发，可以实现智能工艺路
线设计系统、三维参数化建模系统及数控加工仿真系统与三维工艺规划系统之间
的系统集成，以便于三维工艺规划系统工艺路线的定制、编辑与管理，工艺卡片
的编辑和工艺要求的参数化模型双向驱动，从而实现三维工艺规划系统中工艺模
型、工艺要求和工艺仿真的同步可视化。 
（5）实现 Windchill 与 Pro/E 集成 
根据企业的项目需求，通过二次开发，实现 Windchill 与 Pro/E 集成，从而
达到 MBD 模型上传至 Windchill 平台上，使得小口径炮弹的零件模型结构与产品
结构一一对应，实现了小口径炮弹的产品零件模型在 Windchill 系统中的流程级
管理。 
（6）实现 Windchill 与 XTCAPP 集成 
通过对三维 XTCAPP 系统进行二次开发，实现了 Windchill 与 XTCAPP 的系统
集成。该集成系统使得三维工艺规划系统可以从 Windchill 系统中获得小口径炮
弹零部件的 BOM，并根据 BOM 的要求进行小口径炮弹的工艺设计，并且将设计的所
有与小口径炮弹有关的工艺文件和过程信息上传至 Windchill 平台进行管理。 
（7）小口径炮弹全生命周期管理 
在完成以上系统集成的基础上，实现小口径炮弹所有设计信息集中上传至产 
  - 9 -
品数据管理系统，通过配置，对小口径炮弹设计信息进行从产品概念设计到产品
生产制造直至停止生产的整个过程的全生命周期管理。 
1.4 本章小结 
本章给出了论文的主要思想框架，使读者对本课题的研究有一个整体了解。
本章简要阐述了 CAPP 技术和 PDM 技术的发展概况，对现有 CAPP 系统与 PDM 技术
的不足进行了分析并提出了改进方案，表明了研发小口径炮弹智能工艺设计及集
成的目的和意义，并且概括出了论文所要研究的主要内容。 
 - 10 -
 
第 
2 
章
  
小口径炮弹智能工艺设计集成总体方案
 
 
根据上一章 PDM 系统和 CAPP 系统的介绍基础上，本章确立了对小口径炮弹智
能工艺设计集成的总体方案。确定课题由智能工艺路线设计、工艺设计、工艺仿
真和工艺设计集成部分组成，并分别对智能专家系统、基于 Pro/E 与 Vericut 的
数控加工仿真系统、基于 XTCAPP 的三维产品工艺设计系统和基于 Windchill 的产
品集成管理系统各部分的详细设计方案进行了介绍，分析了各系统集成的总体方
案。图 2.1 所示为 PDM 集成的总体方案。 
 
图 2.1PDM 集成的总体方案 
Fig2.1 The overall scheme of PDM integration
 
2.1 智能专家系统 
智能专家系统开发工具 DEST 是采用 C++语言和数据结构自主开发的面向对象 
  - 11 -
的设计型专家系统开发工具。它不仅对知识的表达能力非常强，而且所具有的推
理机构也非常强大。它所开发的知识库具有系统化、模块化、较小的冗余度等特
点，并且可以实现知识代码的重复使用。 
知识编辑器、知识编译中心、推理机构、解释器等模块组成了专家系统开发
工具 DEST。在开发专家系统的知识库时，知识的管理与维护由知识管理中心进行
管理，由知识库管理中心进行统一的组织，便于知识的编辑及修改。词法检查可
以提示用户对关键词输入的正确性，并加以不同的文本颜色加以区别，通过词法
检查的功能可大大提高知识输入的准确性，减少了由于输入而产生错误的可能性。
而添加知识向导模块则可以使用户方便地进行知识的编辑，该功能模块的引入可
避免用户花费较长的时间记忆繁杂的系统表达语言及方法，这样通过该模块提供
给用户一个人性化的界面，便于用户的掌握。然后通过知识编译器对知识库中的
专家知识按照一定的规则进行编译，并将编译后的专家知识以二进制文件的格式
储存在知识库中。最后推理机将根据系统中的一定的规则从已有的事实知识库中
提取并推出符合企业产品要求的结果
[14-19]
。如图 2.2 所示为 DEST 结构。 
人机界面
知识编辑器
知识编译器 总控模块
框架推理机 规则推理 方法推理 解释器
知识库 
上下文数据库
领域专家知识 数
据库 图形支撑软件
 
图 2.2 DEST 结构 
Fig2.2 DEST
’
s structure 
2.2 基于 Pro/E 与 Vericut 数控加工仿真系统 
目前，企业在生产零部件时，检验其数控加工程序的方法主要是机床的“空
运行”和“试切”。这两种方法的效率比较低，只能粗略地估计机床运动是否正确、 
  - 12 -
有无干涉及加工过程中的碰撞问题等。为解决以上问题的精确性，本文提出了基
于 Pro/E 与 Vericut 数控加工仿真系统方案。该系统通过对 Pro/E 进行二次开发，
实现零部件的参数化建模，利用 Pro/NC 模块对零部件进行自动编程和加工参数优
化，经过后置处理将 Pro/NC 产生的数控加工程序导入 VERICUT 进行数控加工仿真。
此外，VERICUT 的数控加工仿真影像也可直接在 Pro/E 参数化界面直接播放，实现
模型与仿真的同步可视化
[29-35]
。 
通过对企业生产车间的考察，小口径炮弹零部件的生产制造主要是在数控车
床上进行的。为减少小口径炮弹零部件生产过程中出现错误和浪费，就要对小口
径炮弹零部件的数控加工过程进行模拟仿真。根据生产现场及查阅的相关资料，
数控车床、刀具和夹具等是模拟仿真的主要加工对象。被加工对象就是企业车间
要生产的小口径炮弹零部件和相对应的数控加工程序
[33]
。 
为满足企业产品的生产制造要求，本文建立了基于 Pro/E 与 Vericut 数控加
工仿真系统。该系统的主要工作工具是 VERICUT 仿真软件和 Pro/E 三维建模软件。
结合两者的功能，并对其进行相应的二次开发，最终实现完成小口径炮弹数控加
工仿真环境的构建和实现各项仿真功能。 
该数控加工仿真系统主要是结合VERICUT软件与三维建模软件Pro/E。VERICUT
是一个综合性非常强大仿真分析软件，集合了三维加工仿真、验证及优化等多种
功能。Pro/E 是集 CAD/CAM/CAE 为一体的三维建模软件，具有参数化设计，基于特
征模型和单一数据库等特点。它们的完美合作，成功地对小口径炮弹进行了基于
MBD 模型的三维建模及小口径炮弹零件的数控仿真加工。 
基于 Pro/E 与 Vericut 数控加工仿真系统结合了 VERICUT 系统与 PRO/E 的强
大功能。该系统是进行小口径炮弹数控加工仿真非常有效的方法，实现了小口径
炮弹从设计到加工的完全仿真。如图 2.3 所示，基于 Pro/E 与 Vericut 的数控加
工仿真系统结构。 
 
  
  - 13 -
 
图 2.3 基于 Pro/E 与 Vericut 的数控加工仿真系统结构 
Fig2.3 Based on Pro/E and Vericut structure of NC machining simulation system 
2.3 基于 XTCAPP 的三维产品工艺系统 
早期，工艺设计工作中的反反复复操作使得工作人员甚是烦恼，为解决这个
问题，CAPP 应运而生。随着机械制造业向 CIM 和 IMS 方向的发展，促使 CAPP 向智
能化和实用化的方向发展，提高工艺设计的标准化和规范化程度成了行业标准 
本课题结合 CAPP 系统开发热点需求，在企业拥有的工艺规划软件 XTCAPP 基
础上，通过二次开发建立基于 XTCAPP 的三维产品工艺规划系统。总结汇总企业内
部与小口径炮弹有关的所有工艺文件，使用 XTCAPP 软件，在计算机辅助技术的基
础上，对小口径炮弹有关的工艺数据进行总体规划。该工艺规划系统能够实现小
口径炮弹所有工艺文件在企业范围内的共享，并具有编辑工艺文件信息的高效统
一的平台。该系统功能优势主要包括以下方面
[20-24]
： 
(1)统一的工艺信息编辑平台。根据企业内部产品设计要求，按照小口径炮弹 
  - 14 -
的工艺模板进行定制，对有关的工艺文档进行编辑使其达到标准化，并整理汇总
有关的所有工艺资源。 
(2)高效的工艺信息管理平台。在先进的计算机信息技术的基础上，通过现代
化管理手段．实现企业范围内的工艺管理的规范化，使得产品设计与制造的业务
流程井然有序。 
(3)个性化的系统访问平台。该系统具有个性化的入口，能够实现系统的客户
化，方便用户对产品工艺信息数据进行实时访问。通过客户化定制，能够进行系
统功能结合，实现灵活的个性化的平台设计
[39,40]
。 
(4)与 CAD、Windchill 集成的接口。通过系统集成，能够建立系统间的数据
访问与调用，从三维建模系统获取产品的模型、参数及工艺等设计信息，也可从
产品数据管理系统提取产品结构、产品物料清单以及产品特定属性。 
2.4 基于 Windchill 的产品信息管理系统 
随着现代企业的转型发展，传统的单机方式的产品信息管理系统已经不能适
应当今企业生产方式的变化。为适应现代制造的发展，网络化方式的产品信息管
理系统逐渐成为发展的趋势。Windchill 是目前 PDM 产品当中相对较完善的产品信
息管理系统。它以网络为中心，在网络化环境中能够设计、获取、搜索和组织各
企业各部门的各种数据类型的所有产品信息。Windchill 的数据库可以从各企业部
门系统的数据库中获取并记录产品的设计与制造信息，并且能够使得产品信息网
络化、动态化和生命化
[7-12]
。在 Windchill 系统环境下进行开发协同管理产品数据
的平台，从而使得各种类型的数据库和各种格式的工艺知识是可重复使用的。为
实现 PDM 系统的高效集成，关键在于要以网络环境为中心，合理使用信息更新和
重构技术，选择和设计适合企业需求的数据提取工具和统一高效的产品信息管理
系统。 
Windchill 是一个软件框架，用于产品信息的集成，便于企业、部门及个人
对产品信息进行分布式操作。它以 Java 语言为核心，提供一个具有强大客户化和
二次开发能力的产品信息集成平台
[57]
。因此它对不同的企业、部门及个人有着不
同的访问权限，并且允许不同的人对相应的产品信息有一定的操作权利，同时允
许不同系统的各种软件产生的各种格式文件无缝地连接到产品信息管理系统中。
产品的各种信息无关系统，无关软件，总能在 Windchill 环境中为其客户化定制， 
  - 15 -
实现与产品生产制造的 CAD/CAM/CAPP/ERP 软件的集成。因此，如何合理地配置开
发基于 Windchill 的产品信息管理系统是非常关键的。 
2.5 小口径炮弹智能工艺设计集成总体方案                            
2.5.1 集成概述 
PDM 是集成管理所有与产品的设计和制造相关的信息与过程的平台。它要想实
现这些功能，它必须具有封装或集成各种应用程序的能力。同时，PDM 技术在一定
程度上能够支持层次不同的各种应用系统之间的信息交流，并且各种应用系统与
PDM 系统之间也可以进行信息互动。PDM 不同于其他应用软件，它自身不具有非常
强大的功能，而是一个模型框架，但它有非常灵活的客户界面供用户根据企业的
需求对其进行客户化定制。各企业在不同的部门其工作人员使用的软件类型和版
本不同，导致生成的文档数据在格式结构上差异很大，兼容性也小。所以在集成
各种应用软件之前，首先要考虑各种应用软件系统与 PDM 系统的兼容性，并且作
为集成对象又该怎样被 PDM 识别等问题。系统集成后，产品信息数据如何在不同
的部门被高效查找，在企业、部门及个人之间如何共享这些集成数据，都是需要
解决的问题。产品信息数据在生产商、制造商、销售商及客户之间的传递和共享
都依赖于各种应用软件系统与 PDM 高效的集成
[8]
。因此必须整体布局，统筹考虑各
种应用软件的集成的方式和方法。要想实现满足企业需求的集成系统，必须要有
大量的资金投入和一些具有相对较高研发水平的技术人员。然而不同的企业具有
不同的财力与人力，所以选用一种合适的集成方式十分重要。 
 
 
 
 
图 2.4 集成原理 
Fig2.4 Integration principle 
如图 2.4 所示，为系统集成的原理。集成是指将各种信息化的各种应用软件、
硬件、接口及机器通过计算机信息技术统一构造为一个协同工作的整体。集成系
统的实现实质上是实现信息技术资源及应用之间的功能交互、信息共享以及数据
管理。系统集成不是简单的将各种应用软件进行汇集，而是通过整体布局统筹规
A 
应用系统
  B 
应用系统
 
功能交换 
  
信息共享
信息流 
  - 16 -
划信息技术资源及应用。 
CAD/CAM/CAPP/PDM 系统集成方案是灵活可变的，为满足企业需求，整体分析
企业的信息模型是至关重要的。只有对企业信息模型进行全面的分析，才能为企
业提出切实可行的信息集成方案。而一个企业的信息模型是需要建立在一个基
4E8E 应用的集成平台上，即需要构建信息的集成框架。 
2.5.2 系统集成分析 
现代信息化技术的发展，为 PDM 系统与其他 CAX 系统之间的集成或者 CAX 系
统相互之间的集成提供丰富的知识条件与基础。从整体来看，PDM 系统集成实现了
企业信息的全局集成
[29]
。在计算机集成制造系统中，各应用系统有着特定的功能：
CAD 主要用于产品的模型设计和参数分析；CAPP 则主要是对产品生产制造过程进
行工艺规划；CAM 根据产品的模型参数与工艺信息进行数控编程与加工仿真；ERP
主要是管理企业的所有产品项目资源；PDM 管理与产品有关的数据和过程。此外，
ERP 通过对客户的需求和产品销售的管理，为 PDM 系统提供信息管理依据，并且能
与 PDM 系统进行数据交流，接受 PDM 传递的产品信息。综上可知，产品系统集成
的核心是 PDM 系统。同时，PDM 系统建立了 CAD/CAM/CAPP 系统与 ERP 系统的信息
通信。ERP 系统主要是获取设计 BOM、工艺信息与过程等基本信息
[5-12]
。它们之间
的集成关系，如图 2.5 所示。 
 
图 2.5 ERP/PDM/CAPP/CAD/CAM 系统集成关系 
Fig2.5 The relation of ERP/PDM/CAD/CAPP/CAM system integration 
通过以上它们的集成关系来看，各种应用系统之间的集成实现都是以 PDM 系
统为集成平台。在异构分布式网络化环境中，集成平台能够为企业各种应用软件
之间的信息集成、功能集成和过程集成提供一个集成框架。 
CAX 技术的功能虽然很强大，但是各种 CAX 系统出现的“信息孤岛”问题是显 
  - 17 -
而易见急需解决的问题。为解决这个问题需要一个功能灵活的且高效的信息集成
平台，PDM 技术为适应这个趋势迅速发展起来。PDM 系统通过客户化定制与二次开
发，能够与各种 CAX 系统集成，实现企业各部门之间的数据交换和信息交流，在
人性化的客户界面上实现业务流程的传递、监督与控制。PDM 系统集成平台支持企
业各种产品设计与制造信息的过程重组，便于并行工程的实施以及 ISO 9000 质量
认证等系统工程的统一管理。该系统能够实现产品的所有设计、制造数据的交换
与信息交互，完成产品设计、生产、制造整个过程一体化的高效管理。高层管理
员通过该集成平台能够实行对产品信息过程全部可视化管理与监控。各种 CAX 应
用系统根据工作人员的操作输出不同的产品信息，这些信息都是企业产品信息化
的基础信息，为避免信息孤岛都需要通过 PDM 技术将其联系起来，实现信息的统
一管理。集成平台将各种 CAX 系统集成以后，再通过其强大的产品信息管理功能，
对产品工艺设计过程的数据与信息进行控制，实现产品的并行管理
[10]
。其具体的
优势主要体现在： ①PDM 是 CAX 集成的平台；②PDM 是产品信息传递的桥梁；③
PDM 是 CIMS 的集成框架。 
PDM 系统是产品信息管理中心。它为 CAD/CAM/CAPP 各应用系统的集成提供较
为理想集成环境。它可以统一管理制造企业各种产品的各种信息，并把这些信息
按照一定的规则进行分类，通过对其进行不同的属性编码实现产品信息的高效管
理。它为 CAD/CAM/CAPP 的集成、产品信息管理、产品过程管理、并行工程集成等
创造了强大的支撑集成环境。 
通过客户化定制与二次开发实现各种集成，CAD 系统对产品零部件进行模型
设，并将产品设计信息通过 OLE 技术建立与 CAPP 系统的联系；再由 CAPP 系统对
产品进行加工工艺规划，然后将产品的设计信息与工艺信息传递给 CAM 系统对产
品进行数控加工，生成零件加工的刀具轨迹文件，经过 Pro/NC 后置处理产生 NC
程序，导入 CAE 系统中进行数控仿真与加工路线优化，最终将各系统产生的产品
信息自动上传到 PDM 集成平台上自动挂接到产品结构树，对这些产品信息进行编
码、属性定制等使得这些产品信息自动关联并分门别类地保存到 PDM 系统数据库
中。制造企业通过 ERP 系统获取 PDM 集成系统中的设计物料清单、模型信息、工
艺规程、业务流程等信息，自动刷新后获取产品的制造物料清单，用以在企业车
间指导产品的生产过程。  
  - 18 -
2.5.3 已有的集成方法
[48]
 
（1）应用封装 
应用封装技术主要是针对面向对象的数据类型。面向对象技术主要包括对象
的一个接口和一个实现两部分。接口部分是对象唯一的直观可视化的部分，主要
是对作用于对象的操作集进行说明；实现部分主要组成因素为信息和过程两方面，
信息部分主要是描述对象和体现其状态；过程部分则是要对每一操作的实现进行
描述
[60]
。 
封装是通过设计具体的操作集来对可见模块的外部接口进行描述。封装意味
着对象的内部细节是不能被用户看到，但用户却可以通过外部接口来使用对象，
这一特点体现了封装的信息隐蔽原则。此外，封装的结果使得对象的内部属性不
能被对象以外的部分任意地更改，程序设计过程中虽然改变了其中一个数据结构，
但却不改变实现对象操作功能的任何程序，从而有效地避免了外部因素所产生的
错误对内部的影响，很大程度上减少了查找和排除错误的难度。应用封装的优点
是不需要进行大范围的开发。一般来看，在 PDM 系统中只需要进行简单的配置和
编程即可实现应用封装，并且这种集成方式的适用范围非常广泛。应用封装的缺
点是产品信息在系统之间的获取十分困难，并且出现了系统功能模块的相重叠现
象，使得集成平台的数据共享水平低。 
（2）接口模式 
接口模式的集成能够实现更高水平的自动化信息集成，在用户不参与的情况
下，即可实现 PDM 系统和 CAD/CAM/CAPP 系统间的 MBD 模型数据、典型工序数据和
工艺资源数据等信息数据的交换。同时，PDM 集成系统能够根据用户的不同要求对
各种 CAX 应用系统的工艺文件数据进行重新添加、删除、修改等操作
[59]
。通过对
三维建模系统的二次开发的接口模式，使得产品的 MBD 模型的所有信息储存在
Oracle 数据库的位置与保存在统一基础数据库中数据的位置保持一致，实现产品
模型数据在集成系统中的统一与共享，有利于工作人员实时编辑和修改产品的 MBD
模型数据，避免在数据传递过程中的信息丢失或损坏。 
（3）紧密集成 
目前，企业使用的系统集成中水平层次最高的就是紧密集成。本文的部分系
统集成也选用了这种集成方式。在 CAPP 系统和 PDM 系统之间建立紧密集成的前提 
  - 19 -
是要在两者之间建立一种共享的信息模型，并且这种模型是能够动态变化的。在
这种集成模式环境中， CAPP 系统已经成为 PDM 系统的一个组成部分，相当于 PDM
系统中的子系统。它能够实现在改变 PDM 系统中的产品信息数据时，使得 CAPP
系统中的产品信息数据得到相应的修改，同时在 CAPP 系统中修改产品信息数据也
能驱动 PDM 系统中的数据发生相应的变化，实现了 PDM 系统与 CAPP 系统之间的数
据同步一致
[58]
。要想实现产品信息操作共享，就是说在 PDM 系统 或是其它各种
CAX 应用软件中对产品信息进行某种需要的操作，不仅能够影响系统本身数据信息
的变化，也能驱动集成系统另一方中的数据产生相同的变化。紧密集成的优点是
不仅能够实现各应用系统间的信息交流和传递，而且能保证系统之间产品信息的
共享一致性，实现同步更新双方系统中的产品信息。它能够在一方系统中对另一
方系统数据库中的信息数据进行直接操作，实现系统之间相应功能模块的相互调。
紧密集成的缺点是开发量非常大，在对各种应用系统内部进行详细研究的过程中
需要足够的人力、财力和时间。 
本文根据企业的需求，为了选择合理的集成方式，对以上三种集成方法进行
了详细的对比
[57-61]
。如表 2.1： 
表 2.1 集成方式对比 
Table2.1 Integrated way contrast 
集成方式  集成内容  界面  数据库  开发量 
可重复
利用性 
成本  集成度 
 
中间接口
方式 
文档、数据 
具有各自
的界面 
有各自数据
库 
较小  高  低 
松散，不
高 
应用封装
方式 
文档、用户、
过程、数据 
统一界面
有各自数据
库 
较大  较高  较高 
紧密，较
高 
紧密集成
方式 
文档、用户、
过程、数据 
统一界面 统一数据库 很大  低  高  一体，高
2.5.4 集成方案的确立 
本文通过对某公司的实地调查，充分了解该公司的 CAPP 和 PDM 系统实施的具
体情况，以及公司具有的人力，财力与技术力量。结合以上三种集成方式的对比，
小口径炮弹智能工艺设计集成决定采用接口交换和紧密集成相结合的方法实现集
成
[10]
。理由如下：  
  - 20 -
（1）充分利用 XTCAPP 的功能。在对产品进行工艺路线规划、统一数据库管
理、工艺图表的生成等操作时，采用接口交换集成模式能够更加充分地利用 XTCAPP
的工艺规划功能。它只需要进行简单的开发，就可以实现产品工艺设计集成的需
要。 
（2）充分利用 PDM 的功能。PDM 系统的强大优势在于对产品信息能够进行全
生命周期的管理。为实现 PDM 系统与 XTCAPP 系统更紧密的集成，可对 XTCAPP 系
统进行二次开发，将两个系统紧密联系起来。紧密集成系统的实现可以利用 PDM
优势，对与产品有关的所有信息与过程进行统一管理
[61]
。 
（3）各集成系统间的信息交互非常容易实现。通过 PDM 系统和各种 CAX 应用
系统所具有的集成接口，实现系统集成，从而达到共享与产品相关的所有信息，
比产品模型参数、工艺规程、NC 代码以及制造资源等。 
（4）容易实现产品信息在各应用系统的同步更新，保证产品信息的一致共享。 
通过对某公司系统应用情况的实地调查，发现公司使用的 XTCAPP 系统与 PDM
系统中同时存在相似的项目管理和流程管理机制，为避免使用重叠，需要将其屏
蔽掉。PDM 系统集成平台的建立， XTCAPP 系统将不是孤立操作的工艺规划系统。
它通过接口技术和中间文件建立 PDM 与 XTCAPP 系统的产品数据交互，从而使得 PDM
系统对 XTCAPP 系统中的工艺定制、编辑的过程和进度进行有效的任务分配以及流
程管理。建立在 PDM 系统集成平台上的 XTCAPP 系统可以根据系统本身的需要对 PDM
系统中的产品信息进行实时、便捷的访问。这样有利于 XTCAPP 系统根据从 PDM 系
统中获取的信息进行工艺卡片的高效定制、编辑。此外，集成平台也为 CAM 系统
进行数控加工仿真提供所需要的工艺信息来进行编辑数控加工代码。  
  - 21 -
 
图 2.6 PDM 系统集成平台的工艺信息和流程管理 
Fig2.6 PDM system integration platform
’
s process information and process 
management 
根据某企业的实际情况，如图 2.6 所示，建立的 PDM 系统集成平台的工艺信
息和流程管理框架。在集成系统中，通过对三维建模软件进行二次开发，使得 PDM 
系统获取三维建模软件产生的产品相关数据信息。三维建模软件系统提供的产品
信息主要有零部件的二维与三维模型图像、零部件的几何与非几何信息、零件的
工艺信息和数控加工信息等。这些数据都通过集成平台由 PDM 系统进行统一管
理。同时，XTCAPP 系统通过自身系统的接口程序建立与 PDM 系统的通信，调用集
成平台中的产品零部件模型结构、几何与非几何参数、工艺规划信息和数控加工
数据等，再根据 XTCAPP 系统功能进行决策机制的编写，驱动系统自动生成工艺卡
片。最后通过集成接口将生成的工艺卡片再导入上传至 PDM 系统数据库中，这些
产品信息数据将再次被 CAM 系统所利用，方便企业对相似产品或新产品进行快速
的数控加工仿真及优化生成可用于实际制造的 NC 代码
[10]
。 
2.5.5 系统集成的体系结构 
PDM 和 XTCAPP 系统有着系统自身独特的体系结构。它们自身所具有的二次开
发功能也具有一定的限制，对其体系结构的改变只能进行细小的变化。在集成过
程中，如果需要修改系统本身的源代码，也会尽量使用其原有的开发功能，减少 
  - 22 -
客户化定制和开发过程中的风险。根据某企业具体的产品开发应用要求，对 PDM
系统和 XTCAPP 系统进行相应的集成开发。如图 2.7 所示，XTCAPP 和 PDM 系统集成
的体系结构。 
图 2.7 XTCAPP 与 PDM 集成系统的体系结构 
Fig2.7 XTCAPP with PDM integration system architecture 
PDM 功能： 
系统管理 
电子仓库 
文档管理 
产品结构
管理 
工作流程
管理 
功能更改
管理 
新建工艺 编辑工艺 删除工艺 浏览
工艺
 打印
工艺
 复制工艺 审批
工艺
 修订
工
艺
 汇总
工
艺
 模块
维
护
 功能层
数据交换 
数据交
流层 
PDM/CAPP 集成接口 
PDM 集成平台/CAPP 系统  系统层
网络/分布式关系型数据库 Oracle/SQL Server 
支撑层
操作系统 
在集成系统体系结构中，系统层的 PDM 平台对 XTCAPP 系统进行管理。XTCAPP
系统是作为 PDM 的一个应用工具进行各种工艺设计操作的。同时，它又是一个独
立的系统，能够进行产品工艺文件的定制、编辑和管理，并且可以对网络和数据
库进行独立的访问。 
PDM 与 XTCAPP 系统集成有支撑层、系统层、数据交流层、功能层四层体系结
构，具有非常强大的功能。集成系统的支撑层主要是在异构的硬件平台基础上，
通过网络分布式关系型的数据库进，建立 PDM 与 XTCAPP 系统间集成后独立又相互
联系的操作系统。系统层主要用于进行底层异构数据库的信息访问，并对产品的
工艺决策信息、工艺知识库的产品工艺数据进行有效管理的功能。数据交流层主
要是为系统之间数据的访问、浏览与修改提供集成接口和数据交换接口，使得产
品信息数据以某种形式在 PDM 与 XTCAPP 系统间进行交换和传递。功能层是系统集
成后实现的各种功能的集合，从 PDM 系统编码形成产品结构树，到导入到 XTCAPP
系统中产品的 BOM 后进行产品工艺设计，最后将设计好的工艺文件上传至 PDM 系 
  - 23 -
统中进行集成管理等等产品开发设计的各阶段过程信息
[59]
。 
2.6 本章小结 
本章首先详细阐述了小口径炮弹智能工艺设计集成的各个子系统，根据各个
子系统的实现情况，合理地提出了小口径炮弹智能工艺设计系统集成理论的概念
以及集成关系图。根据对集成的分析，确定了以 PDM 系统为集成环境的集成平台
结构。在分析了 PDM 系统集成的三种集成方式后，对这些集成方式进行优缺点的
比较与评估，结合企业具体的应用实施需求，确立了接口交换和紧密集成交互的
复合集成方式来实现系统集成。最后，对小口径炮弹智能工艺规划方案的设计模
式进行了进一步地研究，并构建出了 PDM 系统环境下的 XTCAPP 系统集成的体系结
构。 
 - 24 -
 
第 
3 
章
   
智能工艺路线设计
 
 
小口径炮弹工艺路线设计是产品零件设计开发的核心环节，对小口径炮弹零
件的质量、成本和生产效率产生直接影响。长期以来，工艺人员的设计经验在产
品零部件的加工工艺路线设计中都起着最重要的作用。现代市场竞争变得愈来愈
激烈，直接引起了产品的更新换代也随之愈来愈快。企业为适应市场变化，其生
产模式也开始越来越向着中小批量生产的方向发展，传统的工艺路线设计方法已
经远不能满足企业的需求。 
传统的工艺路线设计存在着很多急需解决的缺点，比如工艺路线的一致性差、
数控加工的效率低、工艺路线设计的数据信息难以保证等。它在设计过程中过度
依赖于工艺路线设计人员的个人设计经验和水平。此外，面对现代化制造业的发
展需求，早期的专家系统已经愈发显得落后，其系统存在的缺陷也越来越明显，
无法跟上时代的发展需要。它在工艺决策工程中过度片面追求自动化，领域的专
家知识获取困难，推理机的推理方式比较单一。本文针对工艺路线设计存在的问
题和企业的发展需求，联合运用人工智能尤其是计算智能技术的科研成果，研究
并探索了专家系统中该如何进一步完善知识表示和工艺路线的决策等问题。 
3.1 工艺路线设计方案 
设计型专家系统开发工具 DEST 是自主研发的面向对象的专家系统开发工具。
设计型专家系统的开发都是采用 DEST 基础上进行的。通过向知识库中添加相关领
域的专家知识，便可以形成相应领域内的专家系统
[14]
。 
DEST 是在 Microsoft Windows（98/NT/2000/XP）开发平台下，用面向对象的
C++语言及开发工具 Visual C++5.0 开发而成的外壳型专家系统开发工具。它主要
是采用面向对象的知识表达方式，将框架表达、产生式规则和过程用面向对象的
思想构成混合知识表达方法。由于它的知识表达语言极其丰富，具有很强的语义
表达能力、表达对象的数据及对象之间的关系，因而可用于基于特征的制造等方
面。运用 DEST 已经成功地开发了小口径炮弹智能工艺路线设计专家系统
[20-22]
。 
小口径炮弹智能工艺路线设计专家系统是基于 DEST 开发的小口径炮弹智能工 
  - 25 -
艺路线设计专家系统。它采用面向对象的知识表达与实例推理相结合的方法，对
小口径炮弹工艺路线总体方案设计知识进行总结，完成了小口径炮弹智能工艺路
线设计。该专家系统的成功研发为提高小口径炮弹设计质量，缩短产品开发周期
以及其他设计模块集成提供了有效手段。如图 3.1 所示，开发工具 DEST 的运行界
面。 
 
图 3.1 DEST 实际运行界面 
Fig3.1 DEST operation interface 
小口径炮弹智能工艺路线设计专家系统研究的主要内容有：小口径炮弹设计
知识的学习和总结；完善面向研究对象的知识表示方法；研究运用基于实例的推
理方法；小口径炮弹总体方案设计专家系统的开发；对专家系统的开发进行建设
性的修改；专家系统的集成技术及可行性评估子系统的开发。 
小口径炮弹智能工艺路线设计专家系统是把专家系统技术应用于小口径炮弹
整体方案设计。它通过知识工程师与领域专家的共同努力把小口径炮弹设计的专
业知识存入知识库中，计算机根据知识库中的知识并采用一定的推理方法来回答
用户的提问，形成一套合理、有效的工艺路线设计方案。 
3.2 工艺路线设计专家系统体系架构 
3.2.1 总体思想 
工艺路线设计是一项复杂而又反复的决策过程，它需要从技术、经济、原料
纯度及来源等等方面考虑工艺路线的可行性。设计中涉及确定整个流程的组成、
每个工序的组成、操作条件、控制方案、合理利用原料及能量、工程的配套设施、
安全生产措施等等问题，因此设计一种产品的生产工艺路线往往不能一次成功，
它需要经过多次的修改、评价、再设计才能完成，时常采用“设计—评价—再设 
  - 26 -
计”的过程决策模型
[18]
，如图 3.2 所示。 
 
 
 
 
 
 
 
 
 
 
图 3.2 过程决策模型 
Fig3.2 Process decision-making model 
根据企业对系统的设计要求产生一个合理的初始设计，并通过一定的计算、
分析或对比，制定出一个或几个更加合理的改进方案。这个过程可以采用面向对
象的工程学分析或经验比较，也可以采用有限元分析以及仿真计算等方法进行。
在此基础上，使用系统工程学和模糊数学等理论，对工艺路线方案进行可行性评
估
[17]
。因此，智能专家系统就要针对工艺路线可行性评估建立一定的领域性评价
体系以及对产品零件加工路线领域性的评价准则。在方案不符合设计要求的情况
下，则需要根据评估进行零件加工路线的再设计，根据再设计的加工工艺路线知
识确定系统中的回溯点及相应的加工参数的修正，至设计方案满足要求为止。这
样的过程决策模型是设计型专家系统的特点之一。 
3.2.2 智能专家系统结构 
小口径炮弹智能工艺路线设计专家系统是基于设计型专家系统开发工具 DEST
开发的设计型专家系统。该系统主要是采用面向对象的知识表达方法把有关小口
径炮弹工艺设计的领域知识存放在 DEST 知识库中，然后借助于 DEST 的多种推理
机（框架推理机，规则推理机，方法推理机）通过基于实例推理与正向推理相结
合的方法来完成小口径炮弹工艺路线设计。因此，根据设计决策模型把小口径炮
弹工艺路线设计分为三个部分：小口径炮弹初步工艺路线设计专家系统（主要完
成小口径炮弹工艺路线设计的初步方案）；工艺路线方案修改建议专家系统（针对
设计要求
分析
 
初始设计
评价
 
结束
  
  - 27 -
初步工艺路线设计中不满足要求的设计提出修改建议）；可行性评估系统
[14-22]
。 
智能专家系统代表着目前发展的趋势。在智能专家系统中引用了最具有代表
性的前沿人工智能技术，比如知识工程、智能理论和智能计算等。但是，它的基
本结构并没有改变，依然沿用传统的专家系。它依旧是以知识库和推理机为中心
的智能专家系统。如图 3.3 所示，为智能工艺路线设计专家系统的框架。 
 
图 3.3 智能工艺路线专家系统的框架 
Fig3.3 Expert system of the process routes of the intelligent framework 
根据图 3.3 所示，可知智能工艺路线专家系统主要组成部分为：
[21]
 
（1）输入输出接口  
通过接口输入产品的零部件信息，在编译和推理功能的基础上智能地识别和
处理零部件的特征数据，输出由系统自动生成的相应的零件加工的工艺路线等工
艺文件。系统通过输入输出接口建立与外界的联系，并且能够进行产品数据交流。  
（2）知识库  
知识库是专家系统的基础。它主要包括产品的零件信息库、资源库、工艺规
则库和知识库管理系统。智能专家系统的功能的有效性主要取决于知识库对各种
知识的组织和表达形式。  
（3）推理机  
推理机是系统的关键，由各种工艺决策算法构成推理机制。工艺决策主要是
指对产品零部件的各种工艺参数（毛坯材料、机床类型、刀具型号、工装夹具结
构等）进行编辑，给予一定的规则，通过相应产品参数的选择生成相应的工艺路
线等工艺文件。推理机的推理机制决定了专家系统的智能化水平
[41]
。  
（4）知识获取   
  - 28 -
知识获取的途径主要是通过工艺设计人员的设计经验和产品现有的相应工艺
文件。它采用机器学习的方式进行获取工艺知识，并对其进行一定的工艺推理规
则定制使得计算机能够智能识别。知识获取将能够使得工艺规则库实时保持更新，
并能够进一步丰富知识库。 
3.3 智能工艺路线设计专家系统的实现 
3.3.1 小口径炮弹工艺路线设计方案的选择 
1.小口径炮弹种类的选择 
本课题研究了榴弹弹体、杀燃弹弹体、穿燃弹弹体、穿燃弹弹头壳及穿燃弹
弹壳等小口径炮弹零部件，所以首先要选择零件的种类，才能确定具体的其他设
计信息。 
2.毛坯的选择 
制造小口径炮弹零件所采用的毛坯是多种多样的，也是不断发展的，归纳总
结起来有三类：采用轧材下料获得毛坯、采用对轧材进行压力加工的方法获得毛
坯和采用铸造方法获得毛坯。 
小口径炮弹零件毛坯的选择是一个很重要的问题，需要从质量要求、生产经
济性和满足战时需要等方面加以考虑研究。 
3.零件设计参数的选择 
 小口径炮弹零件的设计参数包括弹体长度、弹体直径等设计参数，这些设计
参数决定了小口径炮弹的威力、战斗使用条件和火炮必要射速。一般来说，长度
和直径越大杀伤力就越大，然而直径越大，火炮的运动性能通常变差，装填也比
较困难，射速将减低。在通常情况下，小口径炮弹零件设计参数的选择要符合装
备设计参数序列的要求，不能随意制定新参数。 
4.零件结构特征的选择 
以上选择之后，需要确定所选择零件的结构特征，比如说形状，材料等。这
些结构特征也决定了小口径炮弹的装配方式、杀伤力大小和加工方法等因素。一
般说来，形状的选择决定于火炮筒的形状，材料的选择决定于炮弹种类及用途。 
5.加工方法的选择 
根据小口径炮弹的种类、毛坯、设计参数和结构特征的选择，来学则小口径
炮弹零件的加工方法。加工方法主要有热冲、冷拔、机械加工、收口、表面处理 
  - 29 -
等工艺过程。一系列的产品零件的加工工序、夹具刀具安装、工位、工步及走刀
等要素组成了机械加工工艺过程。根据生产工艺过程的性质不同，工艺规程分为
毛坯制造、零件机械加工、热处理、表面处理、装药以及装配等不同的工艺规程。  
          
3.3.2 智能工艺路线设计专家系统的实施 
如图 3.4 所示，小口径炮弹智能工艺路线设计专家系统。它主要是采用专家
系统开发工具通过向知识库中添加小口径炮弹领域范围内的专家知识，通过编译
推理自动生成小口径炮弹零部件的工艺路线的过程。首先，建立知识框架结构。
框架主要包括零件名称、毛坯材料、零件设计的主要参数、零件模型特征、加工
推理方法、小口径炮弹内外表面加工方式和输出结果等。其次，编写知识表达方
式，决定了推理机制的建立过程。最后，建立推理规则。它是通过对产品工艺信
息的整合建立一种选择标准。 
 
图 3.4 智能专家系统设计界面 
Fig3.4 Intelligent expert system design interface  
用户输入小口径炮弹零件需要的毛坯的基本信息（毛坯形状、毛坯的材料）、
零件的基本信息（基本尺寸、结构特征等）、零件主要设计参数、选择加工方法（机
械加工、热处理、表面处理等）等通过知识编译、知识推理得出工艺路线。如图
3.5 
所示，其输出结果以 
WORD 
形式出现。
  
  - 30 -
 
图 3.5 以 WORD 形式输出工艺路线 
Fig3.5 Output processing route in the form of WORD  
本专家系统的工艺规划实现了自动化和智能化。目前，工艺路线设计普遍采
用交互式和派生式设计，需要经验丰富的工艺人员大量参与。而智能式工艺路线
设计可自动完成工艺路线设计，对设计结果稍加修改即可完成。智能式工艺路线
设计在工艺设计领域属前沿技术，实现难度较大。课题采用智能式工艺路线设计，
用工艺专家经验进行推理决策，确定一个产品的整体的工艺设计路线，它可以替
代经验丰富的工艺设计专家自动实现工艺路线设计，设计结果达到专家水平。
 
3.4 本章小结 
本章首先阐述了小口径炮弹的工艺路线设计方案。然后对小口径炮弹智能工
艺路线设计系统结构进行了详细地介绍了，结合小口径炮弹设计制造的实际情况，
在设计型专家系统开发工具 DEST 基础上，根据知识库中有关小口径炮弹工艺设计
的领域知识，然后借助于 DEST 的多种推理机通过基于实例推理与正向推理相结合
的方法来完成小口径炮弹工艺路线设计，成功开发了小口径炮弹智能工艺路线设
计专家系统。为小口径炮弹智能工艺路线设计专家系统与小口径炮弹三维工艺规
划系统的集成提供了依据，以便于小口径炮弹工艺路线的定制、编辑与管理。小
口径炮弹智能工艺路线设计专家系统对小口径炮弹领域的知识表达能力充分展
现，并具有强有力的推理机构，从而实现了开发的小口径炮弹的知识库具有系统
化、模块化、较小的冗余度及小口径炮弹领域知识代码的复用等优点。 
-31- - 31 -
第 
4 
章
  
小口径炮弹数控加工仿真
 
 
Pro/E 本质上是基于约束的实体建模技术，随着其技术成熟度的发展，三维参
数化建模技术和三维变量化建模技术应运而生。随着产品零件的某些结构尺寸的
修改和使用环境的变化，它在一定程度上使得产品的结构设计模型可以实现自动
加载并修改产品的结构设计图形
[29]
。这些技术的出现大大减少了设计人员的繁琐
重复劳动，使产品设计人员的工作量得到了很大程度上的减轻。然而联合运用虚
拟仿真技术和三维可视化技术， Veri Cut 实现了对产品零部件的加工过程高水平
的模拟仿真。它不仅能够模拟现实环境下机床在加工过程中的全部运动情况，而
且可以模拟完整的产品生产制造过程环境。采用 VERICUT 完成虚拟加工仿真，更
加有利于检测出零件在加工过程中出现的问题，降低企业产品设计和制造过程中
的成本。本章主要是联合运用 Pro/E 与 VERICUT 对小口径炮弹中的穿燃弹弹体进
行数控加工仿真，模拟小口径炮弹从设计到制造的整个现实过程环境。 
4.1 数控加工仿真原理 
如图 4.1 所示，首先使用 Pro/E 软件进行产品零部件的参数化建模，通过 Pro/E 
软件自身具有的 API 函数遍历分析产品的零部件特征，确立产品零件的生产加工
方案。每个零件特征都需要进行各自相应的加工工艺设计，并能够实现不同的零
件特征对应不同的加工工艺，不同的加工工艺对应不同的数控程序。将产品零部
件建成一个个独立的制造单元，再根据相应单元的加工要求对 Pro/NC 模块进行机
床、夹具、刀具等制造设置，通过编辑形成各零部件的刀位轨迹文件（CL 文件）。
经后置处理后生成相应合理的 NC 程序，将各零部件对应的 NC 程序导入到 VERICUT
环境中，通过对 VERICUT 进行合理配置完成各零部件的加工仿真演示
[30]
。这将能
够实现检验 NC 程序的正确性及对零件加工质量的虚拟检验，并运用实体检验法检
验仿真加工模型与设计模型的差别，对加工零件的刀具轨迹进行优化，并能够为
刀具选择最合理的进给率和主轴转速。将数控加工仿真得到的数控加工程序运用
于实际零件的加工，评价了零件的加工质量,验证了仿真程序的可行性，实现了完
全的数控仿真加工。  
  - 32 -
 
图 4.1 数控加工仿真原理 
Fig4.1 Principle of the NC machining simulation  
4.2 Pro/E 零件建模与数控加工 
4.2.1 建模思想 
PTC 公司突破了传统的建模观念，提出了新的 CAD 建模思想，即参数化设计、
特征建模和全相关单一数据库。与一般的 CAD 软件相比，Pro/E 软件具有优越的建
模特性，这正是因为使用了以上独特的建模方式和设计思路
[30-32]
。与其他建模软
件相比，运用 Pro/E 软件进行产品的开发设计的效率要高很多。在该建模软件环
境下，可根据需要实时地将零件的二维与三维图形进行相互转换。基于特征的参
数化建模能够实现对零件的各种参数的任意修改都能同时并自动地反映到其他相
关的产品研发的各个环节,从而使得产品的设计与制造信息数据保持高度统一一
致性。Pro/E 为产品三维模型设计人员提供了非常便捷的理想化工作环境，它具有
非常独特的建模思想，现在从以下几个面分别阐述： 
 (1)全参数化设计 
在研究与开发同类产品时，全参数化设计决定了建立产品零部件模型设计的
速度，提高了整个产品的开发效率。这里的“全参数化”有以下几方面的含义： 

  截面几何特征信息全参数化； 

  零件模型全参数化； 

  装配体模型结构的全参数化；  
  - 33 -
参数化设计主要分为两个部分：图元和修改引擎。图元是通过构件的表现形
式出现的。产品不同，零部件不同，其构件也就不同，需要通过参数的调整来反
映构件。参数化引擎主要是用来对参数进行修改，并将对参数在模型设计或设计
文档中的修改自动反映到与它有联系的其他部分
[52]
。参数化技术大大地提高了三
维建模的效率，使得建模达到更高层次的水平。 
 (2)特征建模的基本思想 
随着先进制造技术的快速发展，实体建模的缺点越来越明显，已经不能满足
企业制造业的发展需求。20 世纪 80 年代初，提出了特征建模的思想，弥补了实体
模型的缺陷。特征建模是以实体建模为基础，通过产品零部件的一些特定的设计
或加工功能的特征作为建模的基本单元来建立产品零部件的几何模型。其主要思
想是： ①从结构造型角度来看，它摆脱了实体建模的束缚，不再通过抽象的基本
几何体来拼合产品的零部件。②从信息角度来看，在产品开发过程中，特征是各
种产品信息的载体。它不只是包含产品零部件的几何和拓扑信息，而且还包括了
设计制造过程中所需要的一些非几何信息。 
Pro/E 软件的建模特色就是特征建模思想，特征是建模的基本的设计和操作单
位，特征设计是特征建模的最高层次的建模方法。 
(3)全相关的单一数据库 
Pro/E 软件的另一重要特色就是它具有全相关的单一数据库。传统的 CAD 系统
大部分是建立在多个数据库之上的，而 Pro/E 系统则与它们的这一点不同，它是
建立在单一数据库之上的。顾名思义，单一数据库就是在产品设计制造过程中将
所有与产品相关的设计信息与数据都存储自同一个数据库中。单一数据库的使用，
能够使得不同部门的设计人员在同一数据库中对同一产品的信息进行协同设计。
更为突出的是，全相关的单一数据库的使用，使得不同部门的设计人员无论修改
设计中的任何一处信息与数据都将自动地反映到整个产品设计的相关联的其它环
节中。比如，如果改变草绘的二维平面图中的基本参数，它将会驱动三维实体模
型随参数的变化而发生相应的更改，同时也将驱动数控加工的工艺路线的自动更
新。综上所述，全相关的单一数据库的使用大大提高了产品研究与开发的效率，
同时将为产品的设计和生产提供非常好的便利条件。  
  - 34 -
4.2.2 建立制造模型 
在小口径炮弹设计任务中要有目的地采用参数化建模和特征建模,来达到小
口径炮弹设计中新的要求。Pro/E 是基于特征的全参数化软件,是现代建模方法应
用的典型代表。 
参数化设计是将特征尺寸按照一定的规则或代数方程式的形式建立相应的联
系和约束关系，通过合理的推理和求解机制驱动产品零部件模型的整体变化。它
主要是通过整合实体模型和曲面模型的各种特征存放于同一建模系统，实现特征
模型的变换和组合，并且形成产品特征参数的全相关单一数据库。参数化设计是
在全相关的单一数据库的基础上进行的，通过修改全相关的单一数据库中的产品
某一特征信息来驱动其它相关信息的自动改变，从而使得新产品的几何图形、工
艺规划、相关的数控加工数据、零件的装配信息等快速生成
[51]
。 
特征建模是一种用实体几何要素和高层次的工程语义信息单元能够着重描述
产品的完整信息的高水平抽象建模技术。建模以特征为对象，工艺设计时以特征
为基本单位，加工时以特征为基础生成刀轨迹文件。在 CAD 应用中，特征建模系
统要求能方便地自动地生成特征，进行删除、修改、变换、复制、查询等。它不
仅能够将尺寸、公差、加工要求等属性附加在模型特征上，而且要求这些特征信
息能够为以后的产品研发设计应用作充分的铺垫。 
根据目前 MBD 参数化建模的应用情况，它仅仅在航空业上得到了进一步的深
入发展，其在武器装备行业的应用还未开始启动。要想在武器装备行业得到更好
的应用，首先要定制适合小口径炮弹的 MBD 规范
[30]
。其次，利用程序语言和二次
开发工具 Pro/TOOLKIT 进行二次开发，建立人机交互界面（如图 4.2 所示），通过
分析已有产品模型参数进行相应数值的修改，并在保持原有的产品模型参数约束
关系不变的情况下，得到相应的新产品几何模型，从而实现基于 MBD 模型的参数
化建模驱动系统的统一建模。
  
  - 35 -
 
图 4.2 MBD 参数化界面 
Fig4.2 MBD parameterized interface 
零件信息主要分为两种类型：几何信息和非几何信息。其中，几何信息是指
零件的几何形状和尺寸，如表面形状、表面间的相互位置、尺寸及其公差，实际
上是工程图纸上的图形。非几何信息主要包括产品的加工精度、毛坯特征、零件
材料、表面处理、表面粗糙度、热处理、配合和啮合关系等及相应的技术规范。
在制订工艺过程中，这些非几何信息都是所必需的
[57]
。如图 4.3 所示，为穿燃弹
弹体 MBD 模型参数化。 
 
图 4.3 穿燃弹弹体 MBD 模型参数化 
Fig4.3 Wear combustion play MBD model parameterization  
  - 36 -
本穿燃弹弹体模型设计实例中，主要是通过结合基于约束的尺寸驱动方法和
基于特征的参数化建模方法进行设计。穿燃弹弹体零件模型如图 4.4 所示。 
 
图 4.4 穿燃弹弹体零件模型 
Fig4.4 Play parts model of wear combustion  
4.2.3 制造设置 
制造设置主要是配合 NC 加工制造过程中所需要的各项加工参数及相应的毛
坯、机床、刀具、夹具、工作坐标系和退刀面等进行的操作数据设置。它对以后
加工生成的相对于加工坐标系运动而产生的刀位路径（ CL）数据起着非常重要的
作用，对工件加工质量的好坏有着直接的影响
[33]
。 
（1）机床的设置  
结合计算机技术和先进制造技术的数控机床是一种高精密设备。在对产品零
部件的机械加工路线设计过程中，需要考虑选择什么规格的加工机床的问题。因
此，首先要分析产品零部件的外部结构和加工要求，才能决定机床和联动加工轴
数的选择，并在制造过程中进行相应的机床设置。最常用的是数控铣床和数控车
床。本实例中，结合穿燃弹弹体的外部模型结构特点和其加工要求选择了数控车
床进行并进行相应的配置来完成其弹体的数控加工。如图 4.5 所示，为穿燃弹弹
体加工机床的设置界面
[55]
。  
  - 37 -
 
图 4.5 穿燃弹弹体加工机床的设置界面 
Fig4.5 Wear combustion play machine Settings interface 
（2）刀具的设置  
任何一种加工方式都要在充分了解加工对象的材料、加工机床的选择及加工
序列等因素的基础上来选择合理的加工刀具。刀具的选择主要包括刀具的结构、
材料和角度。在 Pro/E 中可供选择的刀具主要有端铣刀、立铣刀、球头铣刀、鼓
形铣刀等。此外，用户可以根据零件特点和加工要求进行要自己创建刀具。在
Pro/NC 中设置刀具主要有预先设置刀具和创建 NC 序列时建立这两种方式。如图
4.6 所示，为刀具设置界面。 
 
图 4.6 刀具设置界面 
Fig4.6 Tool setup interface  
  - 38 -
（3）夹具的设置 
夹具是用来防止加工毛坯因为刀具切削力的影响而产生震动和位置偏离的。
为了保证制造加工过程中的准确性，它主要用于帮助加工工件的定向和夹紧工作。
夹具可以是零件也可以是组件，并且变化多端。与实际加工过程一样，数控机床
上零件的装夹也需要选择合理的定位基准和夹紧方案。数控加工中用的夹具大多
是通用的，主要有通用夹具、成组夹具、专用夹具、随行夹具和组合夹具等。所
以，在大多数情况下，数控加工人员不用进行实际设计。 
（4）工件坐标系的设置  
工件坐标系是在编程时以工件上某个点坐标作为程序原点，并将其作为坐标
系原点建立的新坐标系。在操作设置中定义加工坐标系和在 NC 序列设置中定义工
件加工坐标系是不同的。第一种加工坐标系的定义适用于所有 NC 序列，而第二种
定义只能影响一个 NC 序列的刀具路径数据。在加工坐标系设置时，选择的加工零
点最好放在方便转换坐标值的工件图的位置
[34]
。此外，为满足加工要求，加工零
点所在的工件表面应该满足尺寸精度较高、粗糙度比较低的条件。同时，当加工
零件是对称图形时，应该将其对称中心选择为加工零点。 
（5）退刀面的设置  
退刀面就是刀具退刀后距离工件有一定距离的平面或曲面。在 Pro/E 中退刀
面的设置可以是平面、球面、圆柱面或定制曲面。在实际加工中，为了加工准确
和安全的考虑，需要设置安全的退刀高度。刀具在加工完一个加工区域后，然后
在垂直方向上移动一定的高度确保不碰撞到工件，再横向平行移动一定的安全距
离，在安全区域再下刀进行加工。工作人员可在操作级上指定退刀曲面，也可以
根据加工需求在 NC 序列级上修改退刀面的设置。退刀面的准确设置保证了加工零
件的质量和效率。 
4.2.4 加工设置 
（1）加工路线的确定 
首先根据小口径炮弹零件特征的复杂程度及其特点选择合理的加工类型，因
其外部结构是轴类零件，比较适合车削加工，对于其中的孔进行孔加工等等，也
就是说相应的特征对应相应的加工类型。在确定加工类型的前提下，选取参考零
件上所要加工的表面，进行相应的工步、工序、加工参数和方向等等的设置，即 
  - 39 -
确定了数控加工工艺路线。 
（2）加工工艺参数的确定 
所有的机床虽然类型不同，但其对应的工艺参数的描述和定义都是相同的。
它包括轴转速的确定、步长的确定、逼近误差的大小、下/走刀速度、切削进给速
度的确定、切削间距的大小、背/侧吃刀量的确定和离开切削时过渡方式等等。此
外，加工工艺参数数值的具体大小应该用类比的方法进行确定。机床性能、相关
手册的参数标准以及实际加工经验直接决定了工艺参数的选择。工艺参数确定的
一般规则是先主后次，先面后孔，先粗后精，先内后外等。同时，工艺参数的选
择是否最优主要取决于主轴转速、背吃刀量及进给速度之间的最佳配合。 
（3）工艺方案的确定 
穿燃弹弹体零件，材料为 35Cr Mn Si A，毛坯尺寸为φ25×67mm，根据工艺要求，
确定工艺方案及走刀路线如下： 
按基准先行，先粗后精，先主后次的加工原则，将工艺方案分成八道工序，
分别为：①倒角、粗车外圆；②粗车风帽槽；③精车外圆；④切弹带槽；⑤辊花；
⑥切断。 
根据工序确定走刀路线。第一次装夹：①首先切削毛坯右侧端面，然后按照
从右至左从 C2.06 倒角处开始切削，根据工艺要求的切削速度和走刀量对毛坯外
圆进行多次切削。②切削φ22.80 处风帽槽。③根据精车工艺要求对外圆进行从右
至左的切削。④切削φ10.70 处弹带槽。⑤对图中三处需辊花位置进行辊花处理。
第二次装夹：⑥对零件尾部进行切割处理。 
根据设计好的工艺方案及走刀路线，在 Pro/E 中对加工参数进行进一步设定，
然后通过刀轨计算实现自动编程，经过后置处理输出相应的合理的 NC 程序
[35]
。 
4.2.5 刀具路径模拟及 NC 检测 
Pro/NC 模块是 Pro/E4.0 提供的数控加工模块。它的主要功能是进行模具各零
件的 CAM。通过合理配置穿燃弹弹体零件的加工模型、工件、刀具、机床及加工参
数等，经过 Pro/NC 处理后产生刀位数据文件（CL 文件）。对零件加工过程进行模
拟，通过系统设置检测出加工过程中出现的误差、路径的干涉以及零件尺寸产生
过切现象等问题。然后有针对性的进行加工设置调整，直到设计出更加合理的生
产加工过程文件，以便于实际的零件加工。如图 4.7 所示，为 NC 计算与仿真过程。 
  - 40 -
确定好穿燃弹弹体的加工路线和工艺参数后，将其输入计算机系统软件计算出刀
位路径（CL）数据。由于不能够直观地确定 CL 数据的正确性，所以要经过动态的
方法进行屏幕显示演示弹体加工的刀具轨迹。CL 数据动态显示的三种方法主要有：
①通过过切检测；②NC 检测；③屏幕显示 CL 路径。通过三种方法检测出的穿燃弹
弹体加工的 CL 数据如果存在问题，能够通过原来的序列设置进行重新配置，根据
修改反馈意见对穿燃弹弹体零件加工参数和加工路线进行调整，直到能够满足弹
体零件的数控加工要求
[55]
。如图 4.8 为加工刀具路径。 
 
图 4.7 CL 计算与仿真 
Fig4.7 CL calculation and simulation 
 
图 4.8 加工刀具路径 
Fig4.8 Processing cutting tool path 
 4.2.6 Pro/E 后置处理 
综上所述，我们得到了加工穿燃弹弹体零部件的刀具运动轨迹文件。但是，
这些刀具轨迹文件不能被实际加工的机床控制器识别
[56]
。为使得穿燃弹弹体刀具
轨迹文件被机床识别，就需要将其进行文件转换，这一过程就是后置处理。主处
理程序和后置处理程序组成了一个完整的自动编程系统。主处理程序主要用于输 
  - 41 -
出刀具轨迹文件，后置处理程序主要是将刀具轨迹文件进行信息转换成可用的数
控加工程序。如图 4.9 所示，为 Pro/E 环境下 NC 程序的获取界面。 
 
图 4.9 Pro/E 环境下 NC 程序的获取界面 
Fig4.9 Accessing NC program interface under the environment of Pro/E 
4.3 VERICUT 数控加工仿真 
通过以上工作已经在三维建模软件中实现了穿燃弹弹体的基于特征的参数化
建模，并通过 Pro/NC 模块完成了模拟加工，并输出了适用于数控机床加工的 NC
程序。本章将选用 VERICUT 软件完成穿燃弹弹体的数控仿真加工过程的模拟。它
是一个综合性较强的仿真软件，不仅能够模拟加工的刀具轨迹，而且可以同时进
行机床的仿真运动。首先根据穿燃弹弹体的加工特征与输出的 NC 程序选择合理的
控制文件，建立合适的机床、毛坯、工件、夹具、刀具等制造资源的几何模型，
并为其配置相应的加工制造参数，最终在 VERICUT 环境中完成对穿燃弹弹体真实
加工过程的仿真和优化。 
4.3.1 数控机床建模及控制文件 
“.mch”为机床文件的扩展名，它是一个 ASCII 格式的文本文件，主要用于
机床结构、运动关系等信息的定义。VERICUT 自带的机床文件有 Moriseiki、Fanuc、
Okuma、Siemens 等 70 多个机床模型，用户也可以根据自己的需求自行建立机床模
型
[31]
。 
在 VERICUT 中自行建立机床模型主要包括两部分：①建立机床组件。②建立 
  - 42 -
实体模型。在 Veri Cut 软件中建立机床模型的基本步骤如下。 
（1）若建立复杂的实体模型时需要从 CAD 软件系统中调入，则首先应输入已
创建好的 CAD 模型。 
（2）通过分析实际的数控机床结构和运动学特性，在 Veri Cut 中依次添加基
本的机床组件，并保证定义的每个组件时都在各自的机床零点位置。 
（3）分析实际需求，可选择性地在相应的组件上添加三维实体模型，体现机
床组件的尺寸和形状。 
（4）对机床基本组成结构进行运动功能设置后，应将 VERICUT 复位，使得每
个运动部件回到自己相应的初始位置。 
（5）为防止数控加工过程中机床运动出错，应运用 MDI 检测机床的各项功能
（如换刀、各机床轴的运动等）是否达到预期目的。 
（6）保存机床文件。 
完成机床结构设置后，机床的初始化设置也是必不可少的步骤。在仿真过程
中出现的超行程和干涉都用红色表示进行区分，并将组件、工件或夹具之间发生
的碰撞和干涉保存在 Log 文件中便于输出查看后修改加工方案。 
数控机床的基本组成结构设置完成后，需要为其配置数字控制系统，否则机
床将不能实现它的运动功能
[27]
。本系统选用“fan15t_t”控制系统文件，运用 MDI
功能，检测各机床轴的运动，并保存机床文件。如图 4.10 所示，为建立的穿燃弹
弹体仿真加工数控车床实体结构模型。 
 
图 4.10 数控车床实体结构模型 
Fig4.10 Numerical control lathe entity structure model  
  - 43 -
4.3.2 毛坯、夹具建模 
在 VERICUT 模拟仿真中，毛坯用于仿真实际切削过程中的工件，夹具用于实
际加工过程中保证毛坯相对于机床或刀具保持正确的位置，避免不必要的干涉和
碰撞
[32]
。与机床的建模方法一样，本例研究的穿燃弹弹体是一个回转体，所以采
用图形生成器来编辑生成一个φ12.5×67mm 的圆柱体作为毛坯。由机床特征和毛
坯特征所选用的夹具为圆盘夹具，其规格为φ50×5mm。如图 4.11 所示，为穿燃
弹弹体加工的毛坯、夹具模型。 
 
如图 4.11 毛坯、夹具模型 
Fig4.11 Blank, clamp model 
4.3.3 刀具建模 
刀具是能够帮助机床完成切削加工的重要工具，为了使系统能够更加精确地
模拟材料去除的过程，在向 VERICUT 中添加刀具文件时需要精确到每个细节。利
用 VERICUT 系统的刀具建模模块建立精确的刀具库文件，并给刀具库中的每把刀
具加上 ID 号，便于进行仿真加工时直接调用或经过适当编辑后使用。本例中的刀
具尺寸均以 VERICUT 提供的加工实例为基础，通过反复试切来修改并确定刀具的
角度和尺寸，同时与数控程序相对应以达到目标尺寸的精度
[33]
。如图 4.12 所示，
为加工穿燃弹弹体所用的刀具。  
  - 44 -
 
图 4.12 穿燃弹弹体加工刀具 
Fig4.12 Tool of wear combustion play body 
4.3.4 工件坐标系设置 
正确的设置工件坐标系，能够确保数控机床和刀具的运动路径更加简单易于
操作。由穿燃弹弹体的尺寸分布情况来确定加工工件的坐标系原点。第一次装夹
时，将工作原点取在工件左端面轴心处，刀具零点坐标为（0,0,5）。第二次装夹
时，将工作原点取在工件右端面轴心处，刀具零点坐标为（0,0,77）。 
4.3.5 加工仿真结果 
如图 4.13 所示，为穿燃弹弹体的数控加工仿真。在 VERICUT 中定义好机床与
控制文件、毛坯与夹具文件、刀具文件，确定了工件加工坐标系之后，将通过 Pro/E
软件中的 Pro/NC 模块对加工刀位轨迹文件后置处理后输出的 NC 程序导入到
VERICUT 系统中，最后进行穿燃弹弹体的数控加工仿真。在仿真过程中，可随时暂
停加工，随时对任一位置的尺寸和角度进行检测，能够及时地发现 NC 程序中的逻
辑错误，并将错误报告以 LOG 的文件形式保存到“VERICUT 日志”中，方便用户进
行程序检查和修改
[34]
。  
  - 45 -
 
图 4.13 穿燃弹弹体数控加工仿真 
Fig4.13 Wear combustion play NC machining simulation 
4.3.6 虚拟检验及刀具轨迹优化 
Veri Cut 软件利用自身强大的分析和比较能力可以对仿真模型的几何加工参
数及加工过程信息进行测量和检查。它还能够分析仿真加工模型的数据与设计模
型数据进行深入的比较，并对零件加工的质量进行虚拟检验。 
(1)虚拟检验 
Veri Cut 的 AUTO-DIFF 模块主要为加工模型提供检查与分析的功能。该模块对
问题进行处理时可以通过平移、缩放、旋转等方式对模型进行多角度观察，也可
通过规定任意方向的剖面视图来查看不同的区域及层面，确保工件的加工精度符
合企业产品的工艺设计要求。该模块通过比较穿燃弹弹体的设计模型和仿真加工
切削模型，并设置一定的公差水平作为标准来检测出它们模型数据之间的区别。 
通过刀具更换、加工参数的重新设定以及数控程序的手工修改后再次进行穿
燃弹弹体的加工仿真。此过程重复进行，直到在信息栏中显示无过切、欠切现象
时，则表明穿燃弹弹体的加工模型已经满足了企业所要求的加工精度。如图 4.14
所示，VERICUT 切削检查。  
  - 46 -
 
图 4.14 VERICUT 切削检查 
Fig4.14 VERICUT cutting tests 
（2）刀具轨迹的优化 
优化刀具轨迹就要根据参数调整重新计算进给速度及主轴转速，形成一个更
加高效率高质量的加工刀具轨迹文件。在 Veri Cut 环境中根据刀具和车削具体的
情况，通过在优化管理器(Opti Path Manager)中重新创建或优化刀轨库文件
[35]
。
在该管理器中打开优化开关，根据虚拟检测的结果将优化好的文件存储位置和文
件名称重新设置，在 VERICUT 中重新再次进行仿真和优化，直到满足企业零件的
加工要求得到优化好的完善的加工程序。 
本例对穿燃弹弹体的外轮廓进行加工仿真优化，以其中一把切断刀为例进行
优化设置的过程，T5 号刀具为切削风帽槽及弹带槽所用刀具。选择“优化”→“控
制”→优化方式选择“当切削时提醒”，启动优化后开始仿真，系统会弹出包含多
种优化选项的优化设定窗口，选择所需优化的部分后，系统会继续根据优化结果
进行切削仿真。优化刀具的轨迹将使得零件的加工时间都明显减少，如图 4.15 所
示，为优化时间节省器。优化时间节省器上的数据表明每加工一个穿燃弹仿真所
用的总时间减少了 2 s。 
由此可看出在仅仅优化一把刀具所加工的一道工序的条件下，系统的仿真效
率提高了 0.03%，可见被优化后的数控加工过程被有效地去除了一部分无用的空切
削运动，使进给速度和切削效率得到明显提高，也使刀具轨迹的变化更加频繁。 
  - 47 -
VERICUT 使得仿真加工对缩短零件的设计制造周期具有十分重要的现实意义，引领
着数控技术不断向信息化和智能化方向发展
  [40]
。 
 
图 4.15 优化时间节省器 
Fig4.15 Optimization of time saving 
4.4 本章小结 
本章主要提出了一种 Pro/E 和 VERICUT 联合使用的小口径炮弹数控加工仿真
系统。首先在 Pro/E 系统中实现穿燃弹弹体零件的基于 MBD 的参数化建模、自动
编程和加工参数优化，然后在 VERICUT 进行穿燃弹弹体的车削过程动态加工仿真。
通过 VERICUT 的 AUTO-DIFF 模块进行虚拟检验和刀具轨迹优化，重复修正数控代
码， 重复进行弹体加工仿真过程，最终获得满足要求的最佳的 NC 代码。穿燃弹
弹体车削加工的实例表明，将 Pro／E 和 VERICUT 联合运用验证了进行虚拟数控加
工技术的正确性和实用性。 
-48- - 48 -
 
第 
5 
章
   
三维工艺设计集成
 
 
在小口径炮弹三维工艺设计系统集成项目中，采用了接口交换和紧密集成交
互的方法在 Windchill 与 CAD/CAM/XTCAPP 系统之间进行相关方面的定制和开发，
达到良好的集成效果。Windchill 系统强大的开放性提供的客户化开发工具（UML
语言、API 函数、ICE 集成环境）足够完成我们的集成开发工作，在集成工作时，
对 Windchill 主要以客户化定制为主，对 CAD/CAM/XTCAPP 主要以接口的开发和功
能模块的删减为主。在产品信息管理系统中，可以定制需要的工艺文档管理类型、
图标、对话、菜单以及相应的消息和属性等，并为其编写一定的规则条件，以控
制用户使用的访问权限和对产品信息的操作条件
[48]
。XTCAPP 所提供的客户化功能
相对薄弱，集成时在原有功能体系基础上，对软件的源代码作了一些修改，开发
了数据接口，并添加了一些必要的模块，实现与智能工艺路线设计系统、基于 Pro/E
与 Vericut 的数控加工仿真系统的集成，并用以支持与 PDM 的集成。 
5.1 Windchill 相关技术 
Windchill 是 PTC 公司开发的 PDM 产品。它是一个以纯 Java 语言为核心的网
络化产品数据信息管理平台，它能够使企业与生产商、供应商、经销商和客户在
网络环境中以适当的权限在不同操作系统的客户机之间无缝地访问不同格式的产
品数据资源。 
Windchill 系统中的信息建模工具是一种面向对象的快速的系统二次开发工
具。它主要用于对 Windchill 系统功能进行客户化定制或二次开发，也用于对专
用的产品协同开发商务应用程序的建立和部署。在 Windchill 信息建模工具中嵌
入有高水平的面向对象分析和设计工具 Rational Rose
[42]
。在信息建模工具构建的
一个模型驱动式的应用程序开发环境中，建立并执行高效的基于 Java 和 Web 为中
心的产品信息过程管理解决方案并不需要开发经验丰富的工作人员。Windchill 
Foundation 和 Windchill Lifecycle Application 是 Windchill 系统的套件服务
核心。在这些核心的套件服务基础上，各种应用程序的定制能够促进企业整体范
围内核心产品信息和过程信息的快速传递与共享
[46]
。  
  - 49 -
Windchill 的 Rational Rose 支持统一建模语言 UML。产品开发设计过程中的
动态和静态信息都是通过该建模语言进行表达的。它不仅能够开发出企业所需求
的功能方案,而且能够保留充分的空间增加产品的附加值和差异性。它是一个图形
化语言，支持模型化和软件系统开发。当建立一个包括 Windchill Foundation 类
和企业特殊应用程序类的复合对象模型时，应用开发者可以采用这种建模语言以
图形方式进行定义
[48]
。这将有利于构建一个功能强大的解决方案，开发出像 Web
一样灵活且方便的新的 Windchill 客户界面和相关的应用子系统。部署在
Windchill Foundation 运行体系结构的客户机、服务器和数据库层中 Java 代码和
数据定义语言 DDL 等最优产品都是 Windchill 系统开发工具产生的
[57]
。它们是综
合对象模型，其构建都是通过 Windchill Foundation 类及其扩展类、企业的增值
应用程序类等建立的。这样，开发人员的精力将集中在业务逻辑上，避免了大量
的重复性的编程工作，在很大程度上提高了企业产品生产率和质量。Windchill 系
统 生 成 工 具 的 功 能 主 要 体 现 在 以 下 方 面 ： (1) 建 立 基 于 Java 的
Windchill Foundation 类； (2) Windchill 系统生成工具通过编译编辑的模型 Java
文件自动生成相应的 SQL 脚本。此外，无论通过使用 DDL 建立 SQL 脚本能，还是
通过修改 Oracle 数据库模式来创建该脚本，都将使得开发效率达到更高的层次更
高的水平
[49]
。 
5.2 小口径炮弹三维工艺设计系统集成思想和架构 
Windchill 是一款基于 Windows 的、可客户化定制的产品信息管理系统软件，
它为用户提供了完整的企业、部门及个人之间的流程级 PDM 解决方案。尽管
Windchill 系统本身具有的功能非常强大，但是在产品研发过程中也不可以拿来即
用，需要对其进行一定的二次开发与客户化定制，以满足企业产品研发的实际需
求。首先，产品设计与制造全过程的关系与信息的描述与组织，不仅仅需要定义
零部件的结构，还需要定义毛坯、锻件及半成品等结构件。其次，Windchill 系统
中已有的属性定义只包括名称、系统编码和版本号等，不能够对零部件的属性进
行充分的定义
[60]
。为了在系统中将产品的设计、工艺、装配及制造等信息联系起
来，就必须进行系统的二次开发和客户化定制，来增加更多的产品信息属性。同
时，对文档与文件类型的分类定义也不能满足要求，有待扩展。在系统过程管理
模块缺少一定的属性定制规则，为实现产品研发的过程信息的有效管理，需要在 
  - 50 -
该模块添加与过程管理相关的监控属性项以及并行性处理。 
应用编程接口库是 Windchill 系统自身具有的集成开发工具。通过运用应用
编程接口库中的 API 函数，非常有利于产品开发人员根据自己的需要实现对原有
Windchill 系统管理功能进行有目的的增扩与裁减。同时对于与 XTCAPP 系统的数
据导入导出也可运用 API 实现，具体的方法可以使用 Visual Basic 或 Visual C++
等语言与 API 接口结合起来
[61]
。 
Windchill 系统中包含了设计 BOM 信息、CAD 档案等与产品相关的设计信息，
这些信息都是与 XTCAPP 系统息息相关的，而且 Windchill 的编码系统为产品的设
计到工艺提供了统一的编码标准。基于这种编码的属性定义，能够使得产品设计
图形到产品工艺设计信息联系起来，并能够快速地进行信息传递。因此，为适应
企业产品的工艺规划要求，XTCAPP 系统与 Windchill 系统的集成将使得企业各部
门之间或各工艺人员之间进行流畅的信息数据交流，实现了企业、部门及个人之
间共享数据的一致性
[57]
。 
XTCAPP 系统在产品开发总体环境下，它将不仅能够实现与前行 CAD 系统的集
成，而且能够实现与后继 CAM 系统集成，成为集成平台的一个有机组成部分。通
过产品数据的统一集成管理系统，实现了 XTCAPP 系统与 CAD/CAM 系统和 ERP 系统
的有机集成，同时也实现了 XTCAPP 系统与其上层产品信息管理系统 Windchill 从
信息和功能上的有效集成。CAD/CAM和XTCAPP 系统产生的数据均提交给Windchill
进行统一管理，应用系统之间不再进行数据的直接传递(即串行通信)，而是通过
Windchill 进行数据交换和实现数据共享(即并行通信)
[58]
。
 
本文采用Windchill系统提供的接口函数进行编程开发定制来实现与XTCAPP
系统的嵌入式和紧密式集成。在 COM 应用技术基础上，Windchill 系统自身提供了
一组对系统进行二次开发的 API 接口函数，我们按照 COM 技术应用规范，通过 VC++
开发工具根据企业产品信息管理要求进行相应的系统编程定制开发满足企业需求
的集成系统。通过集成系统开发，实现产品信息在 XTCAPP 与 Windchill 系统中进
行交流，即能够将产品信息从 Windchill 导入到 XTCAPP 系统中，再根据需要将
XTCAPP 系统中编辑生成的产品工艺信息导出到 Windchill 系统中
[59]
。Windchill
系统中具有产品的所有信息，有些产品信息正是 XTCAPP 系统进行产品工艺设计所
需要的，比如产品模型设计图纸、产品零部件的设计文档信息和产品设计的物料 
  - 51 -
清单等。这些产品信息中还有一些部分是 XTCAPP 系统不需要的零部件工艺信息，
需要有选择性的从 Windchill 系统中导入 XTCAPP 系统，剔除一些不需要的产品信
息，比如说产品标准件信息、包装件信息等。如图 5.1 所示，为 Windchill PDMLink
中工艺文件关系。 
 
图 5.1 工艺文件关系 
Fig5.1 Relationship between process document 
根据以上集成思想和架构的分析，结合 Windchill 技术，建立了基于全三维
的小口径炮弹智能工艺设计集成平台体系结构，如图 5.2 所示。 
图 5.2 小口径炮弹智能工艺设计集成平台体系结构 
Fig5.2 Small-bore shells intelligent process design integration platform 
architecture 
集成平台由 Windchill 与三维参数化建模系统、三维工艺设计子系统、数控
加工仿真系统集成而成，包括对三维参数化建模设计信息、三维工艺设计信息、 
  - 52 -
三维可视化数控加工信息和全三维模型的数据管理，适合基于 Web 的协作平台，
支持重要的产品开发元素，有利于网络化的生产制造模式。 
5.3 三维工艺规划系统 
本课题结合热点需求和企业使用要求，完成基于 XTCAPP 的三维产品工艺系统。
基于 XTCAPP 的三维工艺规划系统的建立，使得产品工艺设计的效率和质量都有了
很大层次上的提高，在企业产品设计方面实施了产品工艺的标准化、规范化，进
一步使得产品设计工艺信息在企业范围内得到了高度共享
[53]
。 
5.3.1 智能工艺路线设计模块 
智能工艺路线设计模块是通过小口径炮弹智能工艺路线设计专家系统与三维
工艺设计系统集成，对小口径炮弹的各种零部件的加工工艺路线进行定制、编辑
和管理。 
利用 VBS 脚本语言对 XTCAPP 系统二次开发
[38]
，将小口径炮弹智能工艺路线设
计专家系统嵌入到 XTCAPP 系统中，即在 XTCAPP 系统中实现对小口径炮弹智能工
艺路线设计专家系统的调用，使小口径炮弹智能工艺路线设计专家系统与 XTCAPP
系统有效集成，实现小口径炮弹智能工艺路线设计专家系统与 XTCAPP 的工艺路线
的交互及管理。 
XTCAPP 三维工艺规划系统将企业工艺路线分为以下三个层次：①产品级工艺
路线；②产品装配级工艺路线；③零件级工艺路线。企业开展产品设计生产的全
过程就是从以上描述的工艺路线的设计和管理的三个层次方面进行的
[43]
。 
建立工艺路线模板结构树，其序号由系统自动生成，分类号为模板分类的序
号，名称、描述按照小口径炮弹工艺设计要求输入。输入的信息组成工艺路线结
构树的单元内容，以便于编辑工艺路线时，可以直接从子单元或模板列表里选择，
组成单元顺序可以自由调换、删除。 
在小口径炮弹三维工艺设计系统（XTCAPP）工艺路线编辑与管理模块包含多
种类型的工艺路线和子工艺路线设计。该模块通过调用系统数据库中的基础产品
工艺信息，自动生成各种产品工艺路线并对其进行编码管理与再次调用等操作。 
子路线包括单纯的子路线和子单元、子路线结合两种方式。选择穿燃弹工艺
路线，点击编辑页面“扩展”按钮，弹出子单元属性集编辑器，对子单元的工艺
进行各种设置和编辑。如图 5.3 所示,进入工艺路线编辑界面，通过“新建—子单 
  - 53 -
元结构树”的操作，从编辑好的工艺子路线中选择所需要的进行穿燃弹工艺路线
的编辑。或者通过已建立过的工艺路线模板（典型工艺路线），在其基础上修改，
生成产品的工艺路线
[47]
。对于相似的零部件的工艺路线，可通过典型工艺路线，
快速建立，避免了重复性劳动，提高效率。
 
 
图 5.3 穿燃弹工艺路线 
Fig5.3 Wear combustion process route 
5.3.2 参数化设计与数控加工仿真模块 
利用 VBS 脚本语言，为三维工艺规划系统添加菜单，以便于在三维工艺规划
系统中调用 Pro/E 与 Vericut，从而实现三维模型设计、工艺设计与工艺仿真的同
步显示，使得小口径炮弹的各部分达到统一
[56]
。 
（1）三维参数化设计双向驱动 
产品参数化设计双向驱动就是要实现工艺卡片中产品零件的工艺简图能够直
接调入到三维产品建模系统中进行全方位的浏览与修改，同时也要实现同一卡片
中的产品工序的工艺要求可以直接被调用到工序要求文本编辑系统软件中进行相
应要求的查看和修改，最终实现基于 XTCAPP 的三维工艺规划系统的 “所改即所
得”的模块功能
[54]
。 
本文主要是通过对 Pro/E 进行二次开发
[29]
，使用 OLE 对象技术，实现工艺卡
片中工序简图与三维建模系统中的产品三维模型的双向驱动和交流
[25]
。再通过对 
  - 54 -
Office 系统进行相应的二次开发，实现与三维工艺设计系统的嵌入式系统集成，
实现在三维工艺卡片中的工艺要求在两系统之间进行相互访问、查看与修改
[44]
。
如图 5.4 和 5.5 所示。 
 
如图 5.4 工序简图双向驱动 
Fig5.4 Two-way drive process diagram 
 
如图 5.5 工艺文档双向驱动 
Fig5.5 Two-way drive process document 
（2）三维工艺数控加工仿真 
三维工艺数控仿真与参数化建模是相互影响的，使用三维建模系统对小口径
炮弹进行参数化建模，并对建模系统进行二次开发，实现三维建模系统与三维工 
  - 55 -
艺设计系统三维参数化双向驱动的同时，需要对数控加工仿真系统也进行二次开
发
[26]
，使得工艺参数、工艺模型与工艺仿真同时在三维工艺设计系统进行可视化
管理，使用数控加工仿真系统检验小口径炮弹某工序加工过程中的各种误差，进
行加工优化，然后在三维建模系统中对小口径炮弹的参数根据优化结果进行修改，
同时驱动三维工艺设计系统中的工艺参数与工艺模型与其达到统一
[45]
。如图 5.6
所示，数控加工仿真系统与三维工艺设计系统集成运行界面。 
 
图 5.6 数控加工仿真系统与三维工艺设计系统集成运行界面 
Fig5.6 NC machining simulation system with three-dimensional integrated process 
design system interface 
通过二次开发实现了对 Vericut 直接调用,从而实现在三维工艺设计系统中浏
览工序简图、工艺要求等信息的同时，可以观看该工序的数控加工过程，可以修
改数控加工程序，优化数控加工过程，从而实现了三维产品工艺设计系统和基于
Pro/E 与 Vericut 的小口径炮弹数控加工仿真系统的集成。 
5.3.3 三维工艺编辑模块 
三维工艺卡片模板的定制主要是通过拆分工艺表格、定义标题区与明细区并
编辑相应模块的定制内容，使得工艺人员进行工艺设计时使用。为能够使得工艺
设计人员随时调用工艺卡片模板，就需要建立大量样式的卡片模版，并进行入库
分类管理，这样工艺人员在调用时将非常方便。“所见即所得”的工艺卡片定制模
块与工艺规划系统中的其他工作模块紧密集成，有利于各功能模块之间进行信息 
  - 56 -
传递，大大提高了企业工艺设计的工作效率
[22]
。 
工艺卡片编辑模块与工艺卡片定制模块紧密集成。在该模块根据工艺要求，
直接调用工艺卡片模板库中的模板卡片，然后根据具体的工艺内容进行相应的编
辑，比如工序，工序内容，工序模型、工艺参数及工艺路线等等工艺内容
[37]
。根
据产品结构树编辑好所有的工艺卡片内容后入库，使得卡片信息数据自动对应到
数据库中关联体系相关的工艺基础数据，便于进行实时查询和使用，在很大程度
上避免了大量的重复劳动。此外，还可以将编辑好的工艺卡片编辑成工艺图册，
输出打印，便于制造人员使用，提高了企业产品开发设计生产效率
[23]
。 
工艺卡片模块在某种情况下可以根据系统中已有的工艺卡片进行自动生成。
该功能是基于工艺规划系统中的编码系统及成组编码技术，并且能够实现工艺卡
片在编制时的灵活的查询复制功能。同时，工艺系统通用的工艺卡片模块能够根
据企业产品的不同需求进行用户化定制，实现工艺卡片在不同情况下的管理和维
护。客户化定制工艺卡片模块能够建立与三维建模系统、工艺路线设计系统、数
控加工仿真系统之间的联系，使得系统之间能够进行基础数据关联查询、工艺简
图编辑及工艺要求设计等功能，并对工艺卡片的其他相关文档进行相对集中的管
理和维护及其输出打印等
[24]
。 
5.3.4 工艺文件输出模块 
工艺文件的输出包括两部分,一是可以从工艺文件编辑模块直接输出想要的
格式文件，二是使用三维工艺设计系统工艺图册，进行某零部件的工艺排序、优
化排版后设置页码，集中输出.tbb 格式的工艺图册，最后可打印装订成册，以便
于制造工人使用
[36]
。 
5.4 Windchill 与三维建模系统集成 
5.4.1 集成的实现 
Windchill 
的 
PDMLink 
服务器是存储和管理全部产品数据的电子仓库，在 
Pro/E
内注册 
PDMLink 
服务器，实现了 
Windchill 
与 
Pro/E 
三维软件的有效集成（如图
5.7 
所示）。在 
Pro/E 
中调用 
Windchill
（如图 
5.8 
所示），使得集成平台能够获取建
模设计系统中的产品设计信息，即设计人员在建模设计系统中完成的 
MBD 
模型信
息上传至 
Windchill 
平台上进行管理。
  
  - 57 -
 
图 5.7  Windchill 与 CAD 的系统集成 
Fig5.7 Windchill system integration with CAD 
 
图 5.8 在 Pro/E 中调用 windchill 界面 
Fig5.8 Pro/E invokes the windchill interface 
5.4.2 MBD 模型上传 
在 
Windchill 
中只含有小口径炮弹零件的模型结构，没有产品结构及模型信息，
因此通过三维建模系统与产品数据管理系统进行集成，对小口径炮弹零件进行基
于 
MBD 
的三维参数化建模后
[30]
，将小口径炮弹零件的 
MBD 
模型及信息上传到 
  - 58 -
windchill 
集成平台，从而实现模型结构驱动产品结构，而产品结构驱动 
WTPart 
结
构，有效地保证了小口径炮弹模型结构与小口径炮弹的产品数据仓库中产品结构
的一致性。如图 
5.9 
所示，
MBD 
模型信息的上传方式。
 
 
图 5.9  MBD 模型信息的上传方式 
Fig5.9 MBD model information upload method 
以穿燃弹为例，通过系统集成工作区提交到集成平台的穿燃弹加工零件的 MBD
模型信息、数控加工信息等，可以在产品数据管理系统中直接通过三维软件打开
进行修改，保存后将同时改正了三维建模系统与产品数据管理系统中的穿燃弹模
型信息。实现了穿燃弹三维建模系统与产品数据管理系统之间的数据交换、存储
与管理。如图 5.10 所示。  
  - 59 -
 
图 5.10 上传到平台的 MBD 模型 
Fig5.10 The MBD model uploaded to the platform 
Windchill 不仅能够实现以上三维建模系统集成，而且能够实现异构 CAD 系统
集成。因为不同部门使用不同的 CAD 软件为同一个产品进行零件设计，所以异构
CAD 系统集成能够管理由不同 CAD 格式零件组成的产品和实现不同格式 CAD 数据组
成的产品可视化。另外，不同的客户需要不同的格式数据，不同部门使用不同的
应用，为满足这个条件，异构 CAD 系统集成还能够管理不同 CAD 工具设计的零件
数据
[62]
。 
5.5 Windchill 与三维工艺规划系统集成 
5.5.1 集成的实现 
本文以 Server2003 系统上的 Windchill（其数据库为 Oracle10g）作为服务
器，以 XP 系统上的 XTCAPP（其数据库为 Oracle9i）作为客户端，实现了两系统
之间的数据库共享，并且能够对产品信息进行系统之间的相互访问、查看和修改
[39,40,49]
。 
利用 VBS 脚本语言对 XTCAPP 系统二次开发，将 Windchill 嵌入到 XTCAPP 系
统中（如图 5.11），即在 XTCAPP 系统中实现对 Windchill 调用（如图 5.12），使 
  - 60 -
Windchill 与 XTCAPP 系统有效集成，实现 Windchill 与 XTCAPP 的数据、信息的交
互及管理。 
Windchill 与 XTCAPP 系统的有效集成，使得 PDM 能够获取工艺设计系统中的
产品结构信息，即工艺人员在工艺设计系统中完成的机械过程工艺卡片上传至
Windchill 集成平台系统中，通过权限和属性配置对产品信息进行有效的文档管
理、权限管理、生命周期和工作流程管理、工程变更管理等。 
 
图 5.11 Windchill 与 CAPP 系统集成 
Fig5.11 Windchill and CAPP integrated system  
  - 61 -
 
图 5.12 在 CAPP 中调用 windchill 界面 
Fig5.12 CAPP invokes the windchill interface 
5.5.2 三维工艺设计信息的上传 
在 Windchill 系统中通过编码构建小口径炮弹产品结构树，并确定小口径炮
弹零件的全生命周期状态，然后根据需要导出小口径炮弹的 BOM 给三维产品工艺
规划（XTCAPP）系统，使得产品零件进入到相应的工艺规划阶段。在 XTCAPP 系统
中接收小口径炮弹的 BOM，并在 XTCAPP 系统中进行并完成小口径炮弹的工艺设计
[61]
。工艺人员将按照产品工艺设计要求完成对产品相应的工艺规划。为实现产品
信息的集成管理，工艺人员需要将设计好的产品工艺文件全部提交到 Windchill
系统中，系统将根据编码和属性自动将其挂接到 Windchill 中小口径炮弹产品零
件结构树的相应的节点上，使得这些产品工艺文件在集成系统中进行相应的评审
与管理。企业的高层管理人员将对 Windchill 系统中的工艺文件进行一定权限的
浏览和评审，经过评审通过的工艺文件将正式发布并正式纳入 Windchill 管理系
统进行集成管理，成为企业范围内的受控技术文件；不能通过评审的工艺文件将
被拒绝，然后重新导入到工艺规划系统进行工艺的再设计，直到通过评审发布。 
Windchill 中主要通过创建单个文档和创建多个文档两种方式上传产品的工
艺设计信息，如图 5.13 所示。
  
  - 62 -
 
图 5.13 三维工艺设计信息的上传方式 
Fig5.13 The methods of uploading three dimensional process design information  
以航 23-2 穿燃弹为例，通过系统集成上传到平台的工艺卡片、工艺文档和工
艺图册等信息，如图 5.14、图 5.15、图 5.16 所示。 
 
图 5.14 上传到平台的工艺文档 
Fig5.14 Process document uploaded to the platform   
  - 63 -
 
图 5.15 上传到平台的工艺卡片 
Fig5.15 Process card uploaded to the platform   
  - 64 -
 
图 5.16 上传到平台的工艺图册 
Fig5.16 Process atlas uploaded to the platform  
小口径炮弹三维工艺规划系统与产品数据管理系统的集成，实现了 Windchill
与 XTCAPP 的业务流程级集成。这有利于企业对小口径炮弹的全生命周期的管理，
将使得小口径炮弹的工艺业务非常好地融入到其零部件的信息集成管理系统中，
实现小口径炮弹设计生产制造技术准备业务的统一。 
本文从企业设计和制造需求全方面的考虑，在计算机信息化技术的基础上，
通过二次开发技术，很好地完成了 XTCAPP 与 Windchill 系统集成的工作。在目前
企业深入研发小口径炮弹的设计制造阶段，系统集成的实现无疑满足了其产品设
计制造需求，非常好地适应了小口径炮弹产品设计、工艺设计集成和 PLM 应用方
案的工作开展。该系统集成平台已在企业成功试用，效果良好。 
5.6 小口径炮弹全生命周期管理 
通过以上系统集成功能的实现，建立了小口径炮弹三维工艺设计集成平台，
在此集成平台上能够实现小口径炮弹的全生命周期的管理。主要包括小口径炮弹
的文档管理、工程变更管理、产品结构管理、权限管理等
[46]
。 
文档管理主要是管理小口径炮弹智能工艺路线、工艺要求、工艺卡片，对其 
  - 65 -
可以根据用户要求进行评审，删除，修改，再提交，再评审，最终发布。 
工程变更管理主要是对小口径炮弹所有工艺信息评审、发布及修改状态的管
理，可以使用户看到产品信息实时变更动态。 
产品结构管理是通过 Windchill 中的产品结构浏览器对小口径炮弹产品结构、
模型结构与零件结构进行可视化与相关文档的配置，以便于实现产品结构树的配
置与清晰关系。 
权限设置非常重要，权限如果设置不当将会产生很多问题。比如，需要查看
或修改文件的用户没有足够的权限进行操作，而不应该访问或审批的人员却能够
有权限进行不当的操作，造成产品资料泄露或管理混乱的现象。权限管理包括：
①对小口径炮弹信息的静态权限控制，即将权限按照工作组、用户、角色、参与
者设定其相应的操作；②对小口径炮弹信息的动态权限控制，即把权限按照小口
径炮弹信息的生命周期、工作流程等顺序直接指定相应的用户对当前的产品对象
进行访问、修改或管理等操作
[60]
。 
5.7 本章小结 
本章主要对小口径炮弹智能工艺路线设计专家系统、三维建模系统、数控加
工仿真系统、三维工艺规划系统和产品数据管理系统的开发思路、集成功能实现
等进行了详细说明，并且对于各系统之间的集成效果进行了可视化展示，充分体
现了 CAD/CAM/CAPP/PDM 之间的集成运用，使得设计团队可共享产品设计开发数据，
能够保持数据的一致性、正确性和完整性，有效地提高了小口径炮弹的生产效率。 
 
 
 
 
 
 
 
 
 
 
  
  - 66 -
 
结
     
论
 
 
全文总结
 
论文在对项目合作企业多次充分调研的基础上，研究开发了小口径炮弹智能
工艺设计系统，进行了智能式工艺路线设计；对小口径炮弹进行了三维参数化建
模及可视化数控加工仿真，并建立小口径炮弹智能工艺设计集成平台，为小口径
炮弹生产制造的全生命周期的管理奠定了基础。 
论文的主要内容及成果如下： 
（1）小口径炮弹智能工艺设计集成平台总体方案的确定：通过对项目企业进
行充分地调研，本文研究开发了智能工艺路线设计专家系统、基于Pro/E与Vericut
的数控加工仿真系统、小口径炮弹工艺规划系统及小口径炮弹产品数据管理系统。
在这些系统研发的基础上，提出了小口径炮弹智能工艺设计集成平台，通过对比
三种集成方法，最终选择了适合该企业要求的集成方法，实现了智能式工艺路线
专家系统、基于 Pro/E 与 Vericut 的数控加工仿真系统、小口径炮弹工艺规划系
统及小口径炮弹产品数据管理系统之间的相互集成，达到了小口径炮弹工艺模型、
工艺要求和工艺仿真同步可视化以及小口径炮弹生产制造的全生命周期的管理。 
（2）智能工艺路线设计专家系统：查询小口径炮弹相关资料，总结归纳小口
径炮弹领域的专家知识，把弹箭领域内的专家知识通过使用专家系统开发工具
DEST 添加进知识库中，成功研发了小口径炮弹智能工艺路线设计专家系统。 
（3）基于 Pro/E 与 Vericut 的数控加工仿真系统：首先对 Pro/E 进行二次开
发，利用三维建模系统对小口径炮弹进行基于 MBD 模型的三维参数化建模，并根
据这些参数在 Pro/E 中进行数控加工，经过后置处理将数控程序导入到 Vericut
中进行数控加工仿真，对其工序进行故障检测，对工艺路线进行优化。 
（4）小口径炮弹三维工艺规划系统集成：对 XTCAPP 系统中工艺文件编辑模
块进行二次开发，利用 VBScript 脚本语言，为系统添加菜单，与智能工艺路线设
计专家系统、基于 Pro/E 与 Vericut 的数控加工仿真系统无缝集成；实现了小口
径炮弹工艺路线设计、工艺模型设计、工艺仿真设计的同步可视化，提高了小口
径炮弹的生产制造效率。  
 - 67 -
（5）Windchill 与 Pro/E 集成：通过二次开发实现 Windchill 与 Pro/E 集成，
从而达到 MBD 模型上传至 Windchill 平台上，使得小口径炮弹的零件模型结构驱
动产品结构，实现了小口径炮弹的零件模型在 Windchill 平台上的流程级管理。 
（6）Windchill 与 XTCAPP 集成：通过对三维 XTCAPP 系统进行二次开发，实
现了 Windchill 与 XTCAPP 集成，从而使得三维工艺规划系统从 Windchill 中获得
小口径炮弹零件的 BOM，并根据 BOM 的要求进行小口径炮弹的工艺设计，最终将三
维工艺规划系统中的工艺规程文件根据需要上传至 Windchill 平台进行集成管理。 
（7）小口径炮弹全生命周期管理：CAD/CAM/Windchill/XTCAPP 的集成，成功
建立了小口径炮弹智能工艺设计集成平台，实现了小口径炮弹所有设计信息集中
上传至产品数据管理系统，通过配置，对小口径炮弹的设计信息进行从产品计划
到产品制造的整个管理过程的全生命周期管理。 
工作展望
 
本文对小口径炮弹智能工艺路线设计专家系统、基于 Pro/E 与 Vericut 的数
控加工仿真系统、小口径炮弹三维工艺规划系统及小口径炮弹产品数据管理系统
进行了研究，通过对各系统的二次开发实现了系统间的集成，实现了小口径炮弹
智能工艺设计及集成，取得了显著的成果。但是，因为课题本身的复杂性以及受
一些客观与主观条件的限制，所以目前本课题的研究存在很多不足，不仅有一些
技术难题有待解决，而且还有需要进一步的研究。通过对本文的总结以及对已实
现技术的思考，产品工艺设计集成系统在技术上需要进行以下几方面的改进： 
（1）小口径炮弹智能工艺路线设计系统存在很多不足，需要进一步开发完善
添加知识库中的弹箭领域的专家知识。 
（2）完善基于 Pro/E 与 Vericut 的数控加工仿真系统，对 Vericut 的二次开
发技术需要进一步研究，实现数控加工工步的随点随停。 
（3）完善小口径炮弹三维工艺规划系统，彻底实现小口径炮弹的全三维智能
工艺设计。 
（4）完善小口径炮弹智能工艺设计集成平台，对各系统的集成方式有待改进，
实现小口径炮弹数据的完全集成。 
（5）需要进一步研究小口径炮弹产品数据管理系统的二次开发技术，完善小
口径炮弹产品数据管理系统。 
  - 68 -
 
参考文献
 
[1]
  刘 宏 跃 , 
张 建 广 
, 
孙 万 杰 
. 
变 异 型 
CAPP 
系 统 的 开 发 及 应 用 
[J].
  烟 草 科
技
,2002(02):18-21 
[2]
  宋保华.
  基于加工工艺参数优化的 CAPP 
系统关键技术的研究
[D].
  陕西科技大
学硕士学位论文
,2005 
[3]
  赵涛.
  面向 C3P 
的实用型 
CAPP 
系统的研究与开发
[D].
  重庆大学硕士学位论
文
,1999 
[4]
  宋满仓 , 
尹春辉 
. 
注塑模具 
CAPP 
零件信息的描述与处理 
[J].
  制造业自动
化
,2005(03):41-44 
[5]
  殷方雷.
  基于知识集成的工艺设计技术研究[D].
  沈阳理工大学硕士学位论
文
,2011 
[6]
  武晓卫.CAPP 
技术在风洞试验模型研制过程中的应用与开发
[D].
  西北工业大
学硕士学位论文
,2005 
[7]
  黄东鑫 , 
余开朝 
.
  基于 PDM 
的企业应用集成 
[J].
  昆明理工大学学报 ( 
理工
版
),2004(01):121-124 
[8]
  张明达.
基于 
Teamcenter 
框架的 
CAPP 
集成研究与开发
[D].
湘潭大学硕士学位论
文
,2009 
[9]
  王洪宇,
叶文华
.CAPP 
系统与 
Smar Team 
集成技术的研究
[J].
机械设计与制造工
程
,2002,(04) 
[10]
 邓可,
田宇光
,
方立恭
.
美国巡航导弹发展历程及趋势
[J].
飞航导弹
,2003(04):13-17 
[11]
 冯站峰,
倪小平
,
彭华
,
盛步云
.PDM 
集成框架下 
CAPP 
与 
PDM 
的数据交换
[J].
武
汉理工大学学报
,2001,(03) 
[12]
 陈刚.CAPP/PDM 
集成平台的建立
[J].
纺织机械
,2007,(01) 
[13]
 
M.Sadaiah,D.R.Yadav.  A.Generative  Computer-aided  Process  Planning  System  for 
prismatic Components[J].Advanced Manufact-uring Technology,2002,(10) 
[14]
 郝博,
胡玉兰
,
赵岐刚
.
智能设计
[M].
沈阳：辽宁科学技术出版社
,2013.11 
[15]
 徐迪.CAPP 
中智能工艺决策技术研究
[D].
浙江理工大学硕士学位论文
,2013 
[16]
 袁 志 华 , 
郭 美 芳 
, 
郝 博 
. 
榴 弹 总 体 方 案 智 能 设 计 专 家 系 统 技 术 
[J]. 
兵 工 学 
 - 69 -
报
,27(01):170-174 
[17]
 刘伟.
智能 
CAPP 
系统中工艺路线和切削参数的决策研究
[D].
天津大学博士学位
论文
,2010 
[18]
 尹 朝 庆 , 
尹 皓 . 人 工 智 能 与 专 家 系 统 
[M]
. 北 京 : 中 国 水 利 水 电 出 版
社
,2004,134-137 
[19]
 李铁军.
专家系统及常用开发语言
[J].
辽宁工业大学学报（自然科学版）
,2010, 
(3):147-150 
[20]
 
Wysk  R  A.  An  automated  process  planning  and  selection  program:  APPAS,  Ph D 
Dissert ation[M].USA: Purdue University. West Latayette,1997 
[21]
 
F  Kay,  C  Chassapia.  An  IT  View  On  Perspectives  of  Computer  Aided  Process 
Planning Research[J].Computers of Industry,1997,(34):307-337 
[22]
 
J.C.Choi,C.Kim,Y.Choi,J.H.  Kim  and  J.H.Park.  An  Iniegrated  Design  and  CAPP 
system  for  Deep  Drawing  or  Blanking  Products[J].Adventure  Manufacture 
Technology,2000,(16) 
[23]
 刘路路 . 
基于二维工艺设计系统的三维 
CAPP 
的研究 
[J]. 
机械工程与自动
化
,2012,(3):1-3 
[24]
 刘 艳 斌 , 
赵 海 兵 
. 
基 于 
3D-CAPP 
技 术 及 其 发 展 研 究 
[J]. 
机 械 制
造
,2006,44(505):14-16 
[25]
 何小波.
基于 
Pro/E 
的三维工艺设计系统
[D].
西安电子科技大学硕士学位论
文
,2012 
[26]
 
J.  Tepić,  V.  Todić,  D.  Lukić,  M.  Milošević,  S.  Borojević.  Development  of  the 
computer-aided  process  planning  (CAPP)  system  for  polymer  injection  molds 
manufacturing[J]. Metalurgija .2011, 50(4):273-277 
[27]
 
Zhixiang Shao, Ruifeng Guo, Jie Li, Jian Jun Peng. Accurate Modeling Method for 
Generalized Tool Swept Volume in 5-axis NC Machining Simulation[J]. Journal of 
Software, 2011, (10):2056-2063 
[28]
 冯廷廷.
基于 
MBD 
的飞机装配工艺规划与仿真
[D].
南京航空航天大学硕士学位
论文
,2011 
[29]
 吴卓,
王刺梅
.
在 
Visual  C++
对话框中调用 
Pro/E 
三维实体模型的方法
[J].
科学技
术与工程
,2009,9(5):1258-1261 
[30]
 师利娟.
基于 
MBD 
技术的模具设计与制造
[J].
模具工业
,2012,38(9):13-16  
  - 70 -
[31]
 党改慧.  
基于 
Pro/E 
和 
VERICUT 
的机械运动及数控加工仿真
  [D].
西安建筑科
技大学硕士学位论文
,2010 
[32]
 徐敏.
基于 
Pro/E 
和 
VERICUT 
的虚拟数车床建模与仿真应用
[D].
浙江工业大学
硕士学位论文
,2012 
[33]
 何震,
马术文
.  
基于 
Pro/E 
和 
VERICUT  
的数控加工仿真
[J].
机械制造与自动
化
,2008,35(1):33-36 
[34]
 马建辉,
郭鹏
.  
基于 
Pro/E 
和 
VERICUT 
的数控加工过程仿真研究
[J].
现代制造工
程
,2014(06) 
[35]
 刘峙.
基于 
Pro/E 
和 
VERICUT 
虚拟数控加工技术的研究
[D].
浙江工业大学硕士
学位论文
,2008 
[36]
 刘欣.XTCAPP 
在沈阳机床的成功应用
[J].
制造技术与机床
,2012,(8):149-150 
[37]
 张 耘 .Extech  CAPP 
工 艺 数 据 管 理 系 统 
[J].CAD/CAM 
与 制 造 业 信 息
化
,2013,(5):35-37 
[38]
 付海波 , 
王磊.基于 
EPS 
脚本言语 
VBScript 
的二次开发研究 
[J]
.大众科
技
,2010,(7):20-22 
[39]
 姚世军.Oracle9i 
数据库原理与应用教程
[M]
.北京:国防工业出版社,
2004,5-10 
[40]
 冯凤娟.Oracle9i 
数据库体系结构和管理
[M]
.北京:清华大学出版社,
2003 
[41]
 
Kiritsis.  D,  A  review  of  knowledge
—
based  expert  systems  for  process  planning 
methods  and  problems[J].International  Journal  of  Advanced  Manufacturing 
Technology,1995,(10):240-262 
[42]
 蒋先刚, James Gao.
  基于 Windchill  
的集成式产品数据管理 
[J]
.管理技
术
,2005(01):107-112 
[43]
 张斌.柔性 CAPP 
系统多工艺路线创成方法研究
[D]
.南京航空航天大学硕士学
位论文
,2006:21-26 
[44]
 姜北北.
基于全三维模型工艺设计技术
[D].
沈阳理工大学硕士学位论文
,2013 
[45]
 王怀明.
面向制造企业的集成化工艺与生产管理系统的研究
[D].
天津大学硕士
学位论文
,2010 
[46]
 李超.
基于 
Windchill 
的研发管理系统的设计与实现
[D].
云南大学硕士学位论
文
,2013,5  
 - 71 -
[47]
 吴向阳.
弹箭网络化加工工艺设计技术
[D].
沈阳理工大学硕士学位论文
,2008 
[48]
 梁峰.  
基于 
PDM 
分布式 
CAPP 
系统研究
[D].
合肥
:
合肥工业大学硕士学位论文
, 
2003 
[49]
 许春刚,  
陈蔚芳
,  
王宁生
.  
基于 
PDM 
的 
CAPP 
系统集成技术的研究与实现
[J].  
组合机床与自动化加工技术
. 2001(1):42-44 
[50]
 
Ji G L, Gong D X, Tsui F. Analysis and implementation of the BOM of a tree-type 
structure  in  MPRII[J].  Journal  of  materials  Processing  Technology,  2003, 
139(1/2/3):535-538. 
[51]
 常微.
基于 
Pro/E 
的弹箭三维参数化建模设计的研究
[J].
沈阳理工大学学报
, 
2007,26(1):75-82 
[52]
 卫大为.Pro/E 
二次开发的机械零件参数化设计
[J].
机械制造与自动化
,2004, 
33(6):21-24 
[53]
 盛步云 . 
基于三维平台的 
CAPP 
软构件库的研究与实践 
[J]. 
机械制造 
,2007, 
45(512):20-22 
[54]
 张永康.
基于特征的 
CAPP 
系统的研究与实现
[D].
南京航空航天大学硕士学位论
文
,2003 
[55]
 高长银.
胡俊平等
.PRO
／
ENGINEER 
多轴数控加工实例详解
[M].
北京
:
电子工业
出版社
,2010 
[56]
 张莹.Pro/E 
在 
NC 
加工中的应用与二次开发
[M].
沈阳
:
沈阳航空工业学院出版
社
,2004:159-171 
[57]
 
B.bruegge,A.h.dutoit.
面向对象软件工程
:
使用 
UML
、模式与 
Java[M].
清华大学
出版社
,2011 
[58]
 陈桦 , 
门延会 
. 
基于 
Web 
的通用 
CAPP 
和 
PDM 
系统集成 
[J]. 
机床与液
压
,2009(07):221-223 
[59]
 张倩.
基于 
PLM 
的弹箭制造系统功能集成技术的研究
[D].
沈阳理工大学硕士学
位论文
,2010 
[60]
 贺建生 , 
黄靖 
.XTCAPP5.0 
与 
  PDM/Windchill 
的集成研究 
[J]. 
计算机与网
络
,2004(01):110-111 
[61]
 付素芳.  
基于 
PDM 
集成化 
CAPP 
系统研究
[D].  
西安
:
西北工业大学硕士学位论
文
, 2005.6  
  - 72 -
 
攻读硕士学位期间发表的论文和获得的科研成果
 
[1]
秦冉
,  
郝博
.
基于 
Windchill 
的小口径炮弹集成平台研究
.
成组技术与生产现代化
.
已发表（
2015 
年第 
2 
期）
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
  
 - 73 -
致
     
谢
 
本论文是在我尊敬的导师郝博的悉心指导、亲切关怀和谆谆教导下完成的，
在课题研究、程序开发和论文撰写的过程中，导师都倾注了大量的精力和心血。
近三年来，导师在生活和学习上给予我真诚的关怀和精心的指导。导师认真负责
的工作态度、一丝不苟的工作作风、诲人不倦的高尚品德和诚以待人的师者风范
给我留下了深刻的印象，并将永远激励我在今后的学习和工作中不懈努力、开拓
进取。在此，谨向辛勤栽培我的导师及其家人致以最诚挚的谢意和最美好的祝愿。
 
在论文进行过程中得到了项目组老师的诸多帮助，他们给予我精心地指导、
无私地关怀和热情地帮助，在此我向他们表示深深地谢意！
 
感谢我的师兄妹、同学、朋友，特别感谢魏礼勇、杨德伟、孙爱西、韩达、
刘腾、张信淋等人对我的细心关怀与帮助，使得我在学习中遇到的困难都迎刃而
解。在与他们的交流过程中，我学到了多方面知识，使我受益匪浅。也正是他们
的帮助和支持，我才能克服重重困难和解决各种问题，最终顺利完成此次的毕业
论文。
 
感谢本宿舍姐妹穆瑞、陶迎迎、郭海林、陈燕燕等，是她们创造了一个快乐
温馨的宿舍，与她们一起度过了我愉快的研究生生活。
 
感谢我的父母及家人，感谢所有曾经关心过我、帮助过我的人们！
 
在论文完成之际，我心中满是感激之情，再次感谢帮助我的老师、师兄妹、
同学及家人，衷心地感谢你们！
 
最后在论文的结尾，感谢评审专家对本文提出宝贵的评议意见，本人一定虚
心接受，认真修改，感激各位专家对审阅本文付出的时间和精力！
 Ｉ
■
１
论 文密 
级

至

年解
 密
是

否

可 
Ｗ 
复 
印
如 复 
印
，
从

年 起 可
 复 
印 全文 的

％
；
从

年 起 可
 全 文 复 
印
。
封 底填 
写
说 
明
；
横线
 上
 的
 
内 
容涉 及作者 
的 知识产 权
，
请作
者
与 
指导教
师商 定
后认真填 
写
。
学位论文如属保密 
内 
容
，
需
由 
指导教师提供 
申 
请
，
到 校保密委
员 
会办
理手
续
，
确定密级
，
并填写全部
５
行 
内 
容
。
如不涉及保 密 
内
容
，
只 需填写 第
３ 
、
４
、
５
行 
內 
容
。
所 有 涉 密 论 文 都 需 交 校 科 技 挡 案 室
１
份 
留 
存
。
秘密级
的 
渉密论文可提交
有 保密措施
的本 院系
 资料
室 
留 
存
；
机密级 上
 的涉密论文
由 
谋 题 组 按有 关 
规 
定 保 存
，
并 决 
定 是 否 提
交 本 院 系 
资 料 
室 
留 
存
。

，
‘
保密期过后
由
学
院送研究生部学位办
Ｈ
份
。
研究生部学位办按 有关规
定
上交 
国
家＃
技 情报 
中 也
、
校 
图 书 馆和 
留
存 研究 生部各
一
份
。
■
Ｉ